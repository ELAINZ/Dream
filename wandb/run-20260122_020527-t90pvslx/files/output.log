Total training steps: 699
Epoch 1/3:   0%|                                                                                                                               | 0/233 [00:00<?, ?it/s]
DEBUG: shift logits: tensor([[ 0.2354, -1.7734, -0.0282,  ...,  2.2344,  2.2344,  2.2344],
        [ 0.2354, -1.7734, -0.0282,  ...,  2.2344,  2.2344,  2.2344],
        [ 1.2578, -0.7812, -0.5781,  ...,  2.1562,  2.1562,  2.1562],
        ...,
        [-0.2295, -1.6094,  2.2969,  ...,  0.5000,  0.5000,  0.5000],
        [-0.1416, -4.0625, -0.8047,  ...,  0.3867,  0.3867,  0.3867],
        [-3.1250, -4.0312, -1.0234,  ...,  0.6914,  0.6914,  0.6914]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<ViewBackward0>) shift_labels: tensor([151644,    872,    198,     38,  24380,   6801,    311,   3695,    264,
         13041,   4349,    429,   7049,    220,     17,  27418,   2667,  14462,
            13,  54257,    702,    220,     20,     19,   3041,  57074,     11,
           323,   1052,    525,    220,     21,   3041,  57074,    311,    264,
         27418,   2667,    343,     13,   2585,   1657,  27418,   2667,  14462,
           686,  54257,    614,   2115,   1283,  11833,    279,   4349,     30,
        151645,    198, 151644,  77091,    198,   5338,   5508,    279,   1372,
           315,   3041,  57074,  54257,    702,    311,  27418,   2667,  14462,
           553,  49702,    553,    279,   9289,   4379,     25,    220,     20,
            19,   3041,  57074,    608,    220,     21,   3041,  57074,   4322,
            69,   2667,    343,    284,   1115,     20,     19,     14,     21,
            28,     24,   2452,     24,  27418,   2667,  14462,    198,  12209,
         32256,    279,   2783,    315,    279,  13041,   4349,    311,   1477,
          1246,   1657,  27418,   2667,  14462,  54257,    702,   2115,     25,
           220,     24], device='cuda:0')
DEBUG: loss: tensor([1.2062e+01, 1.9375e+01, 3.8594e+00, 1.1750e+01, 6.0312e+00, 7.8750e+00,
        3.2425e-04, 7.0312e+00, 2.9182e-04, 3.4219e+00, 8.9355e-02, 7.4688e+00,
        5.1562e+00, 1.4782e-05, 8.8692e-05, 6.8750e+00, 5.6250e+00, 2.5000e+00,
        4.1602e-01, 7.3750e+00, 7.7812e+00, 8.9264e-04, 7.5684e-02, 1.9043e-02,
        7.9688e-01, 6.4375e+00, 4.1580e-04, 4.9133e-03, 4.8125e+00, 2.9688e+00,
        8.3447e-06, 4.5625e+00, 4.5703e-01, 8.5625e+00, 4.5625e+00, 1.7773e-01,
        1.1062e+01, 4.6562e+00, 1.9238e-01, 2.3828e-01, 8.6875e+00, 5.0938e+00,
        7.5312e+00, 2.1094e+00, 7.2656e-01, 6.4062e+00, 5.3438e+00, 3.0859e-01,
        9.5000e+00, 7.7812e+00, 1.0438e+01, 2.1458e-05, 3.3438e+00, 4.2188e+00,
        3.8125e+00, 1.2012e-01, 8.1250e+00, 1.6500e+01, 1.4375e+00, 1.9500e+01,
        2.4500e+01, 2.1125e+01, 2.2875e+01, 2.0500e+01, 1.5500e+01, 2.2375e+01,
        2.0125e+01, 1.8375e+01, 2.3250e+01, 2.2625e+01, 2.0125e+01, 2.1500e+01,
        2.4000e+01, 2.2500e+01, 2.3750e+01, 2.0250e+01, 1.8375e+01, 1.6625e+01,
        1.8375e+01, 1.4375e+01, 2.0500e+01, 2.2500e+01, 1.5125e+01, 2.1625e+01,
        2.1000e+01, 1.4125e+01, 2.4750e+01, 1.5688e+01, 2.1375e+01, 2.1875e+01,
        2.1500e+01, 2.0000e+01, 1.9875e+01, 2.0250e+01, 1.9500e+01, 2.0000e+01,
        2.3250e+01, 1.9625e+01, 2.3625e+01, 1.6250e+01, 2.3375e+01, 1.4875e+01,
        2.3250e+01, 2.3375e+01, 1.9875e+01, 2.0875e+01, 7.6562e+00, 1.8875e+01,
        1.5688e+01, 1.8875e+01, 1.8625e+01, 1.6625e+01, 1.8125e+01, 1.8000e+01,
        2.4750e+01, 1.6500e+01, 2.0125e+01, 1.8500e+01, 1.9625e+01, 2.1375e+01,
        2.0125e+01, 2.0250e+01, 2.0000e+01, 1.6125e+01, 1.4688e+01, 1.7000e+01,
        7.4158e-03, 2.2625e+01], device='cuda:0', grad_fn=<NllLossBackward0>)
loss mask: tensor([False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,  True,
         True,  True, False,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True, False,
         True,  True,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True, False,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True, False,  True,  True,  True,
         True,  True, False,  True,  True,  True, False,  True,  True,  True,
         True,  True,  True,  True,  True, False, False,  True],
       device='cuda:0') loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000, 19.5000, 24.5000, 21.1250,  0.0000, 20.5000,
        15.5000, 22.3750, 20.1250, 18.3750, 23.2500, 22.6250, 20.1250, 21.5000,
        24.0000, 22.5000, 23.7500, 20.2500, 18.3750, 16.6250, 18.3750,  0.0000,
        20.5000, 22.5000, 15.1250, 21.6250, 21.0000, 14.1250, 24.7500, 15.6875,
        21.3750, 21.8750, 21.5000, 20.0000, 19.8750, 20.2500, 19.5000,  0.0000,
        23.2500, 19.6250, 23.6250, 16.2500, 23.3750, 14.8750, 23.2500, 23.3750,
        19.8750, 20.8750,  0.0000, 18.8750, 15.6875, 18.8750, 18.6250, 16.6250,
         0.0000, 18.0000, 24.7500, 16.5000,  0.0000, 18.5000, 19.6250, 21.3750,
        20.1250, 20.2500, 20.0000, 16.1250, 14.6875,  0.0000,  0.0000, 22.6250],
       device='cuda:0', grad_fn=<MaskedFillBackward0>)
weight: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.5469, 0.5039, 0.4648, 0.0000,
         0.3906, 0.3555, 0.3223, 0.2930, 0.2676, 0.2461, 0.2256, 0.2090, 0.1934,
         0.1807, 0.1699, 0.1611, 0.1543, 0.1494, 0.1455, 0.1436, 0.0000, 0.1318,
         0.1226, 0.1152, 0.1084, 0.1030, 0.0991, 0.0957, 0.0942, 0.0933, 0.0933,
         0.0942, 0.0962, 0.0996, 0.1035, 0.1094, 0.0000, 0.1123, 0.1099, 0.1084,
         0.1084, 0.1099, 0.1118, 0.1157, 0.1206, 0.1270, 0.1348, 0.0000, 0.1426,
         0.1426, 0.1455, 0.1484, 0.1543, 0.0000, 0.1592, 0.1572, 0.1582, 0.0000,
         0.1533, 0.1475, 0.1436, 0.1406, 0.1396, 0.1406, 0.1426, 0.1465, 0.0000,
         0.0000, 0.1328]], device='cuda:0', dtype=torch.bfloat16)
DEBUG loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000, 10.6641, 12.3457,  9.8198,  0.0000,  8.0078,
         5.5098,  7.2107,  5.8960,  4.9167,  5.7217,  5.1039,  4.2058,  4.1572,
         4.3359,  3.8232,  3.8269,  3.1245,  2.7455,  2.4191,  2.6378,  0.0000,
         2.7026,  2.7576,  1.7429,  2.3441,  2.1636,  1.4001,  2.3687,  1.4784,
         1.9935,  2.0401,  2.0261,  1.9238,  1.9797,  2.0962,  2.1328,  0.0000,
         2.6111,  2.1561,  2.5609,  1.7615,  2.5681,  1.6633,  2.6906,  2.8192,
         2.5232,  2.8132,  0.0000,  2.6912,  2.2367,  2.7465,  2.7646,  2.5652,
         0.0000,  2.8652,  3.8914,  2.6104,  0.0000,  2.8364,  2.8939,  3.0685,
         2.8301,  2.8279,  2.8125,  2.2991,  2.1515,  0.0000,  0.0000,  3.0049],
       device='cuda:0', grad_fn=<MulBackward0>)
