Total training steps: 699
Epoch 1/3:   1%|â–ˆ                                                                                                                      | 2/233 [00:20<38:49, 10.08s/it]
step:0 - train/loss:nan - train/lr(1e-3):5.88235294117647e-05 - train/num_eos_mean:62.09375 - train/num_eos_max:95.0
step:1 - train/loss:nan - train/lr(1e-3):0.0001176470588235294 - train/num_eos_mean:54.8125 - train/num_eos_max:94.0
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/zhang2968/Dream/src/trainer/fsdp_sft_trainer.py", line 1167, in <module>
    main()
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
           ^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
            ^^^^^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/hydra/_internal/hydra.py", line 119, in run
    ret = run_job(
          ^^^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zhang2968/Dream/src/trainer/fsdp_sft_trainer.py", line 1163, in main
    trainer.fit()
  File "/home/zhang2968/Dream/src/trainer/fsdp_sft_trainer.py", line 1084, in fit
    metric = self.training_step(data)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zhang2968/Dream/src/trainer/fsdp_sft_trainer.py", line 862, in training_step
    loss.backward()
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/_tensor.py", line 647, in backward
    torch.autograd.backward(
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/autograd/__init__.py", line 354, in backward
    _engine_run_backward(
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/autograd/graph.py", line 829, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
[rank0]: Traceback (most recent call last):
[rank0]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank0]:   File "<frozen runpy>", line 88, in _run_code
[rank0]:   File "/home/zhang2968/Dream/src/trainer/fsdp_sft_trainer.py", line 1167, in <module>
[rank0]:     main()
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/hydra/main.py", line 94, in decorated_main
[rank0]:     _run_hydra(
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
[rank0]:     _run_app(
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/hydra/_internal/utils.py", line 457, in _run_app
[rank0]:     run_and_report(
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
[rank0]:     return func()
[rank0]:            ^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
[rank0]:     lambda: hydra.run(
[rank0]:             ^^^^^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/hydra/_internal/hydra.py", line 119, in run
[rank0]:     ret = run_job(
[rank0]:           ^^^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/hydra/core/utils.py", line 186, in run_job
[rank0]:     ret.return_value = task_function(task_cfg)
[rank0]:                        ^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/zhang2968/Dream/src/trainer/fsdp_sft_trainer.py", line 1163, in main
[rank0]:     trainer.fit()
[rank0]:   File "/home/zhang2968/Dream/src/trainer/fsdp_sft_trainer.py", line 1084, in fit
[rank0]:     metric = self.training_step(data)
[rank0]:              ^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/zhang2968/Dream/src/trainer/fsdp_sft_trainer.py", line 862, in training_step
[rank0]:     loss.backward()
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/_tensor.py", line 647, in backward
[rank0]:     torch.autograd.backward(
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/autograd/__init__.py", line 354, in backward
[rank0]:     _engine_run_backward(
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/autograd/graph.py", line 829, in _engine_run_backward
[rank0]:     return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]: KeyboardInterrupt
