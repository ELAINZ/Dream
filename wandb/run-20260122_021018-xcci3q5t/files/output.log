Total training steps: 699
Epoch 1/3:   0%|                                                                                                                               | 0/233 [00:00<?, ?it/s]
DEBUG: shift logits: tensor([[-0.7852, -4.7500, -1.5312,  ...,  2.5625,  2.5625,  2.5625],
        [-0.7852, -4.7500, -1.5312,  ...,  2.5625,  2.5625,  2.5625],
        [ 0.8008, -2.7188, -1.5000,  ...,  1.5469,  1.5469,  1.5469],
        ...,
        [ 8.3125,  2.9062,  2.3906,  ..., -1.9141, -1.9141, -1.9141],
        [ 2.7344, -7.3125, -5.8750,  ..., -2.8281, -2.8281, -2.8281],
        [ 1.8594, -4.0000, -2.5469,  ..., -0.0220, -0.0220, -0.0220]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<ViewBackward0>) shift_labels: tensor([151644,    872,    198,     38,  24380,   6801,    311,   3695,    264,
         13041,   4349,    429,   7049,    220,     17,  27418,   2667,  14462,
            13,  54257,    702,    220,     20,     19,   3041,  57074,     11,
           323,   1052,    525,    220,     21,   3041,  57074,    311,    264,
         27418,   2667,    343,     13,   2585,   1657,  27418,   2667,  14462,
           686,  54257,    614,   2115,   1283,  11833,    279,   4349,     30,
        151645,    198, 151644,  77091,    198,   5338,   5508,    279,   1372,
           315,   3041,  57074,  54257,    702,    311,  27418,   2667,  14462,
           553,  49702,    553,    279,   9289,   4379,     25,    220,     20,
            19,   3041,  57074,    608,    220,     21,   3041,  57074,   4322,
            69,   2667,    343,    284,   1115,     20,     19,     14,     21,
            28,     24,   2452,     24,  27418,   2667,  14462,    198,  12209,
         32256,    279,   2783,    315,    279,  13041,   4349,    311,   1477,
          1246,   1657,  27418,   2667,  14462,  54257,    702,   2115,     25,
           220,     24], device='cuda:0')
DEBUG: loss: tensor([9.0625e+00, 1.6500e+01, 9.5703e-02, 1.2062e+01, 2.4375e+00, 5.9375e+00,
        1.5450e-04, 6.7812e+00, 1.8787e-04, 1.9219e+00, 8.0859e-01, 7.4375e+00,
        7.0312e+00, 2.9802e-06, 3.9368e-03, 1.3250e+01, 7.2188e+00, 2.4688e+00,
        2.4261e-03, 6.7500e+00, 2.8594e+00, 4.5471e-03, 8.3008e-02, 1.1902e-03,
        1.1875e+00, 5.5625e+00, 1.3184e-01, 1.3590e-05, 2.1719e+00, 4.5312e-01,
        3.0279e-05, 7.6953e-01, 5.1953e-01, 6.6875e+00, 2.2266e-01, 3.8818e-02,
        1.2188e+01, 1.0875e+01, 2.1582e-01, 2.0801e-01, 4.3125e+00, 5.4688e-02,
        7.5312e+00, 8.1875e+00, 1.6953e+00, 5.6562e+00, 5.2500e+00, 4.5410e-02,
        7.8438e+00, 5.3438e+00, 7.7188e+00, 1.8358e-05, 2.7031e+00, 5.3906e-01,
        7.1875e-01, 2.0142e-03, 3.8906e+00, 1.1125e+01, 1.0938e+00, 1.0562e+01,
        6.0625e+00, 2.1553e-04, 2.4170e-02, 1.0204e-04, 3.7500e+00, 4.2188e+00,
        3.9375e+00, 1.7422e+00, 1.2634e-02, 1.7750e+01, 1.0562e+01, 2.2969e+00,
        2.3594e+00, 7.0312e+00, 3.4766e-01, 1.9264e-04, 4.4141e-01, 1.1812e+01,
        4.9219e-01, 2.8014e-05, 1.1780e-02, 6.6528e-03, 5.1875e+00, 4.1250e+00,
        1.7456e-02, 1.1562e+01, 1.9375e+00, 3.8281e+00, 4.1250e+00, 5.0312e+00,
        6.9688e+00, 1.0188e+01, 1.8750e-01, 8.6328e-01, 2.5482e-03, 3.7354e-02,
        8.6060e-03, 2.4261e-03, 5.0000e+00, 2.7222e-02, 2.2411e-05, 1.1250e+00,
        2.2125e-04, 5.0312e+00, 4.1562e+00, 2.3281e+00, 4.4678e-02, 5.3125e+00,
        7.6953e-01, 4.4060e-04, 2.6250e+00, 1.5926e-04, 7.8678e-06, 6.3125e+00,
        1.8555e-01, 5.9891e-04, 1.7625e+01, 8.6250e+00, 3.4375e+00, 6.8750e+00,
        6.9375e+00, 2.0312e+00, 8.7500e+00, 4.6094e-01, 6.5000e+00, 4.0283e-02,
        2.8610e-06, 9.0820e-02], device='cuda:0', grad_fn=<NllLossBackward0>)
loss mask: tensor([False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False,  True, False, False,
        False, False, False, False, False,  True, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False,  True, False, False, False,
        False, False, False, False, False, False, False, False],
       device='cuda:0') loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000, 11.8125,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000, 11.5625,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000, 17.6250,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
       device='cuda:0', grad_fn=<MaskedFillBackward0>)
weight: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.9727, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.9688, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8398,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000]], device='cuda:0', dtype=torch.bfloat16)
DEBUG loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000, 11.4895,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000, 11.2012,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000, 14.8022,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
       device='cuda:0', grad_fn=<MulBackward0>)
