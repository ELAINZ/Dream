Total training steps: 699
Epoch 1/3:   0%|                                                                                                                               | 0/233 [00:00<?, ?it/s]
DEBUG: shift logits: tensor([[-0.4160, -0.8164, -3.3281,  ...,  1.5000,  1.5000,  1.5000],
        [-0.4160, -0.8164, -3.3281,  ...,  1.5000,  1.5000,  1.5000],
        [ 1.8047,  0.5977, -2.8438,  ...,  1.4219,  1.4219,  1.4219],
        ...,
        [-0.5156, -3.5469, -2.5781,  ...,  1.1250,  1.1250,  1.1250],
        [-0.6758, -3.7188, -2.6094,  ...,  1.1719,  1.1719,  1.1719],
        [-0.7266, -3.7812, -2.5312,  ...,  1.2500,  1.2500,  1.2500]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<ViewBackward0>) shift_labels: tensor([151644,    872,    198,     38,  24380,   6801,    311,   3695,    264,
         13041,   4349,    429,   7049,    220,     17,  27418,   2667,  14462,
            13,  54257,    702,    220,     20,     19,   3041,  57074,     11,
           323,   1052,    525,    220,     21,   3041,  57074,    311,    264,
         27418,   2667,    343,     13,   2585,   1657,  27418,   2667,  14462,
           686,  54257,    614,   2115,   1283,  11833,    279,   4349,     30,
        151645,    198, 151644,  77091,    198,   5338,   5508,    279,   1372,
           315,   3041,  57074,  54257,    702,    311,  27418,   2667,  14462,
           553,  49702,    553,    279,   9289,   4379,     25,    220,     20,
            19,   3041,  57074,    608,    220,     21,   3041,  57074,   4322,
            69,   2667,    343,    284,   1115,     20,     19,     14,     21,
            28,     24,   2452,     24,  27418,   2667,  14462,    198,  12209,
         32256,    279,   2783,    315,    279,  13041,   4349,    311,   1477,
          1246,   1657,  27418,   2667,  14462,  54257,    702,   2115,     25,
           220,     24], device='cuda:0')
DEBUG: loss: tensor([1.0688e+01, 1.8875e+01, 2.0469e+00, 8.3125e+00, 1.7344e+00, 6.3750e+00,
        1.3504e-03, 4.9062e+00, 1.1902e-03, 4.9375e+00, 1.7188e+00, 9.3125e+00,
        9.3750e+00, 2.2888e-03, 1.9287e-02, 1.0000e+01, 5.8438e+00, 4.1562e+00,
        6.7871e-02, 9.8125e+00, 8.8125e+00, 4.0283e-02, 1.9141e-01, 2.5635e-02,
        4.7500e+00, 7.5312e+00, 1.3351e-03, 2.7344e-02, 6.9688e+00, 9.1875e+00,
        8.1539e-05, 6.9688e+00, 4.1562e+00, 8.3750e+00, 6.7500e+00, 1.8359e+00,
        1.2938e+01, 1.8750e+00, 2.1094e+00, 2.7539e-01, 1.1188e+01, 6.9375e+00,
        7.1562e+00, 3.2812e+00, 1.8125e+00, 7.0000e+00, 7.4688e+00, 9.0234e-01,
        9.7500e+00, 6.9375e+00, 9.0625e+00, 2.4128e-04, 4.3438e+00, 4.8750e+00,
        1.8516e+00, 6.2500e-01, 6.2188e+00, 1.4375e+01, 4.1562e+00, 1.9250e+01,
        2.1625e+01, 1.5125e+01, 1.7625e+01, 1.0812e+01, 1.7375e+01, 1.8125e+01,
        1.8375e+01, 1.7625e+01, 2.0125e+01, 2.0625e+01, 1.8375e+01, 1.7000e+01,
        1.9375e+01, 1.8625e+01, 1.8875e+01, 1.7625e+01, 1.7625e+01, 1.9750e+01,
        1.9125e+01, 1.8875e+01, 1.9125e+01, 2.2250e+01, 1.9125e+01, 2.0250e+01,
        1.9125e+01, 1.9875e+01, 2.3250e+01, 1.9625e+01, 1.9875e+01, 1.8875e+01,
        1.9750e+01, 1.4250e+01, 1.5750e+01, 2.2500e+01, 2.0875e+01, 2.0875e+01,
        2.3625e+01, 1.9000e+01, 2.3500e+01, 1.8750e+01, 2.4375e+01, 1.5500e+01,
        2.4375e+01, 2.4625e+01, 1.5375e+01, 1.7875e+01, 1.8750e+01, 2.1250e+01,
        1.8625e+01, 2.0000e+01, 2.1375e+01, 1.7375e+01, 1.9750e+01, 1.5062e+01,
        1.4000e+01, 1.9500e+01, 2.2125e+01, 2.1375e+01, 2.2000e+01, 2.4500e+01,
        1.2938e+01, 2.3000e+01, 2.0500e+01, 1.8750e+01, 1.9875e+01, 2.0375e+01,
        2.1875e+01, 2.3500e+01], device='cuda:0', grad_fn=<NllLossBackward0>)
loss mask: tensor([False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,  True,
         True,  True,  True, False,  True,  True,  True,  True,  True,  True,
        False,  True,  True, False,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True, False,  True,  True,  True,  True,  True,  True,
         True, False,  True,  True,  True,  True,  True,  True],
       device='cuda:0') loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000, 19.2500, 21.6250, 15.1250, 17.6250,  0.0000,
        17.3750, 18.1250, 18.3750, 17.6250, 20.1250, 20.6250,  0.0000, 17.0000,
        19.3750,  0.0000, 18.8750, 17.6250, 17.6250, 19.7500, 19.1250, 18.8750,
        19.1250, 22.2500, 19.1250, 20.2500, 19.1250, 19.8750, 23.2500, 19.6250,
        19.8750, 18.8750, 19.7500, 14.2500, 15.7500, 22.5000, 20.8750, 20.8750,
        23.6250, 19.0000, 23.5000, 18.7500, 24.3750, 15.5000, 24.3750, 24.6250,
        15.3750, 17.8750, 18.7500, 21.2500, 18.6250, 20.0000, 21.3750, 17.3750,
        19.7500,  0.0000, 14.0000, 19.5000, 22.1250, 21.3750, 22.0000, 24.5000,
        12.9375,  0.0000, 20.5000, 18.7500, 19.8750, 20.3750, 21.8750, 23.5000],
       device='cuda:0', grad_fn=<MaskedFillBackward0>)
weight: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.5664, 0.5234, 0.4863, 0.4551,
         0.0000, 0.3965, 0.3672, 0.3438, 0.3223, 0.3047, 0.2910, 0.0000, 0.2617,
         0.2441, 0.0000, 0.2080, 0.1875, 0.1689, 0.1523, 0.1377, 0.1240, 0.1123,
         0.1016, 0.0918, 0.0835, 0.0757, 0.0688, 0.0630, 0.0576, 0.0530, 0.0488,
         0.0454, 0.0422, 0.0398, 0.0376, 0.0359, 0.0347, 0.0337, 0.0330, 0.0327,
         0.0330, 0.0334, 0.0344, 0.0359, 0.0376, 0.0396, 0.0422, 0.0452, 0.0486,
         0.0525, 0.0574, 0.0625, 0.0684, 0.0752, 0.0000, 0.0796, 0.0771, 0.0757,
         0.0752, 0.0752, 0.0762, 0.0781, 0.0000, 0.0728, 0.0654, 0.0591, 0.0530,
         0.0476, 0.0430]], device='cuda:0', dtype=torch.bfloat16)
DEBUG loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000, 10.9033, 11.3193,  7.3557,  8.0208,  0.0000,
         6.8889,  6.6553,  6.3164,  5.6799,  6.1318,  6.0022,  0.0000,  4.4492,
         4.7302,  0.0000,  3.9261,  3.3047,  2.9777,  3.0088,  2.6334,  2.3409,
         2.1478,  2.2598,  1.7556,  1.6908,  1.4474,  1.3683,  1.4645,  1.1307,
         1.0529,  0.9216,  0.8969,  0.6019,  0.6268,  0.8459,  0.7492,  0.7237,
         0.7960,  0.6262,  0.7688,  0.6180,  0.8153,  0.5336,  0.8748,  0.9258,
         0.6081,  0.7550,  0.8469,  1.0324,  0.9776,  1.1475,  1.3359,  1.1877,
         1.4851,  0.0000,  1.1143,  1.5044,  1.6745,  1.6073,  1.6543,  1.8662,
         1.0107,  0.0000,  1.4915,  1.2268,  1.1743,  1.0794,  1.0414,  1.0098],
       device='cuda:0', grad_fn=<MulBackward0>)
loss: 2.4237213134765625
