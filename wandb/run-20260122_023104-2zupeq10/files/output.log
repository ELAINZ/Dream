Total training steps: 699
Epoch 1/3:   0%|                                                                                                                               | 0/233 [00:00<?, ?it/s]
DEBUG: shift logits: tensor([[-2.4844, -2.1094,  0.2383,  ...,  3.7344,  3.7344,  3.7344],
        [-2.4844, -2.1094,  0.2383,  ...,  3.7344,  3.7344,  3.7344],
        [-1.1484, -1.4609, -0.0542,  ...,  2.7656,  2.7656,  2.7656],
        ...,
        [ 3.8906,  0.3926,  1.6562,  ...,  1.2812,  1.2812,  1.2812],
        [-2.0781, -2.9375, -0.1855,  ...,  0.6953,  0.6953,  0.6953],
        [-0.0564, -0.0603,  3.7188,  ...,  0.5195,  0.5195,  0.5195]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<ViewBackward0>) shift_labels: tensor([151644,    872,    198,     38,  24380,   6801,    311,   3695,    264,
         13041,   4349,    429,   7049,    220,     17,  27418,   2667,  14462,
            13,  54257,    702,    220,     20,     19,   3041,  57074,     11,
           323,   1052,    525,    220,     21,   3041,  57074,    311,    264,
         27418,   2667,    343,     13,   2585,   1657,  27418,   2667,  14462,
           686,  54257,    614,   2115,   1283,  11833,    279,   4349,     30,
        151645,    198, 151644,  77091,    198,   5338,   5508,    279,   1372,
           315,   3041,  57074,  54257,    702,    311,  27418,   2667,  14462,
           553,  49702,    553,    279,   9289,   4379,     25,    220,     20,
            19,   3041,  57074,    608,    220,     21,   3041,  57074,   4322,
            69,   2667,    343,    284,   1115,     20,     19,     14,     21,
            28,     24,   2452,     24,  27418,   2667,  14462,    198,  12209,
         32256,    279,   2783,    315,    279,  13041,   4349,    311,   1477,
          1246,   1657,  27418,   2667,  14462,  54257,    702,   2115,     25,
           220,     24], device='cuda:0')
DEBUG: loss: tensor([1.0938e+01, 1.5500e+01, 1.0742e-01, 4.8438e+00, 1.9062e+00, 5.3125e+00,
        2.5368e-04, 7.9062e+00, 5.1880e-04, 2.0000e+00, 5.9814e-02, 3.9531e+00,
        6.0312e+00, 9.5367e-06, 1.5831e-04, 9.1250e+00, 8.9375e+00, 2.0625e+00,
        3.9062e-01, 5.3125e+00, 4.0625e+00, 4.6492e-05, 1.3184e-01, 1.0376e-03,
        3.1445e-01, 7.1875e+00, 1.9653e-02, 1.9264e-04, 4.2500e+00, 1.1797e+00,
        5.1260e-06, 2.7930e-01, 3.7109e-01, 5.9062e+00, 2.7188e+00, 2.4023e-01,
        1.0188e+01, 6.6562e+00, 7.6660e-02, 1.4531e+00, 6.6562e+00, 1.3438e+00,
        4.2188e+00, 9.1250e+00, 1.6875e+00, 6.4062e+00, 4.9688e+00, 5.8750e+00,
        7.3438e+00, 6.3750e+00, 6.3438e+00, 6.1035e-05, 1.5547e+00, 2.7188e+00,
        6.3672e-01, 1.0147e-03, 5.3750e+00, 1.0750e+01, 2.5000e-01, 2.0750e+01,
        1.3250e+01, 4.2725e-04, 1.2256e-01, 4.5395e-04, 1.5812e+01, 1.2938e+01,
        7.6875e+00, 1.8875e+01, 1.5312e+01, 1.9625e+01, 1.4000e+01, 8.5625e+00,
        9.5000e+00, 2.3875e+01, 1.9625e+01, 1.7625e+01, 1.6500e+01, 1.8375e+01,
        1.1188e+01, 6.2943e-04, 2.3906e+00, 5.5847e-03, 8.6719e-01, 7.0000e+00,
        3.8330e-02, 6.0797e-05, 1.3562e+01, 1.1500e+01, 8.7500e+00, 5.9688e+00,
        1.2188e+01, 1.7000e+01, 3.1250e+00, 5.1562e+00, 3.4766e-01, 7.0703e-01,
        1.7375e+01, 1.6500e+01, 2.2125e+01, 1.0500e+01, 2.0938e+00, 1.5859e+00,
        2.1875e+01, 1.8500e+01, 6.0938e+00, 3.1562e+00, 7.3730e-02, 8.6875e+00,
        5.2344e-01, 1.6211e-01, 5.0625e+00, 1.0157e-04, 1.2562e+01, 1.7500e+01,
        2.2250e+01, 1.6875e+01, 1.7750e+01, 1.8375e+01, 9.0625e+00, 1.5125e+01,
        1.5688e+01, 5.0625e+00, 5.1562e+00, 8.5625e+00, 1.1938e+01, 3.9453e-01,
        1.3812e+01, 2.1125e+01], device='cuda:0', grad_fn=<NllLossBackward0>)
loss mask: tensor([False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,  True,
        False, False, False, False,  True, False, False,  True,  True, False,
         True, False, False,  True,  True,  True,  True,  True, False, False,
        False, False, False, False, False, False,  True, False, False, False,
         True, False, False, False, False, False,  True,  True,  True, False,
        False, False,  True, False,  True, False, False, False, False, False,
        False, False,  True,  True,  True,  True,  True, False, False,  True,
         True, False, False,  True, False, False,  True,  True],
       device='cuda:0') loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000, 20.7500,  0.0000,  0.0000,  0.0000,  0.0000,
        15.8125,  0.0000,  0.0000, 18.8750, 15.3125,  0.0000, 14.0000,  0.0000,
         0.0000, 23.8750, 19.6250, 17.6250, 16.5000, 18.3750,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000, 13.5625,  0.0000,
         0.0000,  0.0000, 12.1875,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
        17.3750, 16.5000, 22.1250,  0.0000,  0.0000,  0.0000, 21.8750,  0.0000,
         6.0938,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
        12.5625, 17.5000, 22.2500, 16.8750, 17.7500,  0.0000,  0.0000, 15.1250,
        15.6875,  0.0000,  0.0000,  8.5625,  0.0000,  0.0000, 13.8125, 21.1250],
       device='cuda:0', grad_fn=<MaskedFillBackward0>)
weight: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8398, 0.0000, 0.0000, 0.0000,
         0.0000, 0.7539, 0.0000, 0.0000, 0.6992, 0.6836, 0.0000, 0.6680, 0.0000,
         0.0000, 0.6406, 0.6367, 0.6406, 0.6484, 0.6641, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.7422, 0.0000, 0.0000, 0.0000,
         0.7344, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6797, 0.6719, 0.6680,
         0.0000, 0.0000, 0.0000, 0.6602, 0.0000, 0.6523, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.5391, 0.5117, 0.4922, 0.4785, 0.4688,
         0.0000, 0.0000, 0.4375, 0.4238, 0.0000, 0.0000, 0.3789, 0.0000, 0.0000,
         0.3027, 0.2715]], device='cuda:0', dtype=torch.bfloat16)
DEBUG loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000, 17.4268,  0.0000,  0.0000,  0.0000,  0.0000,
        11.9211,  0.0000,  0.0000, 13.1978, 10.4675,  0.0000,  9.3516,  0.0000,
         0.0000, 15.2949, 12.4956, 11.2910, 10.6992, 12.2021,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000, 10.0659,  0.0000,
         0.0000,  0.0000,  8.9502,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
        11.8096, 11.0859, 14.7788,  0.0000,  0.0000,  0.0000, 14.4409,  0.0000,
         3.9752,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         6.7720,  8.9551, 10.9512,  8.0750,  8.3203,  0.0000,  0.0000,  6.6172,
         6.6488,  0.0000,  0.0000,  3.2444,  0.0000,  0.0000,  4.1815,  5.7351],
       device='cuda:0', grad_fn=<MulBackward0>)
step loss: 0.3112901747226715
