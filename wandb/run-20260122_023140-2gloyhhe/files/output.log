Total training steps: 699
Epoch 1/3:   0%|                                                                                                                               | 0/233 [00:00<?, ?it/s]
DEBUG: shift logits: tensor([[-1.7578, -5.9375, -0.5547,  ...,  1.3203,  1.3203,  1.3203],
        [-1.7578, -5.9375, -0.5547,  ...,  1.3203,  1.3203,  1.3203],
        [ 0.0796, -4.8125,  0.2793,  ...,  0.7734,  0.7734,  0.7734],
        ...,
        [ 5.7188, -0.5859,  2.0625,  ..., -3.4531, -3.4531, -3.4531],
        [ 2.3594, -7.5625, -0.6094,  ..., -2.7812, -2.7812, -2.7812],
        [ 1.6875, -7.0312,  3.5625,  ...,  0.0183,  0.0183,  0.0183]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<ViewBackward0>) shift_labels: tensor([151644,    872,    198,     38,  24380,   6801,    311,   3695,    264,
         13041,   4349,    429,   7049,    220,     17,  27418,   2667,  14462,
            13,  54257,    702,    220,     20,     19,   3041,  57074,     11,
           323,   1052,    525,    220,     21,   3041,  57074,    311,    264,
         27418,   2667,    343,     13,   2585,   1657,  27418,   2667,  14462,
           686,  54257,    614,   2115,   1283,  11833,    279,   4349,     30,
        151645,    198, 151644,  77091,    198,   5338,   5508,    279,   1372,
           315,   3041,  57074,  54257,    702,    311,  27418,   2667,  14462,
           553,  49702,    553,    279,   9289,   4379,     25,    220,     20,
            19,   3041,  57074,    608,    220,     21,   3041,  57074,   4322,
            69,   2667,    343,    284,   1115,     20,     19,     14,     21,
            28,     24,   2452,     24,  27418,   2667,  14462,    198,  12209,
         32256,    279,   2783,    315,    279,  13041,   4349,    311,   1477,
          1246,   1657,  27418,   2667,  14462,  54257,    702,   2115,     25,
           220,     24], device='cuda:0')
DEBUG: loss: tensor([1.0000e+01, 1.8625e+01, 2.1250e+00, 1.1750e+01, 5.9062e+00, 9.5000e+00,
        2.8381e-03, 1.2125e+01, 3.5553e-03, 7.2188e+00, 3.8594e+00, 4.2812e+00,
        1.3125e+01, 1.8120e-04, 5.3711e-03, 1.1625e+01, 1.0250e+01, 3.3125e+00,
        1.2109e+00, 6.5312e+00, 8.9375e+00, 2.0312e+00, 1.1230e-01, 1.1406e+00,
        3.0625e+00, 1.0250e+01, 1.7578e+00, 2.6131e-04, 3.2812e+00, 5.4062e+00,
        4.6387e-03, 2.0469e+00, 1.9453e+00, 1.1625e+01, 2.0312e+00, 6.9531e-01,
        1.3812e+01, 1.1875e+01, 2.5469e+00, 1.5938e+00, 8.5625e+00, 1.7656e+00,
        9.9375e+00, 9.5625e+00, 4.3750e+00, 1.0562e+01, 6.2812e+00, 1.0234e+00,
        7.4375e+00, 6.5000e+00, 1.3875e+01, 1.2779e-04, 3.9531e+00, 1.5312e+00,
        2.0000e+00, 1.0864e-02, 5.0000e+00, 1.1062e+01, 4.9805e-01, 1.2500e+01,
        4.9062e+00, 3.4523e-04, 3.1250e-02, 7.3242e-04, 4.5312e+00, 6.2188e+00,
        1.6750e+01, 1.0750e+01, 4.6631e-02, 1.3125e+01, 1.0000e+01, 2.9062e+00,
        2.4531e+00, 4.3438e+00, 1.2598e-01, 1.7212e-02, 3.5000e+00, 2.2754e-01,
        3.6328e-01, 2.5153e-05, 7.8735e-03, 3.1494e-02, 4.2812e+00, 9.0000e+00,
        1.4572e-03, 9.8944e-06, 2.9375e+00, 1.6953e+00, 9.2500e+00, 3.1719e+00,
        6.6875e+00, 1.1562e+01, 6.9141e-01, 4.5625e+00, 2.0605e-01, 3.4424e-02,
        1.2012e-01, 9.8877e-03, 5.2812e+00, 1.5137e-01, 2.3365e-04, 2.0781e+00,
        4.4922e-02, 3.4219e+00, 6.9375e+00, 2.3438e+00, 2.9062e+00, 8.1250e+00,
        1.3359e+00, 3.8757e-03, 4.5000e+00, 2.1057e-03, 1.1063e-04, 5.4688e+00,
        2.0781e+00, 2.3438e-02, 2.3438e+00, 1.9043e-01, 1.0498e-01, 4.4062e+00,
        2.9219e+00, 2.8438e+00, 8.7500e+00, 5.5312e+00, 7.3125e+00, 6.0938e-01,
        1.7357e-04, 1.0071e-02], device='cuda:0', grad_fn=<NllLossBackward0>)
loss mask: tensor([False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False,  True, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False],
       device='cuda:0') loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000, 16.7500,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
       device='cuda:0', grad_fn=<MaskedFillBackward0>)
weight: tensor([[0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
         0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
         0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
         0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 1., 0., 0., 0., 0., 0.,
         0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
         0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
         0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
         0., 0.]], device='cuda:0', dtype=torch.bfloat16)
DEBUG loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000, 16.7500,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
       device='cuda:0', grad_fn=<MulBackward0>)
DEBUG: shift logits: tensor([[-3.2812, -4.9688, -2.3438,  ...,  0.3145,  0.3145,  0.3145],
        [-3.2812, -4.9688, -2.3438,  ...,  0.3145,  0.3145,  0.3145],
        [-1.3125, -3.6250, -0.4863,  ...,  1.3438,  1.3438,  1.3438],
        ...,
        [ 2.9531, -2.7969,  2.5312,  ...,  1.4062,  1.4062,  1.4062],
        [ 4.2188, -3.6562,  3.1719,  ...,  1.5156,  1.5156,  1.5156],
        [ 1.1797, -7.8438,  0.8711,  ...,  1.5391,  1.5391,  1.5391]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<ViewBackward0>) shift_labels: tensor([151644,    872,    198,     32,  17702,  40227,    536,   3937,    389,
           264,   2070,   8411,    311,    279,  40914,     11,    323,    862,
           536,    315,    220,     16,     15,   4143,  26001,    448,   2441,
           536,    448,    279,   1852,   3311,    315,   4143,     13,    220,
            20,   6562,   8900,    311,    387,    264,    521,   3191,    603,
            11,    323,    220,     17,    315,    279,  13336,    504,   2176,
          6846,    686,    387,   1052,   2238,     13,   3197,    279,   2906,
          1899,    572,    916,     11,    279,   4143,   1410,   5157,    311,
           728,   2114,    323,    220,     16,     15,    315,   1105,   2115,
            13,   9043,    315,    279,    521,   3191,   3154,   1033,   6562,
           304,    429,   1874,     11,    773,    807,   2115,    438,   1632,
            13,   2585,   1657,   7775,   1033,   2115,    518,    279,  40914,
            30, 151645,    198, 151644,  77091,    198,     32,   2790,    315,
           220,     16,     15,      9,     17,     28,   2442,     16,     15,
             9,     17], device='cuda:0')
DEBUG: loss: tensor([9.0000e+00, 1.6000e+01, 4.6387e-03, 4.4688e+00, 5.3125e+00, 4.9688e+00,
        5.0938e+00, 1.8047e+00, 9.7266e-01, 2.5482e-03, 6.0312e+00, 5.6250e-01,
        4.1504e-02, 9.6436e-03, 1.3906e+00, 1.1978e-03, 7.5073e-03, 7.8516e-01,
        1.1188e+01, 4.6875e-01, 2.4023e-01, 6.1035e-03, 7.9956e-03, 3.8281e+00,
        1.0250e+01, 6.9922e-01, 5.2734e-01, 1.0562e+01, 4.0938e+00, 1.8262e-01,
        3.1250e-02, 3.6406e+00, 9.7656e-04, 5.1250e+00, 7.6953e-01, 1.3489e-02,
        7.3242e-03, 6.4375e+00, 6.9375e+00, 1.0938e+00, 1.6719e+00, 5.8594e-01,
        6.6250e+00, 2.1562e+00, 3.9062e+00, 3.2425e-04, 2.5635e-03, 1.0303e-01,
        2.6094e+00, 5.0391e-01, 1.0300e-03, 8.9375e+00, 6.1875e+00, 6.8359e-01,
        9.9375e+00, 5.8438e+00, 1.1670e-01, 9.4141e-01, 5.6562e+00, 1.5625e-01,
        8.3750e+00, 5.7602e-04, 3.5781e+00, 6.8438e+00, 1.3965e-01, 5.2500e+00,
        2.6245e-03, 2.5635e-03, 3.2188e+00, 9.9609e-01, 1.4453e+00, 1.1572e-01,
        6.6016e-01, 4.6250e+00, 2.2888e-04, 2.3071e-02, 4.1748e-02, 8.1177e-03,
        2.3926e-01, 4.1562e+00, 1.4188e+01, 1.4258e-01, 6.9062e+00, 1.0925e-02,
        1.0834e-03, 6.9062e+00, 4.6250e+00, 5.5000e+00, 2.3438e+00, 1.2500e+01,
        5.5625e+00, 1.6484e+00, 2.8594e+00, 1.0010e-02, 5.0312e+00, 7.0801e-02,
        7.9688e+00, 8.3125e+00, 1.3562e+01, 2.1118e-02, 5.0000e+00, 6.3672e-01,
        3.1406e+00, 6.7383e-02, 8.6250e+00, 7.4375e+00, 5.0049e-03, 5.3438e+00,
        7.3438e-01, 2.0469e+00, 3.0469e-01, 7.9062e+00, 1.2812e+01, 3.9375e+00,
        1.9125e+01, 1.5438e+01, 1.9875e+01, 2.0375e+01, 2.0250e+01, 2.0500e+01,
        1.1125e+01, 2.2000e+01, 1.9625e+01, 1.7250e+01, 1.9625e+01, 2.0750e+01,
        6.8438e+00, 2.1625e+01], device='cuda:0', grad_fn=<NllLossBackward0>)
loss mask: tensor([False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False,  True,  True,  True,  True,  True,  True,
        False,  True,  True,  True,  True, False, False,  True],
       device='cuda:0') loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000, 19.1250, 15.4375, 19.8750, 20.3750, 20.2500, 20.5000,
         0.0000, 22.0000, 19.6250, 17.2500, 19.6250,  0.0000,  0.0000, 21.6250],
       device='cuda:0', grad_fn=<MaskedFillBackward0>)
weight: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.5625, 0.5195, 0.4824,
         0.4512, 0.4238, 0.4023, 0.0000, 0.3574, 0.3379, 0.3203, 0.3066, 0.0000,
         0.0000, 0.2490]], device='cuda:0', dtype=torch.bfloat16)
DEBUG loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000, 10.7578,  8.0203,  9.5881,  9.1926,  8.5825,  8.2480,
         0.0000,  7.8633,  6.6311,  5.5254,  6.0178,  0.0000,  0.0000,  5.3851],
       device='cuda:0', grad_fn=<MulBackward0>)
DEBUG: shift logits: tensor([[ 0.9570, -0.2891, -1.9688,  ...,  1.5156,  1.5156,  1.5156],
        [ 0.9570, -0.2891, -1.9688,  ...,  1.5156,  1.5156,  1.5156],
        [ 2.0156,  0.3730, -2.3750,  ...,  1.6797,  1.6797,  1.6797],
        ...,
        [ 2.8438,  0.5078,  2.6250,  ..., -0.1348, -0.1348, -0.1348],
        [ 3.0000,  0.4297,  2.9844,  ..., -0.0152, -0.0151, -0.0151],
        [ 0.4219, -2.0781, -0.2793,  ...,  0.4102,  0.4102,  0.4102]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<ViewBackward0>) shift_labels: tensor([151644,    872,    198,  64376,    594,  11079,  12607,    220,     16,
          6460,    315,   5290,   2337,    279,   9001,     13,   1913,   6602,
          3729,     11,  15033,   1349,    369,    220,     16,     21,   4420,
            13,   1913,   7728,   1340,   1349,    369,    220,     17,     23,
          4420,     13,   2585,   1657,   4420,   1558,  15033,    614,    311,
          1349,    389,   7270,    311,   4583,    279,  16319,     30, 151645,
           198, 151644,  77091,    198,  64376,   3880,    311,   1349,    369,
           220,     16,   6460,    892,  16819,    220,     21,     15,   4420,
           624,  64376,    702,   1349,    369,    264,   2790,    315,    220,
            16,     21,   4420,    488,    220,     17,     23,    284,   1115,
            16,     21,     10,     17,     23,     28,     19,     19,   2452,
            19,     19,   4420,    773,   3041,    624,  64376,    686,   1184,
           311,   1349,    369,    220,     21,     15,   4420,    481,    220,
            19,     19,    284,   1115,     21,     15,     12,     19,     19,
            28,     16], device='cuda:0')
DEBUG: loss: tensor([1.0438e+01, 1.5188e+01, 2.7344e-01, 5.0000e+00, 3.5156e-01, 4.9062e+00,
        1.3562e+01, 1.3275e-03, 1.0300e-03, 4.2812e+00, 1.1780e-02, 7.0625e+00,
        6.0625e+00, 2.3633e-01, 8.2422e-01, 1.7344e+00, 3.8750e+00, 5.0625e+00,
        4.4062e+00, 2.4170e-02, 3.2656e+00, 5.9688e+00, 5.0312e+00, 6.9046e-04,
        5.8594e-02, 3.2500e+00, 1.5938e+00, 5.5938e+00, 5.0625e+00, 4.1016e-01,
        6.1875e+00, 5.3438e+00, 6.0625e+00, 1.0147e-03, 5.4016e-03, 3.5625e+00,
        1.8750e+00, 6.5312e+00, 4.0625e+00, 3.1875e+00, 1.3828e+00, 2.0938e+00,
        2.7500e+00, 2.0312e+00, 7.2327e-03, 2.5156e+00, 3.9375e+00, 1.8203e+00,
        1.4531e+00, 7.9062e+00, 6.0120e-03, 6.0938e+00, 4.0938e+00, 2.0469e+00,
        3.3722e-03, 5.9688e+00, 1.3188e+01, 1.6113e-01, 1.4312e+01, 1.7625e+01,
        1.1438e+01, 1.7625e+01, 1.1438e+01, 6.6406e-01, 5.7500e+00, 1.8375e+01,
        1.4375e+01, 3.0469e+00, 2.7847e-04, 2.0000e+01, 1.3938e+01, 1.0125e+01,
        4.2812e+00, 1.2812e+01, 1.5750e+01, 1.8375e+01, 1.1438e+01, 1.0250e+01,
        1.8500e+01, 1.7125e+01, 8.3125e+00, 1.8250e+01, 2.0125e+01, 1.7500e+01,
        1.5125e+01, 1.0750e+01, 1.9375e+01, 2.1375e+01, 1.3625e+01, 1.5812e+01,
        1.7500e+01, 2.2625e+01, 9.6250e+00, 2.1250e+01, 1.8750e+01, 5.1250e+00,
        1.1750e+01, 4.8438e+00, 1.3812e+01, 1.7875e+01, 2.1500e+01, 1.8875e+01,
        1.9250e+01, 2.0250e+01, 2.6250e+00, 8.2500e+00, 1.6750e+01, 1.1062e+01,
        1.1279e-01, 8.1875e+00, 1.2188e+01, 6.3438e+00, 2.2000e+01, 1.8125e+01,
        1.3062e+01, 1.1312e+01, 6.9688e+00, 1.3562e+01, 1.8750e+01, 1.0750e+01,
        8.1875e+00, 2.6000e+01, 2.1875e+01, 1.2125e+01, 2.3375e+01, 2.3125e+01,
        1.1500e+01, 2.1875e+01], device='cuda:0', grad_fn=<NllLossBackward0>)
loss mask: tensor([False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False,  True, False,
         True, False,  True, False, False,  True, False, False, False,  True,
        False, False,  True,  True,  True, False, False, False,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True, False,  True,
        False,  True, False,  True, False, False, False, False,  True, False,
         True,  True,  True,  True, False, False,  True, False, False,  True,
         True, False,  True, False,  True,  True, False, False,  True, False,
        False,  True,  True,  True,  True,  True, False,  True],
       device='cuda:0') loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000, 14.3125,  0.0000, 11.4375,  0.0000, 11.4375,  0.0000,
         0.0000, 18.3750,  0.0000,  0.0000,  0.0000, 20.0000,  0.0000,  0.0000,
         4.2812, 12.8125, 15.7500,  0.0000,  0.0000,  0.0000, 18.5000, 17.1250,
         8.3125, 18.2500, 20.1250, 17.5000, 15.1250, 10.7500, 19.3750, 21.3750,
         0.0000, 15.8125,  0.0000, 22.6250,  0.0000, 21.2500,  0.0000,  0.0000,
         0.0000,  0.0000, 13.8125,  0.0000, 21.5000, 18.8750, 19.2500, 20.2500,
         0.0000,  0.0000, 16.7500,  0.0000,  0.0000,  8.1875, 12.1875,  0.0000,
        22.0000,  0.0000, 13.0625, 11.3125,  0.0000,  0.0000, 18.7500,  0.0000,
         0.0000, 26.0000, 21.8750, 12.1250, 23.3750, 23.1250,  0.0000, 21.8750],
       device='cuda:0', grad_fn=<MaskedFillBackward0>)
weight: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.7852, 0.0000, 0.7461, 0.0000, 0.7148,
         0.0000, 0.0000, 0.6758, 0.0000, 0.0000, 0.0000, 0.6133, 0.0000, 0.0000,
         0.5508, 0.5312, 0.5195, 0.0000, 0.0000, 0.0000, 0.4473, 0.4258, 0.4082,
         0.3965, 0.3867, 0.3828, 0.3828, 0.3887, 0.3965, 0.4102, 0.0000, 0.4395,
         0.0000, 0.4629, 0.0000, 0.4844, 0.0000, 0.0000, 0.0000, 0.0000, 0.4883,
         0.0000, 0.4707, 0.4629, 0.4609, 0.4648, 0.0000, 0.0000, 0.4688, 0.0000,
         0.0000, 0.4512, 0.4434, 0.0000, 0.4316, 0.0000, 0.4160, 0.4082, 0.0000,
         0.0000, 0.3789, 0.0000, 0.0000, 0.3164, 0.2930, 0.2715, 0.2520, 0.2373,
         0.0000, 0.2012]], device='cuda:0', dtype=torch.bfloat16)
DEBUG loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000, 11.2375,  0.0000,  8.5334,  0.0000,  8.1760,  0.0000,
         0.0000, 12.4175,  0.0000,  0.0000,  0.0000, 12.2656,  0.0000,  0.0000,
         2.3580,  6.8066,  8.1826,  0.0000,  0.0000,  0.0000,  8.2744,  7.2915,
         3.3932,  7.2358,  7.7827,  6.6992,  5.7900,  4.1782,  7.6819,  8.7671,
         0.0000,  6.9489,  0.0000, 10.4729,  0.0000, 10.2930,  0.0000,  0.0000,
         0.0000,  0.0000,  6.7444,  0.0000, 10.1201,  8.7371,  8.8730,  9.4131,
         0.0000,  0.0000,  7.8516,  0.0000,  0.0000,  3.6940,  5.4034,  0.0000,
         9.4961,  0.0000,  5.4342,  4.6178,  0.0000,  0.0000,  7.1045,  0.0000,
         0.0000,  8.2266,  6.4087,  3.2917,  5.8894,  5.4877,  0.0000,  4.4006],
       device='cuda:0', grad_fn=<MulBackward0>)
DEBUG: shift logits: tensor([[ 1.8438, -0.1289,  0.9922,  ...,  0.5430,  0.5430,  0.5430],
        [ 1.8438, -0.1289,  0.9922,  ...,  0.5430,  0.5430,  0.5430],
        [ 3.4219,  0.5547,  1.6172,  ...,  1.0156,  1.0156,  1.0156],
        ...,
        [ 2.3594, -3.0156,  0.1670,  ...,  0.4199,  0.4199,  0.4199],
        [ 0.4102, -5.9688, -2.1719,  ...,  1.2812,  1.2812,  1.2812],
        [ 0.4648, -4.2812, -1.8203,  ...,  0.4160,  0.4160,  0.4160]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<ViewBackward0>) shift_labels: tensor([151644,    872,    198,    785,  30130,    315,    264,   5297,  19240,
         78671,    374,    220,     16,     15,   7541,   3403,    279,   4910,
            13,    220,  22406,     11,   1429,  11647,    686,   1977,    429,
           264,   2781,   1969,    387,   2952,    311,   5545,    518,   3245,
           220,     21,  14924,   3403,    279,  30130,    311,  63472,    264,
         19240,     13,    220,  82610,    264,  19240,   2781,    374,    220,
            21,   7541,  16217,    323,    646,   5545,    220,     17,     17,
         14924,   3403,    862,   1968,   1667,    279,  26204,    848,    315,
           862,  11715,     13,    220,   2585,   1550,   1969,    419,   2781,
           387,   2952,    311,   7784,    311,   5545,    220,     21,  14924,
          3403,    279,  30130,    311,  63472,    264,  19240,     30, 151645,
           198, 151644,  77091,    198,    641,  14924,     11,    279,   2608,
           315,    279,  30130,    374,    220,     16,     15,      9,     16,
            17,    284,   1115,     16,     15,      9,     16,     17,     28,
            16,     17], device='cuda:0')
DEBUG: loss: tensor([1.0438e+01, 1.3125e+01, 2.4375e+00, 1.2312e+01, 1.2062e+01, 2.7344e+00,
        4.2188e+00, 1.1000e+01, 4.6250e+00, 5.8125e+00, 8.1250e+00, 2.8594e+00,
        2.2266e-01, 2.0020e-01, 4.5938e+00, 8.1250e+00, 1.2500e-01, 1.2688e+01,
        6.0000e+00, 3.3398e-01, 1.0250e+01, 4.6875e-01, 1.1562e+01, 8.8750e+00,
        5.3750e+00, 7.6875e+00, 3.7500e+00, 4.9062e+00, 7.8438e+00, 6.6562e+00,
        2.9844e+00, 5.2188e+00, 4.0000e+00, 7.1562e+00, 9.1875e+00, 4.7500e+00,
        3.7109e-02, 3.3594e+00, 3.0469e+00, 8.1875e+00, 2.2363e-01, 7.5000e+00,
        5.2188e+00, 1.1250e+01, 4.4141e-01, 1.2969e+00, 4.3750e+00, 3.0664e-01,
        1.3125e+01, 5.9062e+00, 3.6875e+00, 6.6562e+00, 1.8750e+00, 1.9297e+00,
        3.2188e+00, 3.6094e+00, 1.0000e+01, 2.2125e-03, 9.8750e+00, 6.5938e+00,
        8.5547e-01, 2.1250e+00, 3.3438e+00, 2.4531e+00, 8.2500e+00, 1.1000e+01,
        1.3125e+01, 1.0375e+01, 5.6250e-01, 5.1875e+00, 1.7125e+01, 1.1963e-01,
        8.6875e+00, 6.1250e+00, 5.6562e+00, 8.9453e-01, 1.0562e+01, 1.0625e+01,
        6.8750e+00, 3.9453e-01, 8.0000e+00, 2.6562e+00, 5.6562e+00, 9.2578e-01,
        5.6875e+00, 3.3594e+00, 4.3750e+00, 2.1362e-02, 4.4336e-01, 3.8125e+00,
        6.8438e+00, 2.6611e-02, 1.0562e+01, 4.3125e+00, 6.7812e+00, 2.1240e-02,
        1.0078e+00, 1.7812e+00, 4.2500e+00, 1.7188e+00, 7.8750e+00, 1.1812e+01,
        2.3906e+00, 1.5938e+01, 9.5000e+00, 6.8665e-03, 1.2256e-01, 1.0562e+01,
        9.8267e-03, 4.6387e-03, 1.2125e+01, 3.2227e-01, 1.7166e-03, 2.2852e-01,
        9.4141e-01, 1.4551e-01, 1.4688e+01, 8.4375e+00, 1.8875e+01, 1.1688e+01,
        5.8594e-01, 1.4609e+00, 2.4219e+00, 3.2188e+00, 2.9688e+00, 8.8750e+00,
        2.5938e+00, 3.1094e+00], device='cuda:0', grad_fn=<NllLossBackward0>)
loss mask: tensor([False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False,  True, False,  True, False,
        False, False, False, False, False, False, False, False],
       device='cuda:0') loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000, 14.6875,  0.0000, 18.8750,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
       device='cuda:0', grad_fn=<MaskedFillBackward0>)
weight: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.7969,
         0.0000, 0.7617, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000]], device='cuda:0', dtype=torch.bfloat16)
DEBUG loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000, 11.7041,  0.0000, 14.3774,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
       device='cuda:0', grad_fn=<MulBackward0>)
DEBUG: shift logits: tensor([[-1.5938, -0.8438, -2.6094,  ...,  2.1875,  2.1875,  2.1875],
        [-1.5938, -0.8438, -2.6094,  ...,  2.1875,  2.1875,  2.1875],
        [ 1.7734,  1.8203, -0.9023,  ...,  2.7188,  2.7188,  2.7188],
        ...,
        [-0.7734, -1.7812,  0.1436,  ...,  1.8906,  1.8906,  1.8906],
        [-0.1992, -2.3438,  0.6797,  ...,  1.5312,  1.5312,  1.5312],
        [ 0.6641, -2.1406,  1.4297,  ...,  1.5938,  1.5938,  1.5938]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<ViewBackward0>) shift_labels: tensor([151644,    872,    198,   2679,  88245,    594,   8511,    572,    400,
            16,     15,    803,   1091,    358,   3235,    594,   8511,     11,
           323,    358,   3235,    594,   8511,    572,    400,     18,     15,
           803,   1091,  19685,    594,   8511,     11,    323,  19685,    594,
          8511,    572,    400,     16,     15,   2686,   1091,   6898,    482,
           594,   8511,     11,    323,   1537,    398,   6898,    482,    594,
          8511,    572,    400,     18,     15,     11,   1246,   1753,   1521,
           678,    279,  22786,   8329,    389,  25365,   2182,   3786,     30,
        151645,    198, 151644,  77091,    198,  67909,    594,   8511,    572,
           400,     16,     15,   2686,   1091,   6898,    482,    594,    400,
            18,     15,   8511,     11,   7290,    432,    572,    220,     18,
            15,     12,     16,     15,     28,   1115,     18,     15,     12,
            16,     15,     28,     17,     15,   2452,     17,     15,  11192,
           624,    764,     64,    594,   8511,    572,    400,     18,     15,
           803,   1091], device='cuda:0')
DEBUG: loss: tensor([1.0500e+01, 1.6375e+01, 2.2949e-01, 1.1188e+01, 6.0000e+00, 1.5335e-03,
        3.7188e+00, 1.4062e-01, 3.7598e-02, 5.0659e-03, 1.1963e-02, 3.0781e+00,
        2.4414e-01, 4.5898e-01, 1.2266e+00, 1.3275e-03, 1.7656e+00, 1.5945e-03,
        5.1498e-04, 1.3281e+00, 1.6895e-01, 4.2534e-04, 8.1250e-01, 2.6250e+00,
        4.3701e-02, 3.6562e+00, 1.7929e-04, 2.9375e+00, 3.7188e+00, 2.9688e+00,
        3.0975e-03, 1.3047e+00, 1.0347e-04, 5.8365e-04, 3.4062e+00, 6.5994e-04,
        3.2969e+00, 1.6641e+00, 2.3828e-01, 4.1504e-02, 8.3923e-04, 3.7344e+00,
        1.1641e+00, 5.7188e+00, 2.9375e+00, 4.3106e-04, 4.4688e+00, 8.7357e-04,
        1.9226e-03, 1.2000e+01, 2.3750e+00, 1.0875e+01, 5.5000e+00, 1.1182e-01,
        5.1250e+00, 8.9375e+00, 4.9219e-01, 4.4688e+00, 3.9673e-03, 9.6512e-04,
        8.8125e+00, 6.2891e-01, 5.8438e+00, 1.0781e+00, 2.4292e-02, 2.7734e-01,
        2.3281e+00, 5.2979e-02, 5.0938e+00, 3.4062e+00, 2.5781e-01, 6.3281e-01,
        1.0859e+00, 9.6436e-03, 6.5938e+00, 1.8000e+01, 7.6172e-01, 2.1125e+01,
        2.4125e+01, 1.8250e+01, 1.5750e+01, 1.7875e+01, 2.1625e+01, 2.0500e+01,
        1.4875e+01, 2.3375e+01, 1.9750e+01, 1.7375e+01, 9.0000e+00, 2.7500e+00,
        2.2250e+01, 1.8500e+01, 2.0000e+01, 1.2812e+01, 1.9125e+01, 1.7250e+01,
        1.6125e+01, 1.5688e+01, 2.3000e+01, 2.0375e+01, 1.0875e+01, 2.0625e+01,
        2.0500e+01, 1.5938e+01, 1.6875e+01, 2.3500e+01, 2.0625e+01, 1.0750e+01,
        2.0875e+01, 1.9250e+01, 1.4688e+01, 2.0000e+01, 2.0500e+01, 1.3938e+01,
        2.1125e+01, 2.1000e+01, 2.0125e+01, 1.1625e+01, 2.4125e+01, 1.9750e+01,
        2.0500e+01, 1.9125e+01, 1.7250e+01, 1.6000e+01, 2.2375e+01, 5.0938e+00,
        1.8125e+01, 2.0625e+01], device='cuda:0', grad_fn=<NllLossBackward0>)
loss mask: tensor([False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False,  True,  True,  True,
         True,  True,  True,  True,  True, False,  True, False, False, False,
         True,  True,  True, False,  True,  True, False,  True,  True,  True,
         True,  True,  True, False,  True,  True,  True, False,  True,  True,
         True,  True, False,  True,  True,  True,  True, False,  True, False,
         True,  True, False,  True, False, False,  True,  True],
       device='cuda:0') loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000, 21.1250, 24.1250, 18.2500,
        15.7500, 17.8750, 21.6250, 20.5000, 14.8750,  0.0000, 19.7500,  0.0000,
         0.0000,  0.0000, 22.2500, 18.5000, 20.0000,  0.0000, 19.1250, 17.2500,
         0.0000, 15.6875, 23.0000, 20.3750, 10.8750, 20.6250, 20.5000,  0.0000,
        16.8750, 23.5000, 20.6250,  0.0000, 20.8750, 19.2500, 14.6875, 20.0000,
         0.0000, 13.9375, 21.1250, 21.0000, 20.1250,  0.0000, 24.1250,  0.0000,
        20.5000, 19.1250,  0.0000, 16.0000,  0.0000,  0.0000, 18.1250, 20.6250],
       device='cuda:0', grad_fn=<MaskedFillBackward0>)
weight: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.6055, 0.5664, 0.5352, 0.5078,
         0.4863, 0.4727, 0.4609, 0.4570, 0.0000, 0.4512, 0.0000, 0.0000, 0.0000,
         0.4043, 0.3867, 0.3750, 0.0000, 0.3496, 0.3359, 0.0000, 0.3105, 0.2969,
         0.2871, 0.2793, 0.2754, 0.2734, 0.0000, 0.2695, 0.2656, 0.2656, 0.0000,
         0.2617, 0.2578, 0.2578, 0.2598, 0.0000, 0.2617, 0.2617, 0.2637, 0.2676,
         0.0000, 0.2754, 0.0000, 0.2715, 0.2695, 0.0000, 0.2598, 0.0000, 0.0000,
         0.2148, 0.1934]], device='cuda:0', dtype=torch.bfloat16)
DEBUG loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000, 12.7905, 13.6646,  9.7666,
         7.9980,  8.6931, 10.2212,  9.4492,  6.7983,  0.0000,  8.9106,  0.0000,
         0.0000,  0.0000,  8.9956,  7.1543,  7.5000,  0.0000,  6.6863,  5.7949,
         0.0000,  4.8717,  6.8281,  5.8499,  3.0374,  5.6799,  5.6055,  0.0000,
         4.5483,  6.2422,  5.4785,  0.0000,  5.4634,  4.9629,  3.7866,  5.1953,
         0.0000,  3.6477,  5.5288,  5.5371,  5.3850,  0.0000,  6.6438,  0.0000,
         5.5654,  5.1548,  0.0000,  4.1562,  0.0000,  0.0000,  3.8940,  3.9880],
       device='cuda:0', grad_fn=<MulBackward0>)
DEBUG: shift logits: tensor([[ 4.8125, -0.7969,  4.4375,  ...,  0.8281,  0.8281,  0.8281],
        [ 4.8125, -0.7969,  4.4375,  ...,  0.8281,  0.8281,  0.8281],
        [ 6.2188, -0.0209,  4.5312,  ...,  0.8203,  0.8203,  0.8203],
        ...,
        [ 4.3438, -2.0000,  4.2188,  ...,  0.1357,  0.1357,  0.1357],
        [ 4.2812, -2.0625,  4.1562,  ...,  0.1348,  0.1348,  0.1348],
        [ 4.3125, -2.0312,  4.1562,  ...,  0.1069,  0.1069,  0.1069]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<ViewBackward0>) shift_labels: tensor([151644,    872,    198,  22493,    301,    374,    220,     20,   1635,
          2310,    323,    806,  17760,    374,    220,     18,     17,   1635,
          2310,     13,    220,   2585,   2310,    686,  38347,    387,    979,
           806,  17760,    374,  10917,    438,   2310,    438,   1435,     30,
        151645,    198, 151644,  77091,    198,    785,   6672,    304,   4231,
          1948,  38347,    323,    806,  17760,    374,    220,     18,     17,
           481,    220,     20,    284,   1115,     18,     17,     12,     20,
            28,     17,     22,   2452,     17,     22,   1635,    624,   4498,
           498,   1990,    419,  12929,    304,   1635,     11,    498,    614,
           220,     17,     22,    856,    220,     17,    284,   1115,     17,
            22,      9,     17,     28,     20,     19,   2452,     20,     19,
           624,   4498,    806,  17760,    374,    220,     20,     19,     11,
         38347,    686,    387,    220,     20,     19,    608,    220,     17,
           284,   1115,     20,     19,     14,     17,     28,     17,     22,
          2452,     17], device='cuda:0')
DEBUG: loss: tensor([1.1250e+01, 1.2250e+01, 4.2969e-01, 1.4812e+01, 6.9062e+00, 1.5547e+00,
        1.2634e-02, 7.0703e-01, 4.3164e-01, 5.4688e-02, 8.1543e-02, 1.0107e-01,
        1.1562e+00, 7.1289e-02, 1.6479e-03, 7.6562e-01, 9.4727e-02, 5.0781e-01,
        8.1543e-02, 7.0703e-01, 5.2185e-03, 4.1562e+00, 1.7090e-01, 1.4375e+00,
        3.7344e+00, 2.7148e-01, 2.3906e+00, 6.6895e-02, 2.4062e+00, 6.0938e-01,
        6.5000e+00, 1.7480e-01, 6.9141e-01, 8.9844e-02, 3.9062e+00, 1.1094e+00,
        2.9375e+00, 6.5308e-03, 7.5312e+00, 1.7875e+01, 1.9141e-01, 1.0875e+01,
        1.7250e+01, 1.0812e+01, 2.0625e+01, 1.0625e+01, 2.1375e+01, 9.0625e+00,
        3.6562e+00, 1.1812e+01, 4.4688e+00, 2.8419e-04, 2.0312e+00, 9.6250e+00,
        1.1375e+01, 8.3750e+00, 1.8250e+01, 1.7125e+01, 1.5938e+01, 2.0125e+01,
        1.6250e+01, 5.4688e+00, 1.7375e+01, 9.0625e+00, 4.2500e+00, 1.7625e+01,
        1.0812e+01, 1.6875e+01, 1.9875e+01, 1.7000e+01, 2.4844e+00, 1.7875e+01,
        1.8250e+01, 2.0625e+01, 1.8750e+01, 1.0688e+01, 1.5625e+01, 1.3688e+01,
        8.7500e+00, 1.3688e+01, 1.8000e+01, 6.0312e+00, 1.4312e+01, 1.8375e+01,
        2.2000e+01, 1.4812e+01, 1.6000e+01, 1.6250e+01, 1.5375e+01, 1.6125e+01,
        1.9750e+01, 1.0750e+01, 1.6250e+01, 1.1250e+01, 1.5562e+01, 8.0000e+00,
        7.0312e+00, 6.9688e+00, 2.7188e+00, 9.8750e+00, 1.9000e+01, 1.5250e+01,
        1.7125e+01, 2.5781e-01, 2.1935e-04, 7.5938e+00, 9.0625e+00, 8.3125e+00,
        2.6500e+01, 1.6250e+01, 1.4375e+00, 7.3438e-01, 7.4688e+00, 6.1523e-02,
        5.6250e-01, 1.2875e+01, 1.6125e+01, 1.7000e+01, 1.7750e+01, 1.3438e+01,
        1.0250e+01, 1.4188e+01, 1.7750e+01, 1.3688e+01, 1.8750e+01, 2.0000e+01,
        1.2812e+01, 1.9000e+01], device='cuda:0', grad_fn=<NllLossBackward0>)
loss mask: tensor([False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False,  True, False,  True,  True,  True, False, False,  True,
        False, False, False,  True,  True,  True,  True,  True,  True,  True,
         True, False,  True, False, False,  True,  True,  True,  True, False,
        False,  True,  True, False,  True, False,  True, False,  True, False,
         True, False,  True,  True, False,  True,  True,  True,  True,  True,
         True,  True,  True,  True, False, False, False, False, False,  True,
        False,  True, False, False, False,  True, False,  True,  True, False,
        False,  True, False, False, False,  True,  True,  True,  True, False,
         True,  True,  True,  True,  True,  True,  True,  True],
       device='cuda:0') loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000, 17.2500,  0.0000, 20.6250, 10.6250, 21.3750,  0.0000,
         0.0000, 11.8125,  0.0000,  0.0000,  0.0000,  9.6250, 11.3750,  8.3750,
        18.2500, 17.1250, 15.9375, 20.1250, 16.2500,  0.0000, 17.3750,  0.0000,
         0.0000, 17.6250, 10.8125, 16.8750, 19.8750,  0.0000,  0.0000, 17.8750,
        18.2500,  0.0000, 18.7500,  0.0000, 15.6250,  0.0000,  8.7500,  0.0000,
        18.0000,  0.0000, 14.3125, 18.3750,  0.0000, 14.8125, 16.0000, 16.2500,
        15.3750, 16.1250, 19.7500, 10.7500, 16.2500, 11.2500,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  9.8750,  0.0000, 15.2500,  0.0000,  0.0000,
         0.0000,  7.5938,  0.0000,  8.3125, 26.5000,  0.0000,  0.0000,  0.7344,
         0.0000,  0.0000,  0.0000, 12.8750, 16.1250, 17.0000, 17.7500,  0.0000,
        10.2500, 14.1875, 17.7500, 13.6875, 18.7500, 20.0000, 12.8125, 19.0000],
       device='cuda:0', grad_fn=<MaskedFillBackward0>)
weight: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.7070, 0.0000, 0.6484,
         0.6289, 0.6094, 0.0000, 0.0000, 0.5703, 0.0000, 0.0000, 0.0000, 0.4824,
         0.4570, 0.4375, 0.4238, 0.4121, 0.4082, 0.4062, 0.4102, 0.0000, 0.4180,
         0.0000, 0.0000, 0.4141, 0.4102, 0.4102, 0.4141, 0.0000, 0.0000, 0.4238,
         0.4238, 0.0000, 0.4277, 0.0000, 0.4258, 0.0000, 0.4199, 0.0000, 0.4102,
         0.0000, 0.3945, 0.3867, 0.0000, 0.3750, 0.3691, 0.3672, 0.3691, 0.3750,
         0.3867, 0.4004, 0.4199, 0.4434, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.5234, 0.0000, 0.5273, 0.0000, 0.0000, 0.0000, 0.5078, 0.0000, 0.4863,
         0.4785, 0.0000, 0.0000, 0.4492, 0.0000, 0.0000, 0.0000, 0.3613, 0.3340,
         0.3086, 0.2871, 0.0000, 0.2422, 0.2178, 0.1963, 0.1768, 0.1592, 0.1436,
         0.1289, 0.1157]], device='cuda:0', dtype=torch.bfloat16)
DEBUG loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000, 12.1963,  0.0000, 13.3740,  6.6821, 13.0254,  0.0000,
         0.0000,  6.7368,  0.0000,  0.0000,  0.0000,  4.6433,  5.1987,  3.6641,
         7.7349,  7.0574,  6.5057,  8.1758,  6.6650,  0.0000,  7.2622,  0.0000,
         0.0000,  7.2979,  4.4348,  6.9214,  8.2295,  0.0000,  0.0000,  7.5759,
         7.7349,  0.0000,  8.0200,  0.0000,  6.6528,  0.0000,  3.6743,  0.0000,
         7.3828,  0.0000,  5.6467,  7.1060,  0.0000,  5.5547,  5.9062,  5.9668,
         5.6755,  6.0469,  7.6377,  4.3042,  6.8237,  4.9878,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  5.1689,  0.0000,  8.0420,  0.0000,  0.0000,
         0.0000,  3.8562,  0.0000,  4.0426, 12.6807,  0.0000,  0.0000,  0.3299,
         0.0000,  0.0000,  0.0000,  4.6521,  5.3855,  5.2461,  5.0962,  0.0000,
         2.4824,  3.0897,  3.4841,  2.4194,  2.9846,  2.8711,  1.6516,  2.1987],
       device='cuda:0', grad_fn=<MulBackward0>)
DEBUG: shift logits: tensor([[ 5.5000, -1.0234, -0.8789,  ...,  1.8281,  1.8281,  1.8281],
        [ 5.5000, -1.0234, -0.8789,  ...,  1.8281,  1.8281,  1.8281],
        [ 6.6562,  0.0405, -1.7500,  ...,  0.5508,  0.5508,  0.5508],
        ...,
        [ 8.5625, -0.9023,  4.5938,  ...,  0.5469,  0.5469,  0.5469],
        [ 3.5625, -8.6875, -0.5508,  ...,  1.4922,  1.4922,  1.4922],
        [ 9.1250, -0.7656,  4.6250,  ...,  0.4043,  0.4043,  0.4043]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<ViewBackward0>) shift_labels: tensor([151644,    872,    198,  79771,  36313,    388,  12590,     13,    220,
           576,   3368,  29987,   5562,  49677,    220,     16,     13,     20,
         25374,    315,   3607,     11,   2326,   3039,    264,   1899,     13,
           220,    576,  56625,   1817,   8180,    220,     16,     14,     17,
         10525,    315,   3607,     11,  10917,    264,   1899,     13,    220,
          2619,    525,    220,     20,  56625,     13,    220,   2585,   1753,
          3607,    686,  27138,   1184,    369,    279,   1790,    220,     21,
          2849,     30, 151645,    198, 151644,  77091,    198,    785,   3368,
          5562,  49677,    220,     16,     13,     20,  25374,    315,   3607,
           353,    220,     18,    284,   1115,     16,     13,     20,      9,
            18,     28,     19,     13,     20,   2452,     19,     13,     20,
         25374,    817,   1899,    624,   2461,    220,     21,   2849,    279,
          3368,   5562,    686,   1184,    220,     21,    353,    220,     19,
            13,     20,  25374,    284,   1115,     21,      9,     19,     13,
            20,     28], device='cuda:0')
DEBUG: loss: tensor([1.5875e+01, 1.3062e+01, 2.4531e+00, 1.5812e+01, 7.9062e+00, 6.2812e+00,
        4.7812e+00, 1.7422e+00, 2.1387e-01, 2.4688e+00, 1.1062e+01, 7.9062e+00,
        4.0312e+00, 8.3750e+00, 6.0791e-02, 2.0508e-01, 1.8164e-01, 4.9414e-01,
        9.5000e+00, 3.2344e+00, 7.9375e+00, 3.5547e-01, 7.0938e+00, 9.0000e+00,
        6.1250e+00, 6.4375e+00, 2.6562e+00, 2.1484e-01, 3.0312e+00, 8.1875e+00,
        6.4062e+00, 5.8438e+00, 2.8198e-02, 3.2617e-01, 3.4961e-01, 5.2188e+00,
        9.6250e+00, 2.6875e+00, 8.0625e+00, 2.0117e-01, 1.1625e+01, 6.8125e+00,
        5.5625e+00, 3.7969e+00, 1.2500e-01, 5.5938e+00, 7.5625e+00, 3.3691e-02,
        2.1719e+00, 8.2500e+00, 5.0000e+00, 1.8555e-01, 9.1250e+00, 7.1875e+00,
        9.8125e+00, 8.0000e+00, 1.2062e+01, 7.2812e+00, 8.2812e-01, 2.7148e-01,
        2.5156e+00, 5.3406e-03, 9.5703e-01, 4.6250e+00, 8.0859e-01, 4.5000e+00,
        5.1562e-01, 7.7500e+00, 1.0812e+01, 3.6875e+00, 9.4375e+00, 1.2000e+01,
        1.9766e+00, 3.8906e+00, 6.4375e+00, 1.3203e+00, 7.9375e+00, 8.9453e-01,
        1.4062e+01, 2.5625e+00, 1.0125e+01, 4.9688e+00, 3.7598e-02, 5.5625e+00,
        1.2125e+01, 5.9375e+00, 6.6562e+00, 3.8438e+00, 1.3359e+00, 2.4844e+00,
        4.5625e+00, 6.6250e+00, 3.7500e+00, 1.9043e-01, 2.3047e-01, 9.0000e+00,
        1.0188e+01, 3.5000e+00, 4.0938e+00, 1.6375e+01, 1.0812e+01, 8.1875e+00,
        5.1172e-01, 4.4062e+00, 8.8750e+00, 2.3750e+00, 8.2500e+00, 1.4531e+00,
        8.2500e+00, 1.3516e+00, 2.3438e+00, 4.8125e+00, 6.4453e-02, 4.3438e+00,
        2.0781e+00, 2.6398e-03, 3.2344e+00, 1.3123e-02, 2.0996e-02, 1.0688e+01,
        6.5000e+00, 6.6875e+00, 4.7500e+00, 2.0938e+00, 3.4375e+00, 1.9238e-01,
        1.4221e-02, 4.5312e+00], device='cuda:0', grad_fn=<NllLossBackward0>)
loss mask: tensor([False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False,  True, False,  True, False, False, False,
        False, False, False,  True, False, False,  True, False, False, False,
        False, False, False, False, False, False,  True, False, False, False,
        False, False, False, False,  True, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False],
       device='cuda:0') loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  6.4375,  0.0000,  7.9375,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  5.5625,  0.0000,  0.0000,  6.6562,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
        10.1875,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         8.8750,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000],
       device='cuda:0', grad_fn=<MaskedFillBackward0>)
weight: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.9062, 0.0000, 0.8984, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.8867, 0.0000, 0.0000, 0.8906, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.9102, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.9102, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000]], device='cuda:0', dtype=torch.bfloat16)
DEBUG loss: tensor([0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 5.8340, 0.0000, 7.1313, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 4.9324, 0.0000, 0.0000, 5.9282, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 9.2722, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 8.0776, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000], device='cuda:0', grad_fn=<MulBackward0>)
DEBUG: shift logits: tensor([[ 6.3750, -1.5312,  1.0625,  ...,  1.6953,  1.6953,  1.6953],
        [ 6.3750, -1.5312,  1.0625,  ...,  1.6953,  1.6953,  1.6953],
        [ 7.1562, -2.0156,  0.2471,  ...,  1.0781,  1.0781,  1.0781],
        ...,
        [ 5.0625, -3.7656,  2.0625,  ...,  0.3867,  0.3867,  0.3867],
        [ 5.0000, -3.7031,  2.0938,  ...,  0.4453,  0.4453,  0.4453],
        [ 5.0938, -3.6094,  2.1562,  ...,  0.4609,  0.4609,  0.4609]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<ViewBackward0>) shift_labels: tensor([151644,    872,    198,   8949,    374,    220,     22,   1635,   9014,
          1091,  28693,     11,    879,    374,    220,     16,     20,     13,
          2585,   2310,    686,   4389,    387,    304,    220,     20,   1635,
            30, 151645,    198, 151644,  77091,    198,   8949,    374,    220,
            16,     20,   1635,    488,    220,     22,   1635,    284,   1115,
            16,     20,     10,     22,     28,     17,     17,   2452,     17,
            17,   1635,   2310,    624,    641,    220,     20,   1635,     11,
           566,    686,    387,    220,     17,     17,   1635,    488,    220,
            20,   1635,    284,   1115,     17,     17,     10,     20,     28,
            17,     22,   2452,     17,     22,   1635,   2310,    624,    820,
           220,     17,     22, 151645, 151643, 151643, 151643, 151643, 151643,
        151643, 151643, 151643, 151643, 151643, 151643, 151643, 151643, 151643,
        151643, 151643, 151643, 151643, 151643, 151643, 151643, 151643, 151643,
        151643, 151643, 151643, 151643, 151643, 151643, 151643, 151643, 151643,
        151643, 151643], device='cuda:0')
DEBUG: loss: tensor([1.4312e+01, 1.3500e+01, 2.7930e-01, 1.1312e+01, 1.6895e-01, 5.8746e-04,
        4.0938e+00, 7.7812e+00, 3.1406e+00, 9.2578e-01, 7.1094e-01, 2.3804e-03,
        6.6797e-01, 4.1992e-02, 7.7057e-04, 1.6235e-02, 6.6406e-02, 7.0190e-04,
        4.3750e+00, 6.3965e-02, 4.6250e+00, 9.8125e+00, 4.8242e-01, 4.8125e+00,
        2.7275e-04, 4.2812e+00, 6.1250e+00, 1.2109e+00, 1.6953e+00, 7.4707e-02,
        8.3750e+00, 1.5688e+01, 2.4316e-01, 2.1250e+01, 1.4750e+01, 7.6250e+00,
        1.1938e+01, 1.3125e+01, 1.9625e+01, 1.1938e+01, 1.0925e-02, 4.7812e+00,
        1.2062e+01, 1.0500e+01, 1.1812e+01, 1.2688e+01, 8.8750e+00, 1.4438e+01,
        1.6375e+01, 1.1688e+01, 1.3688e+01, 1.3625e+01, 1.4562e+01, 1.6250e+01,
        1.3188e+01, 2.1250e+01, 1.4125e+01, 8.0000e+00, 1.8750e+01, 1.1000e+01,
        1.5062e+01, 2.1750e+01, 9.1875e+00, 1.8750e+01, 1.6125e+01, 1.9125e+01,
        1.2438e+01, 1.6750e+01, 1.7125e+01, 2.1750e+01, 1.5312e+01, 1.1875e+01,
        1.5500e+01, 2.2250e+01, 1.4125e+01, 1.4938e+01, 1.5500e+01, 1.5688e+01,
        1.7125e+01, 1.6000e+01, 1.3125e+01, 1.5750e+01, 1.8750e+01, 1.4500e+01,
        1.6375e+01, 1.9125e+01, 2.2750e+01, 1.5062e+01, 1.0062e+01, 1.4625e+01,
        1.2562e+01, 1.5500e+01, 1.7250e+01, 4.2188e+00, 5.1875e+00, 4.3125e+00,
        3.8750e+00, 5.1250e+00, 4.9062e+00, 5.1250e+00, 5.3438e+00, 4.8125e+00,
        4.8750e+00, 4.4062e+00, 4.0625e+00, 5.3125e+00, 4.8125e+00, 4.9062e+00,
        5.4062e+00, 6.1250e+00, 6.2500e+00, 4.7812e+00, 4.0625e+00, 5.8125e+00,
        5.2812e+00, 5.2812e+00, 5.5000e+00, 5.7500e+00, 5.7188e+00, 6.0000e+00,
        5.8750e+00, 5.8750e+00, 5.8125e+00, 5.9062e+00, 6.0312e+00, 6.1562e+00,
        6.4062e+00, 6.4062e+00], device='cuda:0', grad_fn=<NllLossBackward0>)
loss mask: tensor([False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False,  True,  True,  True,  True,  True,  True, False,
        False, False,  True,  True,  True, False,  True,  True,  True,  True,
         True,  True, False,  True,  True,  True,  True, False,  True,  True,
         True,  True,  True,  True,  True,  True,  True, False,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True, False,  True,
         True, False,  True,  True, False, False,  True,  True,  True,  True,
        False, False, False, False,  True,  True,  True,  True,  True,  True,
        False, False,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True],
       device='cuda:0') loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000, 21.2500, 14.7500,  7.6250, 11.9375, 13.1250, 19.6250,  0.0000,
         0.0000,  0.0000, 12.0625, 10.5000, 11.8125,  0.0000,  8.8750, 14.4375,
        16.3750, 11.6875, 13.6875, 13.6250,  0.0000, 16.2500, 13.1875, 21.2500,
        14.1250,  0.0000, 18.7500, 11.0000, 15.0625, 21.7500,  9.1875, 18.7500,
        16.1250, 19.1250, 12.4375,  0.0000, 17.1250, 21.7500, 15.3125, 11.8750,
        15.5000, 22.2500, 14.1250, 14.9375, 15.5000, 15.6875, 17.1250, 16.0000,
        13.1250, 15.7500, 18.7500, 14.5000, 16.3750, 19.1250, 22.7500, 15.0625,
         0.0000, 14.6250, 12.5625,  0.0000, 17.2500,  4.2188,  0.0000,  0.0000,
         3.8750,  5.1250,  4.9062,  5.1250,  0.0000,  0.0000,  0.0000,  0.0000,
         4.0625,  5.3125,  4.8125,  4.9062,  5.4062,  6.1250,  0.0000,  0.0000,
         4.0625,  5.8125,  5.2812,  5.2812,  5.5000,  5.7500,  5.7188,  6.0000,
         5.8750,  5.8750,  5.8125,  5.9062,  6.0312,  6.1562,  6.4062,  6.4062],
       device='cuda:0', grad_fn=<MaskedFillBackward0>)
weight: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.5938, 0.5586, 0.5273,
         0.5039, 0.4844, 0.4727, 0.0000, 0.0000, 0.0000, 0.4004, 0.3770, 0.3574,
         0.0000, 0.3184, 0.2969, 0.2812, 0.2676, 0.2559, 0.2490, 0.0000, 0.2295,
         0.2188, 0.2090, 0.2031, 0.0000, 0.1846, 0.1719, 0.1621, 0.1543, 0.1475,
         0.1426, 0.1396, 0.1377, 0.1377, 0.0000, 0.1299, 0.1226, 0.1162, 0.1113,
         0.1079, 0.1060, 0.1045, 0.1045, 0.1060, 0.1079, 0.1118, 0.1162, 0.1226,
         0.1299, 0.1387, 0.1494, 0.1611, 0.1748, 0.1904, 0.2090, 0.0000, 0.2402,
         0.2539, 0.0000, 0.2773, 0.2891, 0.0000, 0.0000, 0.3066, 0.3066, 0.3125,
         0.3203, 0.0000, 0.0000, 0.0000, 0.0000, 0.2949, 0.2773, 0.2637, 0.2520,
         0.2422, 0.2363, 0.0000, 0.0000, 0.1982, 0.1787, 0.1602, 0.1445, 0.1299,
         0.1172, 0.1055, 0.0947, 0.0854, 0.0767, 0.0693, 0.0623, 0.0559, 0.0503,
         0.0454, 0.0408]], device='cuda:0', dtype=torch.bfloat16)
DEBUG loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000, 12.6172,  8.2393,  4.0210,  6.0154,  6.3574,  9.2759,  0.0000,
         0.0000,  0.0000,  4.8297,  3.9580,  4.2220,  0.0000,  2.8254,  4.2861,
         4.6055,  3.1273,  3.5021,  3.3929,  0.0000,  3.7292,  2.8848,  4.4409,
         2.8691,  0.0000,  3.4607,  1.8906,  2.4418,  3.3560,  1.3548,  2.6733,
         2.2518,  2.6334,  1.7126,  0.0000,  2.2242,  2.6656,  1.7795,  1.3220,
         1.6726,  2.3575,  1.4760,  1.5609,  1.6423,  1.6928,  1.9149,  1.8594,
         1.6086,  2.0457,  2.6001,  2.1665,  2.6385,  3.3431,  4.3323,  3.1478,
         0.0000,  3.5134,  3.1897,  0.0000,  4.7842,  1.2195,  0.0000,  0.0000,
         1.1882,  1.5715,  1.5332,  1.6416,  0.0000,  0.0000,  0.0000,  0.0000,
         1.1981,  1.4734,  1.2689,  1.2361,  1.3093,  1.4475,  0.0000,  0.0000,
         0.8054,  1.0388,  0.8458,  0.7633,  0.7144,  0.6738,  0.6031,  0.5684,
         0.5020,  0.4504,  0.4030,  0.3677,  0.3372,  0.3096,  0.2909,  0.2612],
       device='cuda:0', grad_fn=<MulBackward0>)
DEBUG: shift logits: tensor([[-1.2266, -2.4219,  1.1328,  ...,  0.7656,  0.7656,  0.7656],
        [-1.2266, -2.4219,  1.1328,  ...,  0.7656,  0.7656,  0.7656],
        [ 1.1016, -0.3203,  2.7500,  ...,  0.8594,  0.8594,  0.8594],
        ...,
        [-0.6406, -0.4609,  2.0156,  ...,  0.6953,  0.6953,  0.6953],
        [ 2.8750,  0.6445,  1.4688,  ...,  0.1777,  0.1777,  0.1777],
        [ 2.7344,  0.0146,  0.6172,  ..., -0.3789, -0.3789, -0.3789]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<ViewBackward0>) shift_labels: tensor([151644,    872,    198,   8949,   1030,    220,     16,     15,   9666,
           315,  13779,    311,   8180,    304,   2906,    419,   2003,     13,
          1913,   6602,     11,    566,   6635,    311,   2506,    220,     17,
          9666,    315,  13779,    369,   1790,   2003,     13,   1260,   1221,
         12434,    279,   9664,    220,     18,   9666,    315,  13779,    311,
          2906,    369,    279,   1899,     13,   2585,   1657,   9666,    315,
         13779,   1521,   4389,   8180,    304,    279,   1156,   3040,   2849,
           315,    279,   2003,     30, 151645,    198, 151644,  77091,    198,
          7308,    220,     16,     15,   1365,    220,     17,    284,   1115,
            16,     15,     12,     17,     28,     23,   2452,     23,   9666,
           315,  13779,   1033,  34561,    419,   2003,    624,   3136,   2144,
           287,   6602,    748,  42302,   4933,   4389,  29812,    220,     23,
          1365,    220,     18,    284,   1115,     23,     12,     18,     28,
            20,   2452,     20,   9666,    315,  13779,    304,    279,   1156,
          3040,   2849], device='cuda:0')
DEBUG: loss: tensor([1.1375e+01, 1.4188e+01, 6.5804e-05, 6.5312e+00, 5.4626e-03, 4.2725e-04,
        1.3199e-03, 8.7261e-05, 3.0640e-02, 4.6015e-05, 8.3203e-01, 9.2163e-03,
        1.5625e+00, 5.7812e-01, 4.5508e-01, 2.6719e+00, 2.4316e-01, 2.0898e-01,
        3.1562e+00, 4.1602e-01, 6.1989e-06, 3.1433e-03, 2.5938e+00, 6.1951e-03,
        8.9453e-01, 4.9591e-04, 1.3199e-03, 4.3750e-01, 1.5259e-05, 4.0820e-01,
        6.7188e+00, 2.9062e+00, 2.0630e-02, 2.8198e-02, 4.1016e-02, 2.4688e+00,
        1.3984e+00, 4.0054e-05, 1.2188e+00, 6.4373e-06, 3.1128e-02, 3.4523e-04,
        3.2902e-05, 1.8945e-01, 1.9897e-02, 5.7812e+00, 3.8438e+00, 1.6403e-04,
        4.8438e-01, 7.7734e-01, 2.4375e+00, 4.6875e-01, 3.4637e-03, 2.2650e-05,
        1.3516e+00, 2.8320e-01, 6.2500e+00, 1.2061e-01, 1.5859e+00, 1.8387e-03,
        7.9688e-01, 6.5002e-03, 3.6328e-01, 1.5335e-03, 9.9182e-04, 1.5625e-01,
        2.0938e+00, 2.9062e+00, 4.6875e-02, 6.6250e+00, 1.3500e+01, 2.9883e-01,
        2.0125e+01, 9.8828e-01, 2.8750e+01, 1.4562e+01, 4.7119e-02, 1.4062e+01,
        1.9625e+01, 1.2562e+01, 1.8828e+00, 5.3125e+00, 2.2375e+01, 1.1375e+01,
        2.1000e+01, 1.4562e+01, 1.7875e+01, 1.4125e+01, 1.8875e+01, 1.7625e+01,
        1.2438e+01, 2.1500e+01, 1.5000e+01, 1.6000e+01, 2.8438e+00, 1.5188e+01,
        3.1836e-01, 2.2750e+01, 1.1000e+01, 1.6250e+01, 5.9375e+00, 1.9250e+01,
        1.4312e+01, 9.4375e+00, 7.8125e+00, 1.6375e+01, 1.2634e-02, 2.5500e+01,
        1.3688e+01, 6.9922e-01, 1.0125e+01, 8.1875e+00, 4.7500e+00, 2.7750e+01,
        8.5449e-02, 2.8000e+01, 1.4875e+01, 1.5812e+01, 9.1250e+00, 3.8750e+00,
        7.1875e+00, 9.6250e+00, 2.0625e+01, 1.6750e+01, 1.4250e+01, 1.5562e+01,
        1.3000e+01, 1.1375e+01], device='cuda:0', grad_fn=<NllLossBackward0>)
loss mask: tensor([False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False,  True, False,  True, False, False,  True,  True, False,
        False, False,  True,  True,  True,  True, False,  True, False,  True,
        False,  True,  True, False, False,  True, False,  True, False,  True,
        False,  True, False, False, False,  True, False,  True,  True, False,
        False, False, False,  True, False,  True,  True,  True, False, False,
        False,  True,  True,  True, False,  True,  True, False],
       device='cuda:0') loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
        20.1250,  0.0000, 28.7500,  0.0000,  0.0000, 14.0625, 19.6250,  0.0000,
         0.0000,  0.0000, 22.3750, 11.3750, 21.0000, 14.5625,  0.0000, 14.1250,
         0.0000, 17.6250,  0.0000, 21.5000, 15.0000,  0.0000,  0.0000, 15.1875,
         0.0000, 22.7500,  0.0000, 16.2500,  0.0000, 19.2500,  0.0000,  0.0000,
         0.0000, 16.3750,  0.0000, 25.5000, 13.6875,  0.0000,  0.0000,  0.0000,
         0.0000, 27.7500,  0.0000, 28.0000, 14.8750, 15.8125,  0.0000,  0.0000,
         0.0000,  9.6250, 20.6250, 16.7500,  0.0000, 15.5625, 13.0000,  0.0000],
       device='cuda:0', grad_fn=<MaskedFillBackward0>)
weight: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.7656, 0.0000, 0.7227, 0.0000, 0.0000, 0.6641, 0.6484, 0.0000, 0.0000,
         0.0000, 0.5820, 0.5664, 0.5547, 0.5508, 0.0000, 0.5469, 0.0000, 0.5430,
         0.0000, 0.5430, 0.5469, 0.0000, 0.0000, 0.5547, 0.0000, 0.5586, 0.0000,
         0.5625, 0.0000, 0.5664, 0.0000, 0.0000, 0.0000, 0.5586, 0.0000, 0.5469,
         0.5430, 0.0000, 0.0000, 0.0000, 0.0000, 0.5000, 0.0000, 0.4668, 0.4512,
         0.4395, 0.0000, 0.0000, 0.0000, 0.3750, 0.3516, 0.3340, 0.0000, 0.2949,
         0.2754, 0.0000]], device='cuda:0', dtype=torch.bfloat16)
DEBUG loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
        15.4082,  0.0000, 20.7764,  0.0000,  0.0000,  9.3384, 12.7256,  0.0000,
         0.0000,  0.0000, 13.0229,  6.4429, 11.6484,  8.0208,  0.0000,  7.7246,
         0.0000,  9.5698,  0.0000, 11.6738,  8.2031,  0.0000,  0.0000,  8.4243,
         0.0000, 12.7080,  0.0000,  9.1406,  0.0000, 10.9033,  0.0000,  0.0000,
         0.0000,  9.1470,  0.0000, 13.9453,  7.4319,  0.0000,  0.0000,  0.0000,
         0.0000, 13.8750,  0.0000, 13.0703,  6.7112,  6.9489,  0.0000,  0.0000,
         0.0000,  3.6094,  7.2510,  5.5942,  0.0000,  4.5897,  3.5801,  0.0000],
       device='cuda:0', grad_fn=<MulBackward0>)
DEBUG: shift logits: tensor([[ 1.6719, -1.4531,  2.0312,  ...,  1.9375,  1.9375,  1.9375],
        [ 1.6719, -1.4531,  2.0312,  ...,  1.9375,  1.9375,  1.9375],
        [ 1.7031, -2.0938,  0.8594,  ...,  2.1562,  2.1562,  2.1562],
        ...,
        [ 1.8672, -4.5000,  3.5000,  ...,  1.0156,  1.0156,  1.0156],
        [ 2.4375, -4.0000,  4.5312,  ...,  1.0000,  1.0000,  1.0000],
        [-0.5820, -7.6250,  1.2656,  ...,  1.4844,  1.4844,  1.4844]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<ViewBackward0>) shift_labels: tensor([151644,    872,    198,     46,   5612,  49531,    264,    220,     16,
            17,     12,   9734,  10525,    315,  10799,   1449,   6556,    389,
           279,   1616,    311,    975,     13,   1913,    279,   1616,    311,
           975,     11,    566,  20987,    825,  57314,    315,    279,  10525,
            13,   3197,    566,   5221,    311,    806,   5163,     11,    566,
         20987,   2441,   4279,    315,    279,  10525,     13,   1260,  10667,
            82,    311,   7027,    894,    803,    315,    806,  10799,   3055,
           566,   8471,   3238,     11,    323,    979,    566,  42357,    806,
         10799,     11,    566,   1172,  20987,    220,     16,  53708,    315,
           279,   9664,   3311,   1576,    432,    374,   9255,     13,   2585,
          1657,  48038,    686,    387,   2115,    304,    279,  10525,  47943,
            30, 151645,    198, 151644,  77091,    198,     46,   5612,  20987,
           220,     16,     14,     19,    353,    220,     16,     17,    284,
           220,     16,     17,     14,     19,    284,   1115,     16,     17,
            14,     19], device='cuda:0')
DEBUG: loss: tensor([1.0062e+01, 1.6750e+01, 3.2806e-03, 7.9688e+00, 4.7812e+00, 1.2188e+01,
        3.6926e-03, 6.1512e-05, 5.8889e-05, 7.7820e-04, 5.4836e-05, 2.6250e+00,
        4.2500e+00, 1.1597e-03, 9.7168e-02, 1.9766e+00, 2.1484e-01, 1.6172e+00,
        1.4648e-01, 6.3477e-02, 1.6094e+00, 2.5938e+00, 3.9258e-01, 6.5625e-01,
        2.7100e-02, 3.7109e-02, 4.3555e-01, 2.4219e+00, 2.6093e-03, 6.0120e-03,
        3.8574e-02, 1.2012e-01, 3.8750e+00, 1.4801e-03, 4.4861e-03, 7.2500e+00,
        6.3965e-02, 1.0375e+01, 3.1738e-03, 3.9531e+00, 2.5000e-01, 2.8809e-02,
        2.4219e+00, 3.8910e-03, 3.7109e-02, 8.6719e-01, 1.5625e+00, 1.4297e+00,
        1.8188e-02, 7.0801e-02, 3.3906e+00, 7.7148e-02, 6.8848e-02, 4.0625e+00,
        1.4782e-04, 4.5508e-01, 4.8750e+00, 5.5000e+00, 1.0193e-02, 4.6631e-02,
        2.4688e+00, 1.9297e+00, 2.7344e+00, 2.1606e-02, 2.2812e+00, 2.3750e+00,
        6.2891e-01, 3.6133e-01, 5.9062e+00, 5.0354e-03, 1.1328e+00, 2.1191e-01,
        2.7188e+00, 6.6797e-01, 8.7891e-02, 5.0000e+00, 8.4375e-01, 1.6968e-02,
        3.4668e-02, 1.1500e+01, 6.4697e-03, 2.0020e-02, 1.7969e-01, 9.0625e-01,
        8.2500e+00, 3.3722e-03, 1.8677e-02, 6.4453e-02, 9.3359e-01, 4.0312e+00,
        7.5312e+00, 9.7500e+00, 5.0000e+00, 1.4062e-01, 7.6875e+00, 1.0254e-01,
        7.2021e-03, 7.3750e+00, 1.0125e+01, 1.1328e+00, 2.2188e+00, 9.4604e-04,
        7.3125e+00, 1.3938e+01, 9.4604e-03, 1.8000e+01, 7.5938e+00, 6.1562e+00,
        1.3000e+01, 3.2812e+00, 1.6375e+01, 2.4625e+01, 4.6250e+00, 1.4250e+01,
        1.7000e+01, 1.0812e+01, 2.0250e+01, 2.3750e+00, 2.0000e+01, 1.9250e+01,
        1.6125e+01, 2.5000e+01, 1.8125e+01, 1.8000e+01, 2.0375e+01, 2.1625e+01,
        1.2250e+01, 2.4625e+01], device='cuda:0', grad_fn=<NllLossBackward0>)
loss mask: tensor([False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False,  True, False,
         True,  True, False,  True,  True, False,  True, False,  True,  True,
         True,  True,  True,  True,  True,  True, False,  True],
       device='cuda:0') loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000, 13.0000,  0.0000, 16.3750, 24.6250,
         0.0000, 14.2500, 17.0000,  0.0000, 20.2500,  0.0000, 20.0000, 19.2500,
        16.1250, 25.0000, 18.1250, 18.0000, 20.3750, 21.6250,  0.0000, 24.6250],
       device='cuda:0', grad_fn=<MaskedFillBackward0>)
weight: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.6445, 0.0000, 0.5703, 0.5352, 0.0000, 0.4766, 0.4492, 0.0000, 0.3984,
         0.0000, 0.3398, 0.3105, 0.2852, 0.2637, 0.2432, 0.2275, 0.2129, 0.2012,
         0.0000, 0.1729]], device='cuda:0', dtype=torch.bfloat16)
DEBUG loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  8.3789,  0.0000,  9.3389, 13.1782,
         0.0000,  6.7910,  7.6367,  0.0000,  8.0684,  0.0000,  6.7969,  5.9780,
         4.5981,  6.5918,  4.4073,  4.0957,  4.3376,  4.3503,  0.0000,  4.2565],
       device='cuda:0', grad_fn=<MulBackward0>)
DEBUG: shift logits: tensor([[ 1.4375, -4.8125, -0.3789,  ...,  0.4121,  0.4121,  0.4121],
        [ 1.4375, -4.8125, -0.3789,  ...,  0.4121,  0.4121,  0.4121],
        [ 4.0312, -2.8281, -0.0527,  ..., -0.2061, -0.2061, -0.2061],
        ...,
        [ 3.1250, -4.9375,  0.8008,  ...,  1.2422,  1.2422,  1.2422],
        [ 4.5625, -5.5938,  1.1484,  ...,  1.0781,  1.0781,  1.0781],
        [-0.0479, -7.9375, -0.5312,  ...,  0.6914,  0.6914,  0.6914]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<ViewBackward0>) shift_labels: tensor([151644,    872,    198,  36634,  27627,    311,   1787,    705,    264,
         12963,   8061,     13,    220,    576,   1429,   4185,  12733,    566,
          1558,    374,  35251,  12963,  30700,     13,    220,   1260,  10195,
           400,     17,     15,    369,    419,    323,    432,   2783,   1435,
           400,     20,    304,   5479,     13,    220,    758,    825,   2254,
         11387,   1558,    220,     18,     15,     15,    315,   1493,  30186,
            13,    220,   1260,   1083,   1558,    220,     17,    803,   6351,
         30186,    369,    400,     18,     15,     15,   1817,    323,   2783,
           400,     20,     15,    304,   5479,     13,    220,   1260,   1083,
         30778,    400,     17,     15,     15,     15,  11372,   5802,    315,
          2513,    504,    806,  10806,   8061,     13,    220,   1416,   8016,
           323,   1008,   8356,  20284,    369,    279,   8061,    374,    400,
            19,     15,     15,     15,    264,   2254,   1246,   1753,  11372,
          1521,    279,   8061,   1281,     30, 151645,    198, 151644,  77091,
           198,   3830], device='cuda:0')
DEBUG: loss: tensor([1.0188e+01, 1.8000e+01, 7.4219e-02, 1.4312e+01, 1.0688e+01, 2.6562e+00,
        4.9375e+00, 1.2734e+00, 5.0312e+00, 5.4375e+00, 7.1875e+00, 4.7607e-02,
        6.9531e-01, 5.2500e+00, 6.5625e+00, 9.3750e+00, 5.5625e+00, 3.3594e+00,
        5.5938e+00, 9.9375e+00, 1.0875e+01, 3.8281e+00, 1.7500e+01, 5.9570e-02,
        2.2461e-02, 3.3906e+00, 8.8750e+00, 4.7188e+00, 1.7734e+00, 9.5749e-04,
        5.0000e+00, 8.4375e+00, 1.7578e+00, 4.5000e+00, 1.0875e+01, 5.2812e+00,
        7.7188e+00, 3.6562e+00, 6.1562e+00, 8.9375e+00, 3.6377e-02, 3.6621e-02,
        5.8750e+00, 3.2812e+00, 1.2578e+00, 1.0312e+01, 5.6250e+00, 7.1875e-01,
        4.0625e+00, 8.6212e-04, 2.4261e-03, 3.0625e+00, 6.8750e+00, 9.5625e+00,
        4.6143e-02, 1.6861e-03, 3.6406e+00, 8.5000e+00, 7.8125e+00, 2.2070e-01,
        1.7578e-01, 4.8125e+00, 1.2375e+01, 5.0000e+00, 7.0312e+00, 6.5938e+00,
        4.8125e+00, 3.4332e-03, 5.7422e-01, 7.3125e+00, 3.0312e+00, 1.2812e+01,
        5.3438e+00, 2.6875e+00, 1.0681e-02, 3.7188e+00, 8.0000e+00, 5.1025e-02,
        2.5977e-01, 4.0312e+00, 7.9062e+00, 1.3812e+01, 3.1250e+00, 4.5117e-01,
        3.4714e-04, 1.1169e-02, 2.1240e-02, 1.3688e+01, 8.9375e+00, 4.2500e+00,
        5.2812e+00, 6.0625e+00, 4.4688e+00, 1.6375e+01, 6.1562e+00, 1.1426e-01,
        1.3867e-01, 5.9375e+00, 1.3125e+01, 1.1169e-02, 7.1250e+00, 1.4125e+01,
        8.1875e+00, 5.6250e+00, 4.5938e+00, 5.9375e+00, 1.0812e+01, 6.4688e+00,
        2.8750e+00, 1.1253e-04, 7.4768e-04, 8.4473e-02, 1.0688e+01, 9.5825e-03,
        7.5000e+00, 6.5000e+00, 3.5781e+00, 2.6719e+00, 1.4531e+00, 5.6250e+00,
        8.9375e+00, 1.1172e+00, 5.6250e+00, 2.8610e-04, 7.2188e+00, 1.5312e+01,
        1.2131e-03, 1.2625e+01], device='cuda:0', grad_fn=<NllLossBackward0>)
loss mask: tensor([False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False,  True],
       device='cuda:0') loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000, 12.6250],
       device='cuda:0', grad_fn=<MaskedFillBackward0>)
weight: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.5000]], device='cuda:0', dtype=torch.bfloat16)
DEBUG loss: tensor([0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 6.3125], device='cuda:0', grad_fn=<MulBackward0>)
DEBUG: shift logits: tensor([[ 0.1523,  0.3027, -0.6992,  ...,  1.0469,  1.0469,  1.0469],
        [ 0.1523,  0.3027, -0.6992,  ...,  1.0469,  1.0469,  1.0469],
        [ 1.5547,  1.4219, -0.7461,  ...,  0.9062,  0.9062,  0.9062],
        ...,
        [ 3.1250, -0.6914,  3.8281,  ...,  1.6641,  1.6641,  1.6641],
        [ 1.0859, -3.7656, -0.5820,  ...,  1.0234,  1.0234,  1.0234],
        [ 3.3750, -2.7188, -0.3359,  ...,  0.5547,  0.5547,  0.5547]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<ViewBackward0>) shift_labels: tensor([151644,    872,    198,     51,   8073,    374,  18545,   3220,    369,
           264,    501,  12963,    429,   7049,    400,     16,     16,     17,
            13,   1260,   6649,    311,   8329,    279,   1790,   1378,   5555,
         11236,  88865,    369,    400,     16,   1817,     13,   1913,   5461,
            11,   1246,   1657,  88865,   1558,    566,   1184,    311,   4559,
          1817,   1899,     30, 151645,    198, 151644,  77091,    198,   1519,
          3880,    311,   4559,    220,     16,     16,     17,  88865,   1576,
           220,     16,     16,     17,  17779,    553,    220,     16,  16819,
          1115,     16,     16,     17,     14,     16,     28,     16,     16,
            17,   2452,     16,     16,     17,    624,   1519,    702,    220,
            16,     19,   2849,    311,   4559,  88865,   1576,   1052,    525,
          8094,   2849,    304,    264,   2003,    323,    566,    702,   1378,
          5555,   8094,   3039,    220,     17,  16819,   1115,     22,      9,
            17,     28,     16,     19,   2452,     16,     19,    624,   1519,
           702,    311], device='cuda:0')
DEBUG: loss: tensor([1.1875e+01, 1.5188e+01, 2.1719e+00, 5.4375e+00, 2.4062e+00, 6.0625e+00,
        4.2812e+00, 1.5332e-01, 2.6250e+00, 2.1719e+00, 5.7500e+00, 5.5938e+00,
        8.5625e+00, 9.6250e+00, 1.3062e-02, 3.6955e-06, 1.0010e-01, 6.7578e-01,
        1.9989e-03, 1.8750e+00, 8.6250e+00, 1.3086e-01, 3.6250e+00, 1.1572e-01,
        6.8438e+00, 2.7656e+00, 3.5156e+00, 9.9375e+00, 6.1875e+00, 1.6953e+00,
        2.9449e-03, 2.1935e-05, 1.0312e+00, 3.8906e+00, 6.6875e+00, 2.4375e+00,
        1.1921e-07, 3.6094e+00, 5.6250e-01, 2.0938e+00, 2.0938e+00, 2.1387e-01,
        6.7812e+00, 1.6022e-03, 1.0438e+01, 1.6875e+00, 3.0469e+00, 1.8359e+00,
        2.2344e+00, 2.2949e-02, 7.0312e+00, 1.2625e+01, 7.1484e-01, 1.1500e+01,
        1.4438e+01, 1.8047e+00, 2.1500e+01, 1.0688e+01, 1.3438e+01, 1.6750e+01,
        1.4438e+01, 1.7375e+01, 2.0500e+01, 8.1250e+00, 1.8000e+01, 1.2312e+01,
        1.2625e+01, 1.7125e+01, 7.5000e+00, 7.3730e-02, 1.8625e+01, 1.0375e+01,
        1.6750e+01, 1.5312e+01, 1.5438e+01, 1.3812e+01, 3.4062e+00, 2.1125e+01,
        7.7500e+00, 1.2500e+00, 5.4375e+00, 1.3438e+00, 3.8906e+00, 2.1500e+01,
        1.4188e+01, 1.2000e+01, 3.0156e+00, 1.1328e+00, 9.8750e+00, 1.2875e+01,
        8.1250e+00, 4.1562e+00, 7.0625e+00, 1.5125e+01, 2.6125e+01, 1.4688e+01,
        2.1375e+01, 1.3000e+01, 2.2000e+01, 1.3375e+01, 6.2188e+00, 7.7500e+00,
        3.7969e+00, 1.9000e+01, 9.1250e+00, 1.5320e-02, 9.0000e+00, 1.5062e+01,
        1.6250e+01, 1.0812e+01, 1.8250e+01, 9.9375e+00, 1.8875e+01, 1.6500e+01,
        1.3625e+01, 2.2375e+01, 1.4625e+01, 1.2000e+01, 1.4688e+01, 1.4250e+01,
        6.0000e+00, 1.4188e+01, 1.0375e+01, 3.8594e+00, 1.2250e+01, 1.5625e+01,
        2.2500e+01, 1.0438e+01], device='cuda:0', grad_fn=<NllLossBackward0>)
loss mask: tensor([False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False,  True,  True, False,  True,
         True, False,  True, False,  True,  True, False, False, False, False,
         True, False,  True,  True,  True, False, False,  True, False, False,
        False, False, False,  True,  True, False, False, False, False,  True,
        False, False, False,  True,  True, False,  True,  True,  True, False,
        False, False, False,  True, False, False,  True,  True, False, False,
         True, False,  True,  True, False,  True,  True, False,  True, False,
        False,  True, False, False,  True, False,  True, False],
       device='cuda:0') loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
        21.5000, 10.6875,  0.0000, 16.7500, 14.4375,  0.0000, 20.5000,  0.0000,
        18.0000, 12.3125,  0.0000,  0.0000,  0.0000,  0.0000, 18.6250,  0.0000,
        16.7500, 15.3125, 15.4375,  0.0000,  0.0000, 21.1250,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000, 21.5000, 14.1875,  0.0000,  0.0000,  0.0000,
         0.0000, 12.8750,  0.0000,  0.0000,  0.0000, 15.1250, 26.1250,  0.0000,
        21.3750, 13.0000, 22.0000,  0.0000,  0.0000,  0.0000,  0.0000, 19.0000,
         0.0000,  0.0000,  9.0000, 15.0625,  0.0000,  0.0000, 18.2500,  0.0000,
        18.8750, 16.5000,  0.0000, 22.3750, 14.6250,  0.0000, 14.6875,  0.0000,
         0.0000, 14.1875,  0.0000,  0.0000, 12.2500,  0.0000, 22.5000,  0.0000],
       device='cuda:0', grad_fn=<MaskedFillBackward0>)
weight: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.7344, 0.7109, 0.0000, 0.6758, 0.6641, 0.0000, 0.6523,
         0.0000, 0.6445, 0.6445, 0.0000, 0.0000, 0.0000, 0.0000, 0.6367, 0.0000,
         0.6289, 0.6289, 0.6328, 0.0000, 0.0000, 0.6602, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.6680, 0.6680, 0.0000, 0.0000, 0.0000, 0.0000, 0.6523,
         0.0000, 0.0000, 0.0000, 0.6094, 0.5977, 0.0000, 0.5820, 0.5820, 0.5859,
         0.0000, 0.0000, 0.0000, 0.0000, 0.5820, 0.0000, 0.0000, 0.5508, 0.5430,
         0.0000, 0.0000, 0.5195, 0.0000, 0.4941, 0.4844, 0.0000, 0.4707, 0.4668,
         0.0000, 0.4609, 0.0000, 0.0000, 0.4375, 0.0000, 0.0000, 0.3867, 0.0000,
         0.3398, 0.0000]], device='cuda:0', dtype=torch.bfloat16)
DEBUG loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
        15.7891,  7.5981,  0.0000, 11.3193,  9.5874,  0.0000, 13.3730,  0.0000,
        11.6016,  7.9358,  0.0000,  0.0000,  0.0000,  0.0000, 11.8589,  0.0000,
        10.5342,  9.6301,  9.7690,  0.0000,  0.0000, 13.9458,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000, 14.3613,  9.4768,  0.0000,  0.0000,  0.0000,
         0.0000,  8.3989,  0.0000,  0.0000,  0.0000,  9.2168, 15.6138,  0.0000,
        12.4409,  7.5664, 12.8906,  0.0000,  0.0000,  0.0000,  0.0000, 11.0586,
         0.0000,  0.0000,  4.9570,  8.1785,  0.0000,  0.0000,  9.4814,  0.0000,
         9.3269,  7.9922,  0.0000, 10.5320,  6.8269,  0.0000,  6.7700,  0.0000,
         0.0000,  6.2070,  0.0000,  0.0000,  4.7373,  0.0000,  7.6465,  0.0000],
       device='cuda:0', grad_fn=<MulBackward0>)
DEBUG: shift logits: tensor([[ 3.2344, -0.5156, -0.0052,  ...,  0.1484,  0.1494,  0.1494],
        [ 3.2344, -0.5156, -0.0052,  ...,  0.1484,  0.1494,  0.1494],
        [ 3.3750, -0.7109, -0.7148,  ..., -0.2637, -0.2637, -0.2637],
        ...,
        [ 1.6484, -1.8750, -0.8516,  ...,  0.4180,  0.4180,  0.4180],
        [ 1.6250, -1.9375, -0.8477,  ...,  0.4043,  0.4043,  0.4043],
        [ 1.6250, -1.9844, -0.8750,  ...,  0.3574,  0.3574,  0.3574]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<ViewBackward0>) shift_labels: tensor([151644,    872,    198,   2304,    333,    748,  23268,   4916,    702,
           220,     16,     19,  40676,    323,    806,  18575,   4916,    702,
           220,     17,  20403,  84038,     13,    220,   2585,   1657,    803,
         84038,   1558,    566,    614,   1091,  40676,     30, 151645,    198,
        151644,  77091,    198,   1519,    702,    220,     17,    856,    220,
            16,     17,    284,   1115,     17,      9,     16,     17,     28,
            17,     19,   2452,     17,     19,  84038,    624,   1519,    702,
           220,     17,     19,    481,    220,     16,     19,    284,   1115,
            17,     19,     12,     16,     19,     28,     16,     15,   2452,
            16,     15,    803,  84038,   1091,  40676,    624,    820,    220,
            16,     15, 151645, 151643, 151643, 151643, 151643, 151643, 151643,
        151643, 151643, 151643, 151643, 151643, 151643, 151643, 151643, 151643,
        151643, 151643, 151643, 151643, 151643, 151643, 151643, 151643, 151643,
        151643, 151643, 151643, 151643, 151643, 151643, 151643, 151643, 151643,
        151643, 151643], device='cuda:0')
DEBUG: loss: tensor([1.0812e+01, 1.6125e+01, 5.8750e+00, 1.1750e+01, 6.3125e+00, 6.0625e+00,
        1.0688e+01, 5.1250e+00, 5.3438e+00, 4.3213e-02, 3.2969e+00, 5.5078e-01,
        1.3000e+01, 1.6724e-02, 1.4219e+00, 1.1500e+01, 4.7188e+00, 4.5000e+00,
        5.1270e-03, 5.0000e+00, 8.1250e+00, 1.2250e+01, 1.1182e-01, 3.2227e-02,
        1.0875e+01, 9.3125e+00, 4.6250e+00, 9.5625e+00, 5.0625e+00, 1.5000e+00,
        6.1250e+00, 1.0875e+01, 1.5062e+01, 4.1250e+00, 2.9688e+00, 2.5156e+00,
        7.4688e+00, 1.8375e+01, 4.4688e+00, 1.6875e+01, 1.5625e+01, 1.4312e+01,
        1.5875e+01, 2.3625e+01, 1.4875e+01, 1.8500e+01, 1.7500e+01, 1.8375e+01,
        1.8250e+01, 1.8250e+01, 1.6250e+01, 2.0250e+01, 1.8875e+01, 1.7875e+01,
        1.8875e+01, 2.2125e+01, 1.5875e+01, 1.8875e+01, 2.2125e+01, 2.2375e+01,
        1.3500e+01, 1.8750e+01, 1.6875e+01, 1.7750e+01, 1.9125e+01, 2.2250e+01,
        1.9250e+01, 1.8000e+01, 2.0250e+01, 2.2375e+01, 2.0000e+01, 1.9625e+01,
        1.8875e+01, 2.2125e+01, 1.5562e+01, 1.9875e+01, 2.1875e+01, 1.7625e+01,
        1.9875e+01, 2.1375e+01, 1.6000e+01, 1.9625e+01, 2.1250e+01, 1.6625e+01,
        2.3250e+01, 1.8625e+01, 2.3500e+01, 9.3750e+00, 1.8875e+01, 1.4875e+01,
        1.8125e+01, 2.0500e+01, 5.9688e+00, 4.0938e+00, 4.1562e+00, 4.2188e+00,
        4.3438e+00, 4.3438e+00, 4.2812e+00, 4.8750e+00, 4.3750e+00, 4.3438e+00,
        3.8281e+00, 4.0625e+00, 4.6562e+00, 5.0938e+00, 5.3438e+00, 5.3750e+00,
        5.4688e+00, 5.4688e+00, 5.5312e+00, 5.5938e+00, 5.6562e+00, 5.6875e+00,
        5.6250e+00, 5.5938e+00, 5.5312e+00, 5.6250e+00, 5.5312e+00, 5.5312e+00,
        5.6875e+00, 5.5938e+00, 5.6562e+00, 5.5625e+00, 5.5000e+00, 5.5000e+00,
        5.5000e+00, 5.5000e+00], device='cuda:0', grad_fn=<NllLossBackward0>)
loss mask: tensor([False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True, False,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True, False,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True],
       device='cuda:0') loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000, 16.8750,
        15.6250, 14.3125, 15.8750, 23.6250, 14.8750, 18.5000, 17.5000, 18.3750,
        18.2500, 18.2500, 16.2500, 20.2500, 18.8750, 17.8750, 18.8750, 22.1250,
        15.8750, 18.8750, 22.1250, 22.3750, 13.5000, 18.7500, 16.8750, 17.7500,
        19.1250, 22.2500, 19.2500, 18.0000, 20.2500, 22.3750, 20.0000, 19.6250,
        18.8750, 22.1250, 15.5625, 19.8750, 21.8750, 17.6250, 19.8750, 21.3750,
        16.0000, 19.6250, 21.2500, 16.6250, 23.2500, 18.6250,  0.0000,  9.3750,
        18.8750, 14.8750, 18.1250, 20.5000,  5.9688,  4.0938,  4.1562,  4.2188,
         4.3438,  4.3438,  0.0000,  4.8750,  4.3750,  4.3438,  3.8281,  4.0625,
         4.6562,  5.0938,  5.3438,  5.3750,  5.4688,  5.4688,  5.5312,  5.5938,
         5.6562,  5.6875,  5.6250,  5.5938,  5.5312,  5.6250,  5.5312,  5.5312,
         5.6875,  5.5938,  5.6562,  5.5625,  5.5000,  5.5000,  5.5000,  5.5000],
       device='cuda:0', grad_fn=<MaskedFillBackward0>)
weight: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.4922, 0.4434, 0.3984, 0.3594, 0.3242, 0.2910,
         0.2617, 0.2363, 0.2129, 0.1924, 0.1729, 0.1562, 0.1406, 0.1270, 0.1147,
         0.1035, 0.0938, 0.0850, 0.0771, 0.0703, 0.0640, 0.0583, 0.0535, 0.0493,
         0.0457, 0.0422, 0.0396, 0.0374, 0.0354, 0.0339, 0.0327, 0.0320, 0.0315,
         0.0315, 0.0317, 0.0325, 0.0334, 0.0349, 0.0366, 0.0388, 0.0415, 0.0444,
         0.0479, 0.0520, 0.0566, 0.0620, 0.0679, 0.0000, 0.0708, 0.0674, 0.0645,
         0.0625, 0.0613, 0.0610, 0.0610, 0.0618, 0.0635, 0.0654, 0.0684, 0.0000,
         0.0649, 0.0583, 0.0527, 0.0474, 0.0425, 0.0383, 0.0347, 0.0311, 0.0280,
         0.0253, 0.0227, 0.0205, 0.0183, 0.0165, 0.0148, 0.0134, 0.0120, 0.0109,
         0.0098, 0.0088, 0.0079, 0.0071, 0.0064, 0.0058, 0.0052, 0.0047, 0.0042,
         0.0038, 0.0034]], device='cuda:0', dtype=torch.bfloat16)
DEBUG loss: tensor([0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 8.3057, 6.9275, 5.7026, 5.7051, 7.6597, 4.3289,
        4.8418, 4.1357, 3.9119, 3.5110, 3.1545, 2.5391, 2.8477, 2.3962, 2.0511,
        1.9539, 2.0742, 1.3488, 1.4562, 1.5557, 1.4312, 0.7877, 1.0025, 0.8322,
        0.8104, 0.8078, 0.8800, 0.7191, 0.6372, 0.6872, 0.7320, 0.6396, 0.6181,
        0.5945, 0.7022, 0.5053, 0.6648, 0.7637, 0.6454, 0.7715, 0.8871, 0.7109,
        0.9391, 1.1050, 0.9417, 1.4418, 1.2641, 0.0000, 0.6638, 1.2719, 0.9587,
        1.1328, 1.2562, 0.3643, 0.2499, 0.2567, 0.2678, 0.2842, 0.2969, 0.0000,
        0.3166, 0.2553, 0.2291, 0.1813, 0.1726, 0.1785, 0.1766, 0.1663, 0.1503,
        0.1382, 0.1242, 0.1134, 0.1024, 0.0932, 0.0844, 0.0755, 0.0673, 0.0601,
        0.0549, 0.0486, 0.0436, 0.0404, 0.0357, 0.0326, 0.0289, 0.0257, 0.0232,
        0.0208, 0.0187], device='cuda:0', grad_fn=<MulBackward0>)
DEBUG: shift logits: tensor([[ 2.6094, -4.5312,  0.4883,  ...,  1.9062,  1.9062,  1.9062],
        [ 2.6094, -4.5312,  0.4883,  ...,  1.9062,  1.9062,  1.9062],
        [ 2.6250, -3.0625,  0.1357,  ...,  1.5781,  1.5781,  1.5781],
        ...,
        [-1.1016, -5.0312, -0.5156,  ...,  1.3047,  1.3047,  1.3047],
        [-1.0781, -4.9375, -0.4492,  ...,  1.2812,  1.2812,  1.2812],
        [-0.9609, -4.8438, -0.3164,  ...,  1.2344,  1.2344,  1.2344]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<ViewBackward0>) shift_labels: tensor([151644,    872,    198,  53467,    374,  20293,   1246,   1753,  17931,
         14074,    566,    646,   1281,    448,    678,    279,  16720,    566,
         13719,    304,    279,  37581,     13,   1260,    374,   2087,    311,
          2506,  16163,    220,     23,     12,   9734,  28147,   3080,    566,
          5711,    705,    678,    279,  13966,     13,   8886,   8991,   1969,
          6644,    220,     21,     13,     20,  48038,    315,  14074,    323,
           220,     16,     13,     20,  48038,    315,  17931,  44222,     13,
          1416,    566,    702,    220,     16,     18,     15,  48038,    315,
         14074,    323,    220,     21,     15,  48038,    315,  17931,  44222,
            11,   1246,   1657,   2790,  48038,  53708,    315,  17931,  14074,
           686,    566,   7027,     30, 151645,    198, 151644,  77091,    198,
          1519,    702,   3322,  14074,    369,    220,     17,     15,  28147,
           315,  17931,  14074,   1576,    220,     16,     18,     15,    608,
           220,     21,     13,     20,    284,   1115,     16,     18,     15,
            14,     21], device='cuda:0')
DEBUG: loss: tensor([1.0312e+01, 1.3875e+01, 1.6328e+00, 6.1250e+00, 3.5938e-01, 3.3594e+00,
        3.5889e-02, 2.0625e+00, 2.3926e-01, 5.7031e-01, 1.1963e-01, 7.6875e+00,
        8.0469e-01, 9.4141e-01, 2.6562e+00, 1.9409e-02, 1.0062e+01, 8.4839e-03,
        6.3125e+00, 1.4832e-02, 4.9133e-03, 2.0000e+00, 2.8198e-02, 5.3955e-02,
        3.6774e-03, 5.7031e-01, 1.6846e-02, 5.7812e-01, 4.3438e+00, 1.1749e-03,
        1.5625e+00, 4.5471e-03, 1.5859e+00, 1.7422e+00, 1.3359e+00, 1.6708e-03,
        4.3438e+00, 4.2578e-01, 1.9688e+00, 1.6479e-02, 2.7969e+00, 1.2451e-02,
        6.3750e+00, 7.7812e+00, 1.0703e+00, 3.0469e+00, 1.4877e-04, 4.5898e-02,
        5.1260e-06, 2.8610e-04, 4.5938e+00, 5.8365e-04, 2.0000e+00, 1.0742e-02,
        3.0398e-05, 3.7500e-01, 7.6294e-06, 4.3335e-03, 5.0312e+00, 1.8978e-04,
        2.8594e+00, 9.0000e+00, 5.6250e-01, 1.0438e+01, 4.1580e-04, 2.8594e+00,
        2.5787e-03, 1.9836e-03, 9.1875e+00, 1.0559e-02, 3.3125e+00, 4.3297e-04,
        3.9844e+00, 3.4668e-02, 2.0027e-05, 1.1500e+01, 1.0156e+00, 3.2656e+00,
        6.2943e-04, 5.6875e+00, 3.0156e+00, 4.6387e-02, 8.2500e+00, 5.1250e+00,
        4.9688e+00, 7.5312e+00, 8.7500e+00, 6.5308e-03, 2.3750e+00, 6.3750e+00,
        9.7500e+00, 2.7148e-01, 8.3750e+00, 1.3359e+00, 1.0938e+00, 1.4343e-03,
        7.2500e+00, 1.2250e+01, 2.6367e-01, 2.0875e+01, 2.0875e+01, 1.5125e+01,
        1.7625e+01, 1.2562e+01, 2.0000e+01, 1.6875e+01, 1.0375e+01, 2.5750e+01,
        1.5688e+01, 1.0688e+01, 6.5000e+00, 2.1375e+01, 1.6875e+01, 1.6750e+01,
        2.2000e+01, 2.0375e+01, 2.1625e+01, 1.8000e+01, 2.0375e+01, 1.7625e+01,
        2.1750e+01, 2.6250e+01, 2.3625e+01, 2.1500e+01, 2.5750e+01, 2.4000e+01,
        2.1750e+01, 2.3625e+01], device='cuda:0', grad_fn=<NllLossBackward0>)
loss mask: tensor([False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,  True,
         True, False,  True, False,  True,  True, False,  True,  True, False,
        False,  True,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True],
       device='cuda:0') loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000, 20.8750, 20.8750,  0.0000, 17.6250,  0.0000,
        20.0000, 16.8750,  0.0000, 25.7500, 15.6875,  0.0000,  0.0000, 21.3750,
        16.8750, 16.7500, 22.0000, 20.3750, 21.6250, 18.0000, 20.3750, 17.6250,
        21.7500, 26.2500, 23.6250, 21.5000, 25.7500, 24.0000, 21.7500, 23.6250],
       device='cuda:0', grad_fn=<MaskedFillBackward0>)
weight: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.6445, 0.6094, 0.0000, 0.5508, 0.0000, 0.4922, 0.4668, 0.0000, 0.4160,
         0.3926, 0.0000, 0.0000, 0.3125, 0.2812, 0.2539, 0.2275, 0.2051, 0.1846,
         0.1660, 0.1494, 0.1348, 0.1211, 0.1089, 0.0981, 0.0884, 0.0796, 0.0713,
         0.0645, 0.0579]], device='cuda:0', dtype=torch.bfloat16)
DEBUG loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000, 13.4546, 12.7207,  0.0000,  9.7075,  0.0000,
         9.8438,  7.8772,  0.0000, 10.7124,  6.1586,  0.0000,  0.0000,  6.6797,
         4.7461,  4.2529,  5.0059,  4.1785,  3.9913,  2.9883,  3.0443,  2.3752,
         2.6338,  2.8583,  2.3187,  1.9001,  2.0494,  1.7109,  1.4019,  1.3670],
       device='cuda:0', grad_fn=<MulBackward0>)
DEBUG: shift logits: tensor([[ 2.8125e+00, -2.1094e+00,  3.0078e-01,  ...,  2.2188e+00,
          2.2188e+00,  2.2188e+00],
        [ 2.8125e+00, -2.1094e+00,  3.0078e-01,  ...,  2.2188e+00,
          2.2188e+00,  2.2188e+00],
        [ 1.9688e+00, -1.9922e+00, -4.7266e-01,  ...,  1.8828e+00,
          1.8828e+00,  1.8828e+00],
        ...,
        [ 2.4567e-03, -3.2188e+00,  9.8438e-01,  ...,  2.8320e-01,
          2.8516e-01,  2.8516e-01],
        [-5.8203e-01, -3.5938e+00,  1.1641e+00,  ...,  6.8750e-01,
          6.8750e-01,  6.8750e-01],
        [ 8.2422e-01, -3.3906e+00,  1.5469e+00,  ...,  3.1055e-01,
          3.1055e-01,  3.1055e-01]], device='cuda:0', dtype=torch.bfloat16,
       grad_fn=<ViewBackward0>) shift_labels: tensor([151644,    872,    198,  13079,  49531,  13856,  24477,    323,  14961,
          1664,     13,    220,    576,  14961,   1664,   2783,    400,     17,
            15,     13,    220,    576,  13856,  24477,   2783,    220,     20,
            15,      4,    438,   1753,    438,    279,  14961,   1664,     13,
           220,   2585,   1753,   1521,    566,   2291,    369,   4297,     30,
        151645,    198, 151644,  77091,    198,    785,  13856,  24477,   2783,
           220,     17,     15,  19922,     20,   3186,   2442,     17,     15,
         19922,     20,     28,     16,     15,   2452,     16,     15,    198,
          4416,    566,   7171,    220,     16,     15,     10,     17,     15,
          3186,   2442,     16,     15,     10,     17,     15,     28,     18,
            15,   2452,     18,     15,    198,    820,    220,     18,     15,
        151645, 151643, 151643, 151643, 151643, 151643, 151643, 151643, 151643,
        151643, 151643, 151643, 151643, 151643, 151643, 151643, 151643, 151643,
        151643, 151643, 151643, 151643, 151643, 151643, 151643, 151643, 151643,
        151643, 151643], device='cuda:0')
DEBUG: loss: tensor([1.1750e+01, 1.5500e+01, 4.9375e+00, 9.6875e+00, 1.0938e+01, 3.3125e+00,
        8.8750e+00, 2.1515e-03, 2.6406e+00, 6.8125e+00, 1.0803e-02, 2.0605e-01,
        1.5312e+00, 4.4688e+00, 8.0625e+00, 1.0500e+01, 1.5156e+00, 2.0027e-04,
        4.0245e-04, 5.5542e-03, 2.7539e-01, 1.0059e-01, 6.7500e+00, 7.5625e+00,
        1.0062e+01, 9.1797e-02, 7.2266e-02, 5.8365e-04, 1.1312e+01, 5.7500e+00,
        8.5625e+00, 4.9062e+00, 4.5654e-02, 4.2188e+00, 5.4375e+00, 4.5898e-02,
        2.9492e-01, 6.9375e+00, 3.0781e+00, 2.8125e+00, 1.2061e-01, 5.7188e+00,
        5.5938e+00, 1.2891e-01, 6.8750e-01, 3.3281e+00, 5.6396e-02, 7.2188e+00,
        1.5062e+01, 6.1719e-01, 1.6250e+01, 1.9875e+01, 1.7875e+01, 1.9625e+01,
        1.8125e+01, 1.6375e+01, 1.9875e+01, 1.7000e+01, 1.6000e+01, 1.7500e+01,
        1.9125e+01, 1.8500e+01, 2.1375e+01, 1.7500e+01, 1.6875e+01, 1.9000e+01,
        2.0375e+01, 2.1625e+01, 1.7625e+01, 2.0250e+01, 2.1500e+01, 1.3438e+01,
        2.0625e+01, 2.0000e+01, 2.1250e+01, 2.0000e+01, 2.0500e+01, 2.1625e+01,
        2.2500e+01, 1.8875e+01, 2.1750e+01, 1.6750e+01, 1.9875e+01, 2.0250e+01,
        2.1625e+01, 2.2500e+01, 1.8875e+01, 2.1625e+01, 1.9000e+01, 2.3125e+01,
        2.1500e+01, 1.8250e+01, 2.3375e+01, 2.1750e+01, 1.2812e+01, 2.1000e+01,
        2.0500e+01, 2.3125e+01, 2.1625e+01, 7.0938e+00, 6.3438e+00, 6.3438e+00,
        6.4688e+00, 6.4375e+00, 6.4688e+00, 6.4688e+00, 6.5312e+00, 6.4375e+00,
        6.5938e+00, 6.5000e+00, 6.5625e+00, 6.4375e+00, 6.2500e+00, 6.1250e+00,
        6.1875e+00, 6.1562e+00, 6.2188e+00, 6.2812e+00, 6.1250e+00, 5.9375e+00,
        5.8438e+00, 5.9688e+00, 6.0938e+00, 6.2188e+00, 6.0000e+00, 5.3750e+00,
        5.6875e+00, 6.3125e+00], device='cuda:0', grad_fn=<NllLossBackward0>)
loss mask: tensor([False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
         True,  True,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True, False,  True,  True],
       device='cuda:0') loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000, 16.2500, 19.8750, 17.8750, 19.6250, 18.1250, 16.3750,
        19.8750, 17.0000, 16.0000, 17.5000, 19.1250, 18.5000, 21.3750, 17.5000,
        16.8750, 19.0000, 20.3750, 21.6250, 17.6250, 20.2500, 21.5000, 13.4375,
        20.6250, 20.0000, 21.2500, 20.0000, 20.5000, 21.6250, 22.5000, 18.8750,
        21.7500, 16.7500, 19.8750, 20.2500, 21.6250, 22.5000, 18.8750, 21.6250,
        19.0000, 23.1250, 21.5000, 18.2500, 23.3750, 21.7500, 12.8125, 21.0000,
        20.5000, 23.1250, 21.6250,  7.0938,  6.3438,  6.3438,  6.4688,  6.4375,
         6.4688,  6.4688,  6.5312,  6.4375,  6.5938,  6.5000,  6.5625,  6.4375,
         6.2500,  6.1250,  6.1875,  6.1562,  6.2188,  6.2812,  6.1250,  5.9375,
         5.8438,  5.9688,  6.0938,  6.2188,  6.0000,  0.0000,  5.6875,  6.3125],
       device='cuda:0', grad_fn=<MaskedFillBackward0>)
weight: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.4980, 0.4473, 0.4023, 0.3633,
         0.3262, 0.2930, 0.2637, 0.2383, 0.2139, 0.1924, 0.1738, 0.1562, 0.1406,
         0.1270, 0.1138, 0.1025, 0.0923, 0.0830, 0.0747, 0.0674, 0.0605, 0.0547,
         0.0491, 0.0444, 0.0400, 0.0359, 0.0325, 0.0293, 0.0264, 0.0238, 0.0216,
         0.0195, 0.0177, 0.0160, 0.0146, 0.0132, 0.0121, 0.0111, 0.0102, 0.0094,
         0.0087, 0.0082, 0.0077, 0.0073, 0.0070, 0.0067, 0.0065, 0.0064, 0.0064,
         0.0064, 0.0066, 0.0067, 0.0070, 0.0073, 0.0078, 0.0082, 0.0089, 0.0096,
         0.0104, 0.0113, 0.0123, 0.0135, 0.0148, 0.0164, 0.0181, 0.0199, 0.0220,
         0.0244, 0.0270, 0.0299, 0.0330, 0.0366, 0.0408, 0.0452, 0.0503, 0.0000,
         0.0503, 0.0452]], device='cuda:0', dtype=torch.bfloat16)
DEBUG loss: tensor([0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 8.0933, 8.8894, 7.1919, 7.1294,
        5.9119, 4.7974, 5.2405, 4.0508, 3.4219, 3.3667, 3.3245, 2.8906, 3.0059,
        2.2217, 1.9199, 1.9482, 1.8803, 1.7950, 1.3167, 1.3645, 1.3018, 0.7349,
        1.0121, 0.8887, 0.8508, 0.7178, 0.6656, 0.6335, 0.5933, 0.4493, 0.4699,
        0.3271, 0.3518, 0.3238, 0.3155, 0.2980, 0.2293, 0.2402, 0.1937, 0.2174,
        0.1877, 0.1493, 0.1791, 0.1580, 0.0891, 0.1404, 0.1339, 0.1489, 0.1386,
        0.0457, 0.0416, 0.0428, 0.0452, 0.0471, 0.0501, 0.0533, 0.0578, 0.0617,
        0.0684, 0.0734, 0.0809, 0.0868, 0.0927, 0.1002, 0.1118, 0.1225, 0.1366,
        0.1534, 0.1652, 0.1776, 0.1926, 0.2186, 0.2485, 0.2809, 0.3018, 0.0000,
        0.2860, 0.2851], device='cuda:0', grad_fn=<MulBackward0>)
DEBUG: shift logits: tensor([[ 5.0625,  0.6641,  2.1406,  ...,  1.4453,  1.4453,  1.4453],
        [ 5.0625,  0.6641,  2.1406,  ...,  1.4453,  1.4453,  1.4453],
        [ 5.7812,  1.4297,  3.3906,  ...,  1.8750,  1.8750,  1.8750],
        ...,
        [ 2.1406, -1.2188,  2.3125,  ...,  1.1953,  1.1953,  1.1953],
        [ 0.7227, -4.1875,  0.6484,  ...,  1.7188,  1.7188,  1.7188],
        [ 2.7344, -0.7461,  2.4375,  ...,  1.3672,  1.3672,  1.3672]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<ViewBackward0>) shift_labels: tensor([151644,    872,    198,  28084,  37102,    220,     16,     15,   4420,
         32477,    264,   1809,     11,   4279,    438,   1293,  26632,    432,
            11,    323,  23725,    429,  10856,   3311,    315,    882,   2087,
          1526,    279,  21514,     13,   2585,   1293,   1558,    432,   1896,
          1573,    566,    646,   1486,    279,   1887,   1809,     30, 151645,
           198, 151644,  77091,    198,   5338,  21749,    279,   4139,    882,
           304,   4279,    311,   1477,    279,   4582,    882,     25,    220,
            16,     15,   4420,    608,    220,     17,    284,   1115,     16,
            15,     14,     17,     28,     20,   2452,     20,   4420,    198,
         12209,    912,    429,   3311,    315,    882,    311,    279,   4139,
           882,     25,    220,     20,   4420,    488,    220,     16,     15,
          4420,    284,   1115,     20,     10,     16,     15,     28,     16,
            20,   2452,     16,     20,   4420,    198,  12209,  23725,    429,
          3311,    315,    882,    311,   1477,    279,  21514,    882,     25,
           220,     16], device='cuda:0')
DEBUG: loss: tensor([1.1062e+01, 1.7250e+01, 2.4805e-01, 1.1438e+01, 3.9531e+00, 5.8746e-04,
        1.5378e-05, 2.3041e-03, 2.2969e+00, 5.4375e+00, 3.4142e-04, 9.5825e-03,
        1.6212e-05, 3.4531e+00, 1.9062e+00, 3.4844e+00, 5.6875e+00, 3.9648e-01,
        1.8239e-05, 3.1281e-04, 5.8438e+00, 2.7812e+00, 7.7812e+00, 1.7031e+00,
        2.0752e-03, 1.7334e-02, 1.3750e+00, 5.0625e+00, 4.1199e-04, 9.7266e-01,
        4.9072e-02, 2.2500e+00, 6.3281e-01, 2.2031e+00, 8.6719e-01, 6.0938e+00,
        2.6719e+00, 5.6885e-02, 3.8281e+00, 1.0438e+01, 1.6937e-03, 8.0000e+00,
        6.7969e-01, 1.7500e+00, 3.2812e+00, 2.5312e+00, 7.8125e+00, 1.6625e+01,
        5.4297e-01, 1.4438e+01, 2.1125e+01, 1.3812e+01, 1.5062e+01, 1.3875e+01,
        2.0625e+01, 1.4562e+01, 1.7250e+01, 2.0500e+01, 1.5188e+01, 1.8750e+01,
        5.7500e+00, 1.5562e+01, 1.5125e+01, 1.7500e+01, 2.0750e+01, 1.1875e+01,
        1.9875e+01, 1.6875e+01, 1.9375e+01, 1.9625e+01, 1.9500e+01, 1.8875e+01,
        2.1375e+01, 1.8500e+01, 1.9750e+01, 1.6875e+01, 2.0750e+01, 1.5000e+01,
        2.0500e+01, 1.3812e+01, 9.0000e+00, 1.4500e+01, 2.0500e+01, 1.5562e+01,
        1.7875e+01, 2.2344e+00, 1.1688e+01, 1.8500e+01, 1.8250e+01, 1.7500e+01,
        1.4562e+01, 1.8000e+01, 1.7750e+01, 1.9875e+01, 1.1188e+01, 2.1125e+01,
        1.7375e+01, 1.9000e+01, 2.1125e+01, 1.0312e+01, 1.9375e+01, 1.9000e+01,
        1.8875e+01, 1.9875e+01, 1.8000e+01, 1.5812e+01, 1.2438e+01, 1.1688e+01,
        1.5125e+01, 1.5125e+01, 8.9375e+00, 1.0688e+01, 1.0438e+01, 7.3125e+00,
        1.6750e+01, 2.3375e+01, 1.8375e+01, 1.3562e+01, 1.8125e+01, 1.4062e+01,
        2.1000e+01, 2.1250e+01, 1.9625e+01, 2.1250e+01, 1.4250e+01, 1.8375e+01,
        1.5312e+01, 1.4750e+01], device='cuda:0', grad_fn=<NllLossBackward0>)
loss mask: tensor([False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,  True,
         True,  True,  True, False,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True, False,
         True, False,  True,  True, False,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True, False,  True,  True, False,  True,  True,
         True, False,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True, False,  True,  True],
       device='cuda:0') loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000, 14.4375, 21.1250, 13.8125, 15.0625,  0.0000, 20.6250, 14.5625,
        17.2500, 20.5000, 15.1875, 18.7500,  5.7500, 15.5625, 15.1250, 17.5000,
        20.7500, 11.8750, 19.8750, 16.8750, 19.3750, 19.6250, 19.5000, 18.8750,
        21.3750, 18.5000, 19.7500, 16.8750, 20.7500, 15.0000, 20.5000,  0.0000,
         9.0000,  0.0000, 20.5000, 15.5625,  0.0000,  2.2344, 11.6875, 18.5000,
        18.2500, 17.5000, 14.5625, 18.0000, 17.7500, 19.8750, 11.1875, 21.1250,
        17.3750, 19.0000, 21.1250, 10.3125, 19.3750, 19.0000, 18.8750, 19.8750,
         0.0000, 15.8125, 12.4375,  0.0000, 15.1250, 15.1250,  8.9375,  0.0000,
        10.4375,  7.3125, 16.7500, 23.3750, 18.3750, 13.5625, 18.1250, 14.0625,
        21.0000, 21.2500, 19.6250, 21.2500, 14.2500,  0.0000, 15.3125, 14.7500],
       device='cuda:0', grad_fn=<MaskedFillBackward0>)
weight: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.5391, 0.4941, 0.4551, 0.4199, 0.0000,
         0.3535, 0.3203, 0.2910, 0.2637, 0.2412, 0.2207, 0.2021, 0.1855, 0.1719,
         0.1592, 0.1494, 0.1406, 0.1328, 0.1279, 0.1235, 0.1206, 0.1187, 0.1187,
         0.1196, 0.1221, 0.1260, 0.1309, 0.1377, 0.1455, 0.1562, 0.0000, 0.1689,
         0.0000, 0.1660, 0.1611, 0.0000, 0.1465, 0.1357, 0.1260, 0.1177, 0.1113,
         0.1055, 0.1016, 0.0981, 0.0962, 0.0947, 0.0947, 0.0962, 0.0981, 0.1011,
         0.1055, 0.1108, 0.1177, 0.1260, 0.1348, 0.0000, 0.1465, 0.1494, 0.0000,
         0.1475, 0.1436, 0.1406, 0.0000, 0.1279, 0.1187, 0.1099, 0.1025, 0.0962,
         0.0913, 0.0874, 0.0840, 0.0820, 0.0806, 0.0806, 0.0811, 0.0825, 0.0000,
         0.0762, 0.0684]], device='cuda:0', dtype=torch.bfloat16)
DEBUG loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  7.7827, 10.4387,  6.2858,  6.3251,  0.0000,  7.2913,  4.6646,
         5.0200,  5.4053,  3.6634,  4.1382,  1.1624,  2.8876,  2.5996,  2.7856,
         3.1003,  1.6699,  2.6396,  2.1588,  2.3935,  2.3669,  2.3137,  2.2396,
         2.5571,  2.2583,  2.4880,  2.2083,  2.8572,  2.1826,  3.2031,  0.0000,
         1.5205,  0.0000,  3.4033,  2.5076,  0.0000,  0.3273,  1.5865,  2.3306,
         2.1476,  1.9482,  1.5359,  1.8281,  1.7421,  1.9118,  1.0598,  2.0011,
         1.6713,  1.8647,  2.1352,  1.0876,  2.1475,  2.2358,  2.3778,  2.6785,
         0.0000,  2.3163,  1.8583,  0.0000,  2.2303,  2.1713,  1.2568,  0.0000,
         1.3353,  0.8676,  1.8402,  2.3969,  1.7675,  1.2384,  1.5842,  1.1810,
         1.7227,  1.7120,  1.5811,  1.7224,  1.1759,  0.0000,  1.1664,  1.0083],
       device='cuda:0', grad_fn=<MulBackward0>)
DEBUG: shift logits: tensor([[-2.8281, -2.1719,  0.5586,  ...,  0.2773,  0.2773,  0.2773],
        [-2.8281, -2.1719,  0.5586,  ...,  0.2773,  0.2773,  0.2773],
        [-1.0000,  0.4062,  3.4375,  ...,  0.4043,  0.4043,  0.4043],
        ...,
        [ 1.9141,  0.8125,  3.4844,  ..., -1.0547, -1.0547, -1.0547],
        [ 2.4844,  2.4688,  3.4062,  ..., -0.6875, -0.6875, -0.6875],
        [ 3.8125,  3.4062,  6.5625,  ..., -0.4004, -0.4004, -0.4004]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<ViewBackward0>) shift_labels: tensor([151644,    872,    198,  19641,  24824,     11,   2014,    329,    263,
            11,  98334,  21251,     11,    323,  11678,  26410,     11,    614,
           220,     23,     15,     15,     15,     15,   1251,     13,  98334,
         21251,    702,    220,     16,     14,     17,   3039,    279,   2790,
          7042,    304,    279,   2326,   9720,     13,   1416,    279,   7042,
           315,   2014,    329,    263,    374,    220,     21,     15,   3266,
           315,  98334,  21251,    594,   7042,     11,   1246,   1657,   1251,
          3887,    304,  11678,  26410,     30, 151645,    198, 151644,  77091,
           198,    785,   7042,    315,  98334,  21251,    374,    220,     16,
            14,     17,    353,    220,     23,     15,     15,     15,     15,
          1251,    284,    220,     19,     15,     15,     15,     15,   1251,
           198,   1249,    329,    263,    702,    220,     21,     15,     14,
            16,     15,     15,    353,    220,     19,     15,     15,     15,
            15,   1251,    284,   1115,     21,     15,     14,     16,     15,
            15,      9], device='cuda:0')
DEBUG: loss: tensor([8.9375e+00, 1.4312e+01, 1.3428e-02, 5.8750e+00, 9.5625e+00, 2.8419e-04,
        1.8203e+00, 7.3047e-01, 5.3125e-01, 7.8964e-04, 1.6875e+01, 1.8828e+00,
        1.6251e-03, 1.5381e-02, 5.9688e+00, 1.4531e+00, 1.8501e-04, 6.3750e+00,
        2.2888e-03, 2.7188e+00, 5.1270e-03, 1.9302e-03, 1.2894e-03, 2.5940e-03,
        1.7969e-01, 1.0078e+00, 1.8875e+01, 3.1094e+00, 6.9375e+00, 1.7166e-03,
        4.2578e-01, 6.4697e-03, 1.3086e-01, 6.8125e+00, 3.4180e-02, 4.5312e+00,
        2.0312e+00, 3.9062e+00, 9.9121e-02, 8.0469e-01, 5.7422e-01, 6.7578e-01,
        7.9688e+00, 2.7100e-02, 1.0234e+00, 3.7109e-02, 2.1875e+00, 8.0859e-01,
        9.5312e-01, 2.2812e+00, 1.5945e-03, 1.5469e+00, 3.4943e-03, 2.2852e-01,
        5.2734e-01, 1.1500e+01, 9.2969e-01, 1.2793e-01, 4.3750e-01, 7.5000e-01,
        4.4062e+00, 4.7188e+00, 2.6489e-02, 8.1250e+00, 4.1016e-01, 1.0000e+01,
        2.8125e+00, 1.2734e+00, 1.4609e+00, 8.7891e-03, 5.5625e+00, 1.2250e+01,
        6.2500e-02, 9.7500e+00, 4.1875e+00, 1.8539e-03, 1.4375e+01, 4.4375e+00,
        4.7812e+00, 8.6594e-04, 3.4375e-01, 1.2451e-02, 4.3359e-01, 3.4180e-02,
        2.3174e-04, 5.7500e+00, 2.0294e-03, 1.8787e-04, 1.0061e-04, 1.0395e-04,
        5.0781e-01, 7.2656e-01, 2.2316e-04, 2.3594e+00, 2.0020e-02, 9.0408e-04,
        2.2411e-04, 8.6784e-05, 9.3359e-01, 4.4062e+00, 6.8438e+00, 1.3906e+00,
        1.0938e+00, 1.9375e+00, 9.7752e-05, 8.8867e-02, 7.8735e-03, 2.3682e-02,
        2.2705e-02, 1.4038e-02, 9.8267e-03, 2.3633e-01, 2.4414e-04, 2.4688e+00,
        6.9275e-03, 1.5793e-03, 2.4223e-04, 3.3951e-04, 3.7812e+00, 1.0547e+00,
        1.4531e+00, 4.9219e-01, 1.1368e-03, 2.3633e-01, 4.3213e-02, 7.5150e-04,
        2.3346e-03, 2.5757e-02], device='cuda:0', grad_fn=<NllLossBackward0>)
loss mask: tensor([False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,  True,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False],
       device='cuda:0') loss: tensor([0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        4.4062, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000], device='cuda:0', grad_fn=<MaskedFillBackward0>)
weight: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.9727, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000]], device='cuda:0', dtype=torch.bfloat16)
DEBUG loss: tensor([0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        4.2858, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
        0.0000, 0.0000], device='cuda:0', grad_fn=<MulBackward0>)
DEBUG: shift logits: tensor([[ 4.7188,  1.1641, -1.0312,  ...,  1.1953,  1.1953,  1.1953],
        [ 4.7188,  1.1641, -1.0312,  ...,  1.1953,  1.1953,  1.1953],
        [ 5.6875,  1.3906, -1.2031,  ...,  1.5000,  1.5000,  1.5000],
        ...,
        [ 1.6094, -2.5312, -0.8867,  ..., -0.1270, -0.1270, -0.1270],
        [ 1.6016, -2.5469, -0.8242,  ..., -0.1050, -0.1050, -0.1050],
        [ 1.5078, -2.6094, -0.8125,  ..., -0.1582, -0.1582, -0.1582]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<ViewBackward0>) shift_labels: tensor([151644,    872,    198,     44,   8821,    811,    572,    220,     17,
            15,   1635,   2310,    979,  54500,    572,    220,     23,   1635,
          2310,     13,   2585,   2310,    686,   2876,  63352,    387,    979,
         54500,  10577,    220,     16,     23,     30, 151645,    198, 151644,
         77091,    198,     44,   8821,    811,    374,    220,     17,     15,
           481,    220,     23,    284,   1115,     17,     15,     12,     23,
            28,     16,     17,   2452,     16,     17,   1635,   9014,   1091,
         54500,    624,     33,   6842,    686,   2484,    220,     16,     23,
           304,    220,     16,     23,    481,    220,     23,    284,   1115,
            16,     23,     12,     23,     28,     16,     15,   2452,     16,
            15,   1635,    624,   4416,     11,   2876,  63352,    686,    387,
           220,     17,     15,    488,    220,     16,     15,    284,   1115,
            17,     15,     10,     16,     15,     28,     18,     15,   2452,
            18,     15,   1635,   2310,   1221,    624,    820,    220,     18,
            15, 151645], device='cuda:0')
DEBUG: loss: tensor([10.9375, 14.9375,  5.8438, 12.7500,  3.7656,  7.4062,  3.3750,  3.1250,
         0.0403,  2.7812,  9.3125,  5.1562, 10.4375, 13.7500,  3.2344,  4.2188,
        11.7500,  7.0000,  5.6562,  2.1562, 12.0625,  6.2188,  8.3125,  9.0000,
         8.0625,  3.1562, 10.9375, 15.6250, 12.1875,  0.0845,  4.8438,  5.4062,
         0.7578,  3.7188,  0.9844,  7.8750, 19.2500,  3.3750, 14.3750, 12.8125,
        19.1250, 11.1875, 12.2500, 15.1875, 19.6250, 15.8125, 14.4375, 21.1250,
        17.5000, 18.3750, 17.3750, 21.2500, 14.5625, 21.7500, 17.3750, 20.1250,
        18.0000, 15.4375, 20.1250, 18.0000, 19.1250, 15.5000, 18.7500, 24.0000,
        15.7500, 23.0000, 21.6250, 14.6875, 15.5625, 16.3750, 20.1250, 21.8750,
        18.8750, 16.3750, 20.1250, 21.8750, 17.2500, 16.1250, 21.5000, 18.5000,
        19.2500, 18.1250, 20.5000, 14.0625, 21.0000, 17.0000, 19.3750, 21.2500,
        15.1875, 19.7500, 21.1250, 18.0000, 15.3750, 18.8750, 11.0000, 18.8750,
        16.8750, 14.6250, 19.7500, 15.8125, 17.7500, 21.2500, 19.2500, 16.1250,
        20.0000, 21.3750, 18.6250, 19.1250, 17.7500, 21.2500, 19.6250, 19.7500,
        21.2500, 17.7500, 22.6250, 21.1250, 16.0000, 22.5000, 21.3750, 17.6250,
        18.0000, 20.6250, 15.7500, 22.2500, 16.5000, 22.6250, 21.3750,  6.5000],
       device='cuda:0', grad_fn=<NllLossBackward0>)
loss mask: tensor([False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False,  True,  True,
        False,  True,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,  True,
        False,  True,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True,  True,  True,
         True,  True,  True,  True,  True,  True,  True,  True],
       device='cuda:0') loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000, 14.3750, 12.8125,
         0.0000, 11.1875, 12.2500, 15.1875, 19.6250, 15.8125, 14.4375, 21.1250,
        17.5000, 18.3750, 17.3750, 21.2500, 14.5625, 21.7500, 17.3750, 20.1250,
        18.0000, 15.4375, 20.1250, 18.0000, 19.1250, 15.5000, 18.7500, 24.0000,
        15.7500, 23.0000, 21.6250, 14.6875, 15.5625, 16.3750, 20.1250, 21.8750,
        18.8750, 16.3750, 20.1250, 21.8750, 17.2500, 16.1250, 21.5000, 18.5000,
         0.0000, 18.1250, 20.5000, 14.0625, 21.0000, 17.0000, 19.3750, 21.2500,
        15.1875, 19.7500, 21.1250, 18.0000, 15.3750, 18.8750, 11.0000, 18.8750,
        16.8750, 14.6250, 19.7500, 15.8125, 17.7500, 21.2500, 19.2500, 16.1250,
        20.0000, 21.3750, 18.6250, 19.1250, 17.7500, 21.2500, 19.6250, 19.7500,
        21.2500, 17.7500, 22.6250, 21.1250, 16.0000, 22.5000, 21.3750, 17.6250,
        18.0000, 20.6250, 15.7500, 22.2500, 16.5000, 22.6250, 21.3750,  6.5000],
       device='cuda:0', grad_fn=<MaskedFillBackward0>)
weight: tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         0.0000e+00, 0.0000e+00, 5.3516e-01, 4.9219e-01, 0.0000e+00, 4.0820e-01,
         3.6719e-01, 3.3203e-01, 2.9883e-01, 2.6953e-01, 2.4219e-01, 2.1875e-01,
         1.9727e-01, 1.7773e-01, 1.6016e-01, 1.4453e-01, 1.3086e-01, 1.1865e-01,
         1.0742e-01, 9.7168e-02, 8.8379e-02, 8.0566e-02, 7.3242e-02, 6.7383e-02,
         6.1768e-02, 5.7129e-02, 5.2979e-02, 4.9316e-02, 4.6387e-02, 4.3945e-02,
         4.1992e-02, 4.0527e-02, 3.9551e-02, 3.8818e-02, 3.8574e-02, 3.8818e-02,
         3.9551e-02, 4.0527e-02, 4.2236e-02, 4.3945e-02, 4.6631e-02, 4.9805e-02,
         5.3223e-02, 5.7373e-02, 0.0000e+00, 5.6152e-02, 5.0293e-02, 4.5410e-02,
         4.0771e-02, 3.6621e-02, 3.3203e-02, 2.9785e-02, 2.6855e-02, 2.4048e-02,
         2.1729e-02, 1.9531e-02, 1.7578e-02, 1.5747e-02, 1.4221e-02, 1.2817e-02,
         1.1536e-02, 1.0376e-02, 9.3384e-03, 8.4229e-03, 7.5684e-03, 6.8054e-03,
         6.1340e-03, 5.4932e-03, 4.9438e-03, 4.4861e-03, 4.0283e-03, 3.6316e-03,
         3.2654e-03, 2.9297e-03, 2.6398e-03, 2.3804e-03, 2.1362e-03, 1.9226e-03,
         1.7319e-03, 1.5564e-03, 1.4038e-03, 1.2665e-03, 1.1368e-03, 1.0223e-03,
         9.1934e-04, 8.2779e-04, 7.4387e-04, 6.7139e-04, 6.0272e-04, 5.4169e-04,
         4.8828e-04, 4.4060e-04]], device='cuda:0', dtype=torch.bfloat16)
DEBUG loss: tensor([0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
        0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
        0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
        0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
        0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
        0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00,
        0.0000e+00, 0.0000e+00, 7.6929e+00, 6.3062e+00, 0.0000e+00, 4.5668e+00,
        4.4980e+00, 5.0427e+00, 5.8645e+00, 4.2620e+00, 3.4966e+00, 4.6211e+00,
        3.4521e+00, 3.2659e+00, 2.7827e+00, 3.0713e+00, 1.9056e+00, 2.5807e+00,
        1.8665e+00, 1.9555e+00, 1.5908e+00, 1.2437e+00, 1.4740e+00, 1.2129e+00,
        1.1813e+00, 8.8550e-01, 9.9335e-01, 1.1836e+00, 7.3059e-01, 1.0107e+00,
        9.0808e-01, 5.9525e-01, 6.1551e-01, 6.3565e-01, 7.7631e-01, 8.4915e-01,
        7.4652e-01, 6.6364e-01, 8.5001e-01, 9.6130e-01, 8.0438e-01, 8.0310e-01,
        1.1443e+00, 1.0614e+00, 0.0000e+00, 1.0178e+00, 1.0310e+00, 6.3858e-01,
        8.5620e-01, 6.2256e-01, 6.4331e-01, 6.3293e-01, 4.0787e-01, 4.7495e-01,
        4.5901e-01, 3.5156e-01, 2.7026e-01, 2.9723e-01, 1.5643e-01, 2.4193e-01,
        1.9466e-01, 1.5175e-01, 1.8443e-01, 1.3319e-01, 1.3434e-01, 1.4462e-01,
        1.1808e-01, 8.8577e-02, 9.8877e-02, 9.5890e-02, 7.5027e-02, 6.9454e-02,
        5.7961e-02, 6.2256e-02, 5.1805e-02, 4.7012e-02, 4.5395e-02, 3.4126e-02,
        3.9184e-02, 3.2879e-02, 2.2461e-02, 2.8496e-02, 2.4299e-02, 1.8019e-02,
        1.6548e-02, 1.7073e-02, 1.1716e-02, 1.4938e-02, 9.9449e-03, 1.2256e-02,
        1.0437e-02, 2.8639e-03], device='cuda:0', grad_fn=<MulBackward0>)
DEBUG: shift logits: tensor([[ 6.1875,  0.2832,  5.5000,  ...,  2.0781,  2.0781,  2.0781],
        [ 6.1875,  0.2832,  5.5000,  ...,  2.0781,  2.0781,  2.0781],
        [ 7.2500,  0.2598,  4.7500,  ...,  1.0391,  1.0391,  1.0391],
        ...,
        [ 3.9844, -2.1094,  4.0000,  ...,  0.8242,  0.8242,  0.8242],
        [ 3.9688, -2.0469,  3.9375,  ...,  0.7305,  0.7305,  0.7305],
        [ 4.1250, -1.8359,  4.2188,  ...,  0.7617,  0.7617,  0.7617]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<ViewBackward0>) shift_labels: tensor([151644,    872,    198,  13079,  27627,    311,   8290,    678,    806,
         44426,     13,    220,   1260,    702,   3322,  44426,    311,   9850,
           264,   2155,    825,   1449,   1899,    369,    220,     17,   5555,
            13,    220,   1416,   1817,   8896,   7049,    400,     20,     15,
          1246,   1753,    653,    806,  44426,   2783,     30, 151645,    198,
        151644,  77091,    198,   1519,    702,    220,     17,      9,     22,
            28,   2442,     17,      9,     22,     28,     16,     19,   2452,
            16,     19,  44426,    198,   4416,    807,   2783,    220,     16,
            19,      9,     20,     15,   3186,   2442,     16,     19,      9,
            20,     15,     28,     22,     15,     15,   2452,     22,     15,
            15,    198,    820,    220,     22,     15,     15, 151645, 151643,
        151643, 151643, 151643, 151643, 151643, 151643, 151643, 151643, 151643,
        151643, 151643, 151643, 151643, 151643, 151643, 151643, 151643, 151643,
        151643, 151643, 151643, 151643, 151643, 151643, 151643, 151643, 151643,
        151643, 151643], device='cuda:0')
DEBUG: loss: tensor([1.1500e+01, 1.0250e+01, 1.0059e-01, 7.7188e+00, 1.7188e+00, 5.1575e-03,
        1.5430e-01, 6.6406e-02, 1.8433e-02, 3.1875e+00, 4.0283e-03, 3.1586e-03,
        3.7695e-01, 1.2891e+00, 3.5469e+00, 3.8906e+00, 7.4219e-01, 5.0625e+00,
        3.7500e-01, 2.7500e+00, 4.0000e+00, 3.5781e+00, 2.0938e+00, 3.3594e+00,
        1.1215e-03, 2.7924e-03, 2.0938e+00, 1.3672e-02, 2.5635e-03, 9.3125e+00,
        5.0000e+00, 8.8750e+00, 1.1062e+01, 1.2031e+00, 1.1865e-01, 1.6022e-03,
        7.7812e+00, 2.6094e+00, 1.4844e+00, 1.3203e+00, 9.1875e+00, 8.1875e+00,
        4.0820e-01, 1.0547e-01, 5.8594e-02, 7.2812e+00, 1.0500e+01, 9.1797e-01,
        4.7812e+00, 1.6375e+01, 1.1000e+01, 5.9688e+00, 7.9062e+00, 1.4500e+01,
        6.1250e+00, 1.2000e+01, 1.7734e+00, 4.1250e+00, 4.5938e+00, 9.3125e+00,
        4.3750e+00, 6.6250e+00, 1.0125e+01, 1.0062e+01, 6.8125e+00, 2.5875e+01,
        4.3125e+00, 1.5438e+01, 1.5188e+01, 1.9000e+01, 2.0905e-03, 7.5625e+00,
        3.7031e+00, 7.2188e+00, 5.5000e+00, 7.3125e+00, 9.6875e+00, 7.8125e+00,
        1.4562e+01, 4.2188e+00, 6.6562e+00, 4.2969e-01, 7.7812e+00, 7.9062e+00,
        1.3750e+01, 1.0938e+01, 1.3938e+01, 1.2625e+01, 6.4062e+00, 1.4746e-01,
        7.9590e-02, 9.7500e+00, 1.3500e+01, 1.5000e+01, 1.0250e+01, 4.8340e-02,
        1.3574e-01, 2.5312e+00, 8.9375e+00, 9.0000e+00, 9.0625e+00, 9.1875e+00,
        1.0500e+01, 1.0688e+01, 1.0688e+01, 1.0500e+01, 9.2500e+00, 9.5000e+00,
        9.9375e+00, 9.6250e+00, 8.7500e+00, 9.2500e+00, 9.6250e+00, 8.0625e+00,
        9.2500e+00, 9.0000e+00, 9.1875e+00, 8.3750e+00, 8.8750e+00, 9.4375e+00,
        8.0000e+00, 9.1875e+00, 8.8125e+00, 7.4688e+00, 8.9375e+00, 9.1250e+00,
        9.4375e+00, 9.6875e+00], device='cuda:0', grad_fn=<NllLossBackward0>)
loss mask: tensor([False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False,  True,
         True,  True, False,  True, False,  True, False, False, False,  True,
         True,  True, False,  True,  True,  True,  True, False,  True, False,
        False,  True, False, False,  True, False, False, False,  True, False,
        False, False,  True,  True,  True, False,  True, False, False, False,
        False,  True, False,  True, False, False, False,  True,  True,  True,
        False, False, False, False,  True, False, False,  True,  True, False,
        False,  True, False,  True,  True,  True, False, False,  True, False,
         True,  True, False,  True,  True,  True,  True, False],
       device='cuda:0') loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000, 16.3750, 11.0000,  5.9688,  0.0000, 14.5000,  0.0000, 12.0000,
         0.0000,  0.0000,  0.0000,  9.3125,  4.3750,  6.6250,  0.0000, 10.0625,
         6.8125, 25.8750,  4.3125,  0.0000, 15.1875,  0.0000,  0.0000,  7.5625,
         0.0000,  0.0000,  5.5000,  0.0000,  0.0000,  0.0000, 14.5625,  0.0000,
         0.0000,  0.0000,  7.7812,  7.9062, 13.7500,  0.0000, 13.9375,  0.0000,
         0.0000,  0.0000,  0.0000,  9.7500,  0.0000, 15.0000,  0.0000,  0.0000,
         0.0000,  2.5312,  8.9375,  9.0000,  0.0000,  0.0000,  0.0000,  0.0000,
        10.6875,  0.0000,  0.0000,  9.5000,  9.9375,  0.0000,  0.0000,  9.2500,
         0.0000,  8.0625,  9.2500,  9.0000,  0.0000,  0.0000,  8.8750,  0.0000,
         8.0000,  9.1875,  0.0000,  7.4688,  8.9375,  9.1250,  9.4375,  0.0000],
       device='cuda:0', grad_fn=<MaskedFillBackward0>)
weight: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.7109, 0.6836, 0.6680, 0.0000, 0.6406,
         0.0000, 0.6211, 0.0000, 0.0000, 0.0000, 0.5664, 0.5508, 0.5430, 0.0000,
         0.5312, 0.5273, 0.5312, 0.5430, 0.0000, 0.5664, 0.0000, 0.0000, 0.5977,
         0.0000, 0.0000, 0.6211, 0.0000, 0.0000, 0.0000, 0.6328, 0.0000, 0.0000,
         0.0000, 0.6133, 0.6094, 0.6094, 0.0000, 0.6211, 0.0000, 0.0000, 0.0000,
         0.0000, 0.6289, 0.0000, 0.6211, 0.0000, 0.0000, 0.0000, 0.5977, 0.5938,
         0.5938, 0.0000, 0.0000, 0.0000, 0.0000, 0.5742, 0.0000, 0.0000, 0.5352,
         0.5195, 0.0000, 0.0000, 0.4824, 0.0000, 0.4492, 0.4336, 0.4238, 0.0000,
         0.0000, 0.3848, 0.0000, 0.3457, 0.3262, 0.0000, 0.2871, 0.2656, 0.2471,
         0.2324, 0.0000]], device='cuda:0', dtype=torch.bfloat16)
DEBUG loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000, 11.6416,  7.5195,  3.9869,  0.0000,  9.2891,  0.0000,  7.4531,
         0.0000,  0.0000,  0.0000,  5.2747,  2.4097,  3.5972,  0.0000,  5.3457,
         3.5925, 13.7461,  2.3416,  0.0000,  8.6023,  0.0000,  0.0000,  4.5198,
         0.0000,  0.0000,  3.4160,  0.0000,  0.0000,  0.0000,  9.2153,  0.0000,
         0.0000,  0.0000,  4.7721,  4.8179,  8.3789,  0.0000,  8.6565,  0.0000,
         0.0000,  0.0000,  0.0000,  6.1318,  0.0000,  9.3164,  0.0000,  0.0000,
         0.0000,  1.5128,  5.3066,  5.3438,  0.0000,  0.0000,  0.0000,  0.0000,
         6.1370,  0.0000,  0.0000,  5.0840,  5.1628,  0.0000,  0.0000,  4.4624,
         0.0000,  3.6218,  4.0107,  3.8145,  0.0000,  0.0000,  3.4148,  0.0000,
         2.7656,  2.9967,  0.0000,  2.1443,  2.3740,  2.2545,  2.1935,  0.0000],
       device='cuda:0', grad_fn=<MulBackward0>)
DEBUG: shift logits: tensor([[ 1.4766, -2.7031, -1.7891,  ...,  1.9219,  1.9219,  1.9219],
        [ 1.4766, -2.7031, -1.7891,  ...,  1.9219,  1.9219,  1.9219],
        [ 1.7422, -3.1562, -1.9062,  ...,  2.4844,  2.4844,  2.4844],
        ...,
        [ 0.5352, -4.8125,  0.1084,  ...,  1.7188,  1.7188,  1.7188],
        [ 3.4219, -3.7500,  1.4297,  ...,  1.1484,  1.1484,  1.1484],
        [ 3.8594, -3.0938,  2.5938,  ...,  1.2031,  1.2031,  1.2031]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<ViewBackward0>) shift_labels: tensor([151644,    872,    198,   2082,  10810,  16588,   1340,    702,   2326,
          3039,    803,  23069,   1091,  11268,     11,    323,   1378,   2686,
          1091,   8364,     13,  11268,    702,    220,     21,  23069,     13,
          2585,   1657,  23069,    653,  51989,     11,  11268,     11,    323,
          8364,    614,    304,   2790,     30, 151645,    198, 151644,  77091,
           198,   2082,  10810,    702,   2326,   3039,    803,  23069,   1091,
         11268,     11,    892,   3363,   1340,    702,    220,     18,    353,
           220,     21,    284,   1115,     18,      9,     21,     28,     16,
            23,   2452,     16,     23,    803,  23069,   1091,  11268,    624,
          2082,  10810,    702,    264,   2790,    315,    220,     16,     23,
            10,     21,     28,   1115,     16,     23,     10,     21,     28,
            17,     19,   2452,     17,     19,  23069,    624,  24732,    702,
          1378,  23069,    803,   1091,  51989,     11,    773,    566,    702,
           220,     17,     19,    488,    220,     17,    284,   1115,     17,
            19,     10], device='cuda:0')
DEBUG: loss: tensor([1.0500e+01, 1.8875e+01, 5.5938e+00, 1.1312e+01, 1.0688e+01, 1.3625e+01,
        5.0000e+00, 4.5000e+00, 5.4688e+00, 7.8125e+00, 1.5781e+00, 3.7344e+00,
        8.0625e+00, 7.6250e+00, 5.4598e-05, 3.6926e-03, 7.7812e+00, 2.5156e+00,
        8.8750e+00, 1.1250e+01, 6.1250e+00, 1.4562e+01, 1.1250e+01, 6.1875e+00,
        9.3750e+00, 7.7500e+00, 7.9688e+00, 1.2125e+01, 8.8750e+00, 5.7812e+00,
        3.9531e+00, 8.3750e+00, 1.9193e-05, 9.5000e+00, 3.4571e-06, 3.9978e-03,
        1.4312e+01, 8.8750e+00, 5.9062e+00, 8.5625e+00, 2.1562e+00, 2.6719e+00,
        2.3340e-01, 6.7188e+00, 1.2188e+01, 1.6172e+00, 1.9500e+01, 1.4750e+01,
        1.9375e+01, 2.0875e+01, 2.2250e+01, 1.6250e+01, 1.5438e+01, 2.3125e+01,
        2.5875e+01, 1.1188e+01, 2.0000e+01, 1.8625e+01, 2.4375e+01, 1.9750e+01,
        1.7000e+01, 2.4000e+01, 1.6250e+01, 1.5188e+01, 2.3000e+01, 1.6875e+01,
        1.4812e+01, 2.2125e+01, 4.3438e+00, 2.4875e+01, 1.4312e+01, 1.9750e+01,
        2.3125e+01, 1.3312e+01, 2.0000e+01, 2.3125e+01, 1.7250e+01, 1.5000e+01,
        2.2500e+01, 2.5000e+01, 1.1188e+01, 2.0625e+01, 1.8250e+01, 1.8250e+01,
        1.8875e+01, 1.8625e+01, 1.9250e+01, 1.6500e+01, 2.0500e+01, 2.3500e+01,
        1.5625e+01, 2.3625e+01, 1.5500e+01, 1.6125e+01, 1.9625e+01, 2.4000e+01,
        1.5500e+01, 2.3500e+01, 1.3812e+01, 1.2625e+01, 2.2375e+01, 1.3812e+01,
        1.9500e+01, 2.2875e+01, 1.7375e+01, 1.0703e+00, 2.7125e+01, 9.6875e+00,
        1.3438e+01, 1.0750e+01, 1.3875e+01, 1.8375e+01, 2.7625e+01, 1.0375e+01,
        1.9500e+01, 1.5250e+01, 1.3188e+01, 1.4000e+01, 1.8625e+01, 2.2750e+01,
        1.4750e+01, 1.3812e+01, 1.1438e+01, 1.7625e+01, 1.5750e+01, 2.0875e+01,
        2.2875e+01, 1.4625e+01], device='cuda:0', grad_fn=<NllLossBackward0>)
loss mask: tensor([False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False,  True, False,  True,  True,
         True,  True,  True, False,  True,  True, False,  True,  True, False,
         True,  True,  True,  True,  True,  True,  True, False, False,  True,
         True,  True,  True,  True,  True,  True,  True,  True, False,  True,
         True, False,  True,  True, False,  True,  True,  True,  True,  True,
         True,  True, False,  True, False,  True,  True,  True, False, False,
         True,  True,  True,  True, False, False, False, False,  True, False,
         True,  True,  True,  True, False,  True,  True,  True,  True,  True,
         True, False, False,  True, False,  True,  True, False],
       device='cuda:0') loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000, 19.5000,  0.0000,
        19.3750, 20.8750, 22.2500, 16.2500, 15.4375,  0.0000, 25.8750, 11.1875,
         0.0000, 18.6250, 24.3750,  0.0000, 17.0000, 24.0000, 16.2500, 15.1875,
        23.0000, 16.8750, 14.8125,  0.0000,  0.0000, 24.8750, 14.3125, 19.7500,
        23.1250, 13.3125, 20.0000, 23.1250, 17.2500, 15.0000,  0.0000, 25.0000,
        11.1875,  0.0000, 18.2500, 18.2500,  0.0000, 18.6250, 19.2500, 16.5000,
        20.5000, 23.5000, 15.6250, 23.6250,  0.0000, 16.1250,  0.0000, 24.0000,
        15.5000, 23.5000,  0.0000,  0.0000, 22.3750, 13.8125, 19.5000, 22.8750,
         0.0000,  0.0000,  0.0000,  0.0000, 13.4375,  0.0000, 13.8750, 18.3750,
        27.6250, 10.3750,  0.0000, 15.2500, 13.1875, 14.0000, 18.6250, 22.7500,
        14.7500,  0.0000,  0.0000, 17.6250,  0.0000, 20.8750, 22.8750,  0.0000],
       device='cuda:0', grad_fn=<MaskedFillBackward0>)
weight: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.6250, 0.0000, 0.5469, 0.5117, 0.4844, 0.4609, 0.4434, 0.0000,
         0.4082, 0.3926, 0.0000, 0.3633, 0.3477, 0.0000, 0.3184, 0.3027, 0.2910,
         0.2812, 0.2754, 0.2734, 0.2734, 0.0000, 0.0000, 0.2578, 0.2461, 0.2383,
         0.2324, 0.2295, 0.2285, 0.2305, 0.2344, 0.2422, 0.0000, 0.2520, 0.2559,
         0.0000, 0.2598, 0.2617, 0.0000, 0.2598, 0.2578, 0.2578, 0.2617, 0.2676,
         0.2773, 0.2891, 0.0000, 0.3125, 0.0000, 0.3242, 0.3301, 0.3398, 0.0000,
         0.0000, 0.3574, 0.3594, 0.3652, 0.3750, 0.0000, 0.0000, 0.0000, 0.0000,
         0.3730, 0.0000, 0.3438, 0.3281, 0.3164, 0.3086, 0.0000, 0.2930, 0.2832,
         0.2754, 0.2734, 0.2715, 0.2754, 0.0000, 0.0000, 0.2676, 0.0000, 0.2412,
         0.2266, 0.0000]], device='cuda:0', dtype=torch.bfloat16)
DEBUG loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000, 12.1875,  0.0000,
        10.5957, 10.6821, 10.7773,  7.4902,  6.8444,  0.0000, 10.5623,  4.3920,
         0.0000,  6.7661,  8.4741,  0.0000,  5.4121,  7.2656,  4.7290,  4.2715,
         6.3340,  4.6143,  4.0503,  0.0000,  0.0000,  6.4131,  3.5222,  4.7061,
         5.3748,  3.0551,  4.5703,  5.3296,  4.0430,  3.6328,  0.0000,  6.2988,
         2.8624,  0.0000,  4.7407,  4.7764,  0.0000,  4.8381,  4.9629,  4.2539,
         5.3652,  6.2881,  4.3335,  6.8291,  0.0000,  5.0391,  0.0000,  7.7812,
         5.1162,  7.9863,  0.0000,  0.0000,  7.9973,  4.9639,  7.1221,  8.5781,
         0.0000,  0.0000,  0.0000,  0.0000,  5.0128,  0.0000,  4.7695,  6.0293,
         8.7407,  3.2017,  0.0000,  4.4678,  3.7347,  3.8555,  5.0928,  6.1763,
         4.0620,  0.0000,  0.0000,  4.7161,  0.0000,  5.0353,  5.1826,  0.0000],
       device='cuda:0', grad_fn=<MulBackward0>)
DEBUG: shift logits: tensor([[ 1.8438, -2.7188,  0.2314,  ..., -0.0796, -0.0796, -0.0796],
        [ 1.8438, -2.7188,  0.2314,  ..., -0.0796, -0.0796, -0.0796],
        [ 4.3438, -0.9492,  0.7969,  ..., -0.4941, -0.4941, -0.4941],
        ...,
        [ 2.2031, -5.7500, -2.3438,  ...,  0.8438,  0.8438,  0.8438],
        [ 4.7500, -5.5000, -3.0469,  ..., -0.4043, -0.4043, -0.4043],
        [ 2.8438, -4.8125, -2.0000,  ...,  0.7109,  0.7109,  0.7109]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<ViewBackward0>) shift_labels: tensor([151644,    872,    198,  50277,     11,  23845,    323,   7937,   1033,
          5619,   8964,    304,    279,   6118,     13,  23845,  16548,    220,
            19,   8845,   5976,   7937,  16548,    220,     18,   3039,    803,
          1091,  23845,     13,   2585,   1657,   8845,   1521,  23845,    323,
          7937,   2176,   5456,     30, 151645,    198, 151644,  77091,    198,
         78479,  16548,   1115,     19,     28,     19,   2452,     19,   8845,
           198,   3326,   5503,    220,     18,   3039,    803,   1091,  23845,
            11,   7937,  16548,    220,     19,    353,    220,     18,    284,
          1115,     19,      9,     18,     28,     16,     17,   2452,     16,
            17,   8845,    624,  20629,     11,  23845,    323,   7937,  16548,
           220,     16,     17,    488,    220,     19,    284,   2442,     16,
            17,     10,     19,     28,     16,     21,   2452,     16,     21,
          8845,    624,    820,    220,     16,     21, 151645, 151643, 151643,
        151643, 151643, 151643, 151643, 151643, 151643, 151643, 151643, 151643,
        151643, 151643], device='cuda:0')
DEBUG: loss: tensor([9.3750e+00, 1.7375e+01, 2.3804e-02, 1.0312e+01, 3.5706e-03, 4.0938e+00,
        1.3965e-01, 4.3750e+00, 1.8594e+00, 4.5938e+00, 5.3906e-01, 7.1484e-01,
        8.3542e-04, 2.7344e+00, 1.2354e-01, 6.4375e+00, 1.3281e+00, 7.0190e-03,
        1.7188e-01, 4.8125e+00, 6.4375e+00, 4.6250e+00, 2.5781e-01, 8.7891e-03,
        4.2383e-01, 2.8438e+00, 4.3438e+00, 4.2969e-01, 2.5156e+00, 4.1250e+00,
        5.9062e+00, 8.3125e+00, 3.4062e+00, 8.5625e+00, 3.2500e+00, 3.2227e-02,
        4.3125e+00, 4.7812e+00, 3.7031e+00, 9.4531e-01, 1.4297e+00, 5.3711e-02,
        8.5000e+00, 1.2438e+01, 4.2773e-01, 1.7250e+01, 5.3750e+00, 9.5000e+00,
        4.5625e+00, 3.8594e+00, 8.3008e-02, 8.9375e+00, 9.2969e-01, 1.1250e+01,
        1.0703e+00, 7.7812e+00, 8.1250e+00, 1.2750e+01, 1.5062e+01, 1.9125e+01,
        9.0000e+00, 1.3812e+01, 5.1562e+00, 1.5078e+00, 1.8750e+01, 9.2500e+00,
        6.2012e-02, 2.5391e-01, 4.5312e+00, 1.8082e-03, 5.3516e-01, 4.0625e+00,
        2.8281e+00, 6.6016e-01, 8.3750e+00, 1.1312e+01, 7.7500e+00, 9.5215e-02,
        1.4551e-01, 9.6250e+00, 7.8613e-02, 3.0396e-02, 1.2125e+01, 5.7812e+00,
        1.4375e+01, 1.7624e-03, 1.5250e+01, 2.4844e+00, 1.0000e+01, 4.9688e+00,
        9.8145e-02, 1.7822e-02, 1.2695e-01, 2.6733e-02, 8.3750e+00, 2.4844e+00,
        6.1250e+00, 9.1875e+00, 3.3906e+00, 4.6875e-01, 2.0898e-01, 5.1514e-02,
        3.3750e+00, 3.9795e-02, 1.2812e+00, 1.4188e+01, 1.3977e-02, 9.5703e-01,
        1.8375e+01, 2.2344e+00, 1.0062e+01, 5.5542e-03, 6.2866e-03, 1.2266e+00,
        6.5938e+00, 7.2812e+00, 5.8125e+00, 6.0938e+00, 6.2188e+00, 7.3750e+00,
        6.4062e+00, 6.6250e+00, 6.8125e+00, 6.7188e+00, 6.6875e+00, 6.2500e+00,
        7.0625e+00, 5.9375e+00], device='cuda:0', grad_fn=<NllLossBackward0>)
loss mask: tensor([False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False,  True, False, False,
        False, False, False, False, False, False, False,  True,  True,  True,
         True, False, False,  True,  True, False, False, False, False, False,
        False, False, False, False,  True,  True, False, False, False, False,
        False, False, False,  True, False, False,  True, False, False, False,
        False, False, False, False,  True, False,  True, False,  True, False,
        False, False, False, False, False, False, False, False,  True, False,
        False, False, False, False, False, False, False, False,  True, False,
        False, False, False, False, False,  True, False, False],
       device='cuda:0') loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  9.5000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000, 12.7500, 15.0625, 19.1250,  9.0000,  0.0000,  0.0000,  1.5078,
        18.7500,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  8.3750, 11.3125,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  5.7812,  0.0000,  0.0000, 15.2500,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  8.3750,  0.0000,
         6.1250,  0.0000,  3.3906,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000, 18.3750,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  6.2188,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  6.2500,  0.0000,  0.0000],
       device='cuda:0', grad_fn=<MaskedFillBackward0>)
weight: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.9023, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.7617, 0.7422, 0.7344, 0.7344, 0.0000, 0.0000,
         0.7500, 0.7578, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.8086, 0.8086, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.8281, 0.0000, 0.0000, 0.8281, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.8164, 0.0000, 0.8125, 0.0000, 0.8242,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.8398, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.7383, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.5469,
         0.0000, 0.0000]], device='cuda:0', dtype=torch.bfloat16)
DEBUG loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  8.5723,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  9.7119, 11.1792, 14.0449,  6.6094,  0.0000,  0.0000,  1.1309,
        14.2090,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  6.7720,  9.1472,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  4.7876,  0.0000,  0.0000, 12.6289,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  6.8374,  0.0000,
         4.9766,  0.0000,  2.7946,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000, 15.4321,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  4.5912,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  3.4180,  0.0000,  0.0000],
       device='cuda:0', grad_fn=<MulBackward0>)
DEBUG: shift logits: tensor([[ 2.9219, -2.2344,  1.7188,  ...,  0.7812,  0.7812,  0.7812],
        [ 2.9219, -2.2344,  1.7188,  ...,  0.7812,  0.7812,  0.7812],
        [ 3.9375, -1.5547,  2.5625,  ...,  0.4629,  0.4629,  0.4629],
        ...,
        [ 2.1250, -5.1562,  1.6250,  ...,  0.7344,  0.7344,  0.7344],
        [ 3.4375, -3.0000,  4.0625,  ...,  1.1797,  1.1797,  1.1797],
        [ 4.8438, -1.7422,  4.6875,  ...,  1.7031,  1.7031,  1.7031]],
       device='cuda:0', dtype=torch.bfloat16, grad_fn=<ViewBackward0>) shift_labels: tensor([151644,    872,    198,  24732,   2408,    702,    220,     16,     15,
           803,  24140,   1091,  27833,   1558,     13,   1416,  27833,    702,
           220,     18,     17,  24140,     11,   1246,   1657,    803,  24140,
           686,  27833,    614,   1091,  39039,    421,    806,   4238,  86618,
          6696,   1435,    220,     19,     15,  24140,     13, 151645,    198,
        151644,  77091,    198,   2679,  27833,    702,    220,     18,     17,
         24140,     11,    323,  39039,    702,    220,     16,     15,    803,
         24140,   1091,  27833,   1558,     11,  39039,    702,    220,     16,
            15,     10,     18,     17,    284,   1115,     18,     17,     10,
            16,     15,     28,     19,     17,   2452,     19,     17,  24140,
           624,   4498,  86618,   6696,  27833,    220,     19,     15,  24140,
            11,    806,   2790,   1372,    315,  24140,  12703,    311,    220,
            18,     17,     10,    220,     19,     15,    284,   1115,     18,
            17,     10,     19,     15,     28,     22,     17,   2452,     22,
            17,    198], device='cuda:0')
DEBUG: loss: tensor([1.0688e+01, 1.4875e+01, 1.7500e+00, 2.3250e+01, 6.9062e+00, 9.5000e+00,
        2.4512e-01, 1.4551e-01, 7.2266e-02, 1.6328e+00, 9.5625e+00, 9.4375e+00,
        7.4375e+00, 6.9375e+00, 4.4375e+00, 8.0000e+00, 4.1875e+00, 8.0469e-01,
        1.2598e-01, 2.6250e+00, 1.0620e-02, 1.2312e+01, 5.1172e-01, 1.1562e+01,
        7.4688e+00, 1.4531e+00, 1.0938e+01, 4.5312e+00, 5.2188e+00, 9.1875e+00,
        1.0562e+01, 7.7812e+00, 1.1375e+01, 2.6094e+00, 3.0156e+00, 1.0250e+01,
        1.3000e+01, 3.1094e+00, 3.2617e-01, 2.2344e+00, 1.5469e+00, 1.0250e+01,
        4.8750e+00, 3.2969e+00, 1.1865e-01, 6.5938e+00, 1.6125e+01, 3.7354e-02,
        1.4375e+01, 1.0375e+01, 2.8594e+00, 3.7231e-03, 1.9141e+00, 1.8555e-02,
        1.3312e+01, 2.0117e-01, 1.7480e-01, 1.0562e+01, 4.8125e+00, 6.9062e+00,
        1.1875e+01, 1.5000e+01, 1.1312e+01, 1.4000e+01, 1.3000e+01, 1.7000e+01,
        1.1812e+01, 1.8438e+00, 1.2688e+01, 9.5000e+00, 8.4375e+00, 6.4453e-01,
        1.9629e-01, 2.2188e+00, 2.3281e+00, 7.1289e-02, 7.1875e+00, 4.0938e+00,
        1.4375e+00, 1.6113e-02, 2.8125e-01, 6.4453e-02, 2.9175e-02, 1.4219e+00,
        2.9844e+00, 2.3682e-02, 4.1562e+00, 4.3125e+00, 2.4658e-02, 1.7625e+01,
        7.6172e-02, 8.5000e+00, 1.4000e+01, 9.9375e+00, 9.4375e+00, 1.0188e+01,
        4.6562e+00, 3.2500e+00, 1.3062e+01, 2.3594e+00, 5.3438e+00, 2.2500e+00,
        1.1750e+01, 9.2285e-02, 1.7750e+01, 2.5156e+00, 1.1688e+01, 1.1062e+01,
        1.3062e+01, 7.0625e+00, 2.9062e+00, 2.4292e-02, 1.1641e+00, 9.1250e+00,
        8.5000e+00, 6.4688e+00, 2.1562e+00, 1.3688e+01, 6.8438e+00, 6.9531e-01,
        1.7000e+01, 6.2188e+00, 1.5000e+01, 7.2812e+00, 6.4062e+00, 1.7875e+01,
        7.1562e+00, 7.4219e-02], device='cuda:0', grad_fn=<NllLossBackward0>)
loss mask: tensor([False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False,  True,  True,
         True, False, False, False,  True, False, False, False, False,  True,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False, False, False, False, False, False,
        False, False, False, False, False,  True, False, False, False, False,
        False, False,  True, False, False, False,  True,  True,  True, False,
        False, False, False,  True, False, False, False,  True, False, False,
         True, False,  True, False, False,  True, False, False],
       device='cuda:0') loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  4.8125,  6.9062, 11.8750,  0.0000,  0.0000,  0.0000,
        13.0000,  0.0000,  0.0000,  0.0000,  0.0000,  9.5000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000, 10.1875,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000, 11.7500,  0.0000,
         0.0000,  0.0000, 11.6875, 11.0625, 13.0625,  0.0000,  0.0000,  0.0000,
         0.0000,  9.1250,  0.0000,  0.0000,  0.0000, 13.6875,  0.0000,  0.0000,
        17.0000,  0.0000, 15.0000,  0.0000,  0.0000, 17.8750,  0.0000,  0.0000],
       device='cuda:0', grad_fn=<MaskedFillBackward0>)
weight: tensor([[0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.8516, 0.8438, 0.8438, 0.0000, 0.0000,
         0.0000, 0.8633, 0.0000, 0.0000, 0.0000, 0.0000, 0.8984, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.8750, 0.0000, 0.0000, 0.0000,
         0.0000, 0.0000, 0.0000, 0.7852, 0.0000, 0.0000, 0.0000, 0.7188, 0.7031,
         0.6992, 0.0000, 0.0000, 0.0000, 0.0000, 0.6680, 0.0000, 0.0000, 0.0000,
         0.6172, 0.0000, 0.0000, 0.5586, 0.0000, 0.5195, 0.0000, 0.0000, 0.4492,
         0.0000, 0.0000]], device='cuda:0', dtype=torch.bfloat16)
DEBUG loss: tensor([ 0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  4.0981,  5.8271, 10.0195,  0.0000,  0.0000,  0.0000,
        11.2227,  0.0000,  0.0000,  0.0000,  0.0000,  8.5352,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  8.9141,
         0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  0.0000,  9.2256,  0.0000,
         0.0000,  0.0000,  8.4004,  7.7783,  9.1335,  0.0000,  0.0000,  0.0000,
         0.0000,  6.0952,  0.0000,  0.0000,  0.0000,  8.4478,  0.0000,  0.0000,
         9.4961,  0.0000,  7.7930,  0.0000,  0.0000,  8.0298,  0.0000,  0.0000],
       device='cuda:0', grad_fn=<MulBackward0>)
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/zhang2968/Dream/src/trainer/fsdp_sft_trainer.py", line 1170, in <module>
    main()
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
           ^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
            ^^^^^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/hydra/_internal/hydra.py", line 119, in run
    ret = run_job(
          ^^^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
                       ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zhang2968/Dream/src/trainer/fsdp_sft_trainer.py", line 1166, in main
    trainer.fit()
  File "/home/zhang2968/Dream/src/trainer/fsdp_sft_trainer.py", line 1087, in fit
    metric = self.training_step(data)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zhang2968/Dream/src/trainer/fsdp_sft_trainer.py", line 862, in training_step
    self._compute_loss_and_backward(batch=micro_batch, do_backward=False)
  File "/home/zhang2968/Dream/src/trainer/fsdp_sft_trainer.py", line 777, in _compute_loss_and_backward
    output = self.fsdp_model(
             ^^^^^^^^^^^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 854, in forward
    output = self._fsdp_wrapped_module(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/transformers/utils/generic.py", line 918, in wrapper
    output = func(self, *args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/transformers/models/qwen3/modeling_qwen3.py", line 480, in forward
    outputs: BaseModelOutputWithPast = self.model(
                                       ^^^^^^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/transformers/utils/generic.py", line 1072, in wrapper
    outputs = func(self, *args, **kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/transformers/models/qwen3/modeling_qwen3.py", line 410, in forward
    hidden_states = decoder_layer(
                    ^^^^^^^^^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 854, in forward
    output = self._fsdp_wrapped_module(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/transformers/modeling_layers.py", line 93, in __call__
    return self._gradient_checkpointing_func(partial(super().__call__, **kwargs), *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/_compile.py", line 53, in inner
    return disable_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 929, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/utils/checkpoint.py", line 495, in checkpoint
    ret = function(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/transformers/utils/deprecation.py", line 172, in wrapped_func
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/transformers/models/qwen3/modeling_qwen3.py", line 260, in forward
    hidden_states, _ = self.self_attn(
                       ^^^^^^^^^^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/transformers/utils/deprecation.py", line 172, in wrapped_func
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/transformers/models/qwen3/modeling_qwen3.py", line 201, in forward
    key_states = self.k_norm(self.k_proj(hidden_states).view(hidden_shape)).transpose(1, 2)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
[rank0]: Traceback (most recent call last):
[rank0]:   File "<frozen runpy>", line 198, in _run_module_as_main
[rank0]:   File "<frozen runpy>", line 88, in _run_code
[rank0]:   File "/home/zhang2968/Dream/src/trainer/fsdp_sft_trainer.py", line 1170, in <module>
[rank0]:     main()
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/hydra/main.py", line 94, in decorated_main
[rank0]:     _run_hydra(
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
[rank0]:     _run_app(
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/hydra/_internal/utils.py", line 457, in _run_app
[rank0]:     run_and_report(
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
[rank0]:     return func()
[rank0]:            ^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
[rank0]:     lambda: hydra.run(
[rank0]:             ^^^^^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/hydra/_internal/hydra.py", line 119, in run
[rank0]:     ret = run_job(
[rank0]:           ^^^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/hydra/core/utils.py", line 186, in run_job
[rank0]:     ret.return_value = task_function(task_cfg)
[rank0]:                        ^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/zhang2968/Dream/src/trainer/fsdp_sft_trainer.py", line 1166, in main
[rank0]:     trainer.fit()
[rank0]:   File "/home/zhang2968/Dream/src/trainer/fsdp_sft_trainer.py", line 1087, in fit
[rank0]:     metric = self.training_step(data)
[rank0]:              ^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/zhang2968/Dream/src/trainer/fsdp_sft_trainer.py", line 862, in training_step
[rank0]:     self._compute_loss_and_backward(batch=micro_batch, do_backward=False)
[rank0]:   File "/home/zhang2968/Dream/src/trainer/fsdp_sft_trainer.py", line 777, in _compute_loss_and_backward
[rank0]:     output = self.fsdp_model(
[rank0]:              ^^^^^^^^^^^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 854, in forward
[rank0]:     output = self._fsdp_wrapped_module(*args, **kwargs)
[rank0]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/transformers/utils/generic.py", line 918, in wrapper
[rank0]:     output = func(self, *args, **kwargs)
[rank0]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/transformers/models/qwen3/modeling_qwen3.py", line 480, in forward
[rank0]:     outputs: BaseModelOutputWithPast = self.model(
[rank0]:                                        ^^^^^^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/transformers/utils/generic.py", line 1072, in wrapper
[rank0]:     outputs = func(self, *args, **kwargs)
[rank0]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/transformers/models/qwen3/modeling_qwen3.py", line 410, in forward
[rank0]:     hidden_states = decoder_layer(
[rank0]:                     ^^^^^^^^^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 854, in forward
[rank0]:     output = self._fsdp_wrapped_module(*args, **kwargs)
[rank0]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/transformers/modeling_layers.py", line 93, in __call__
[rank0]:     return self._gradient_checkpointing_func(partial(super().__call__, **kwargs), *args)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/_compile.py", line 53, in inner
[rank0]:     return disable_fn(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 929, in _fn
[rank0]:     return fn(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/utils/checkpoint.py", line 495, in checkpoint
[rank0]:     ret = function(*args, **kwargs)
[rank0]:           ^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/transformers/utils/deprecation.py", line 172, in wrapped_func
[rank0]:     return func(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/transformers/models/qwen3/modeling_qwen3.py", line 260, in forward
[rank0]:     hidden_states, _ = self.self_attn(
[rank0]:                        ^^^^^^^^^^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/transformers/utils/deprecation.py", line 172, in wrapped_func
[rank0]:     return func(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/transformers/models/qwen3/modeling_qwen3.py", line 201, in forward
[rank0]:     key_states = self.k_norm(self.k_proj(hidden_states).view(hidden_shape)).transpose(1, 2)
[rank0]:                              ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
[rank0]:     return self._call_impl(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
[rank0]:     return forward_call(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/home/zhang2968/anaconda3/envs/PN/lib/python3.11/site-packages/torch/nn/modules/linear.py", line 125, in forward
[rank0]:     return F.linear(input, self.weight, self.bias)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]: KeyboardInterrupt
